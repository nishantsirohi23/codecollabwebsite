"use strict";!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).index=e()}}((function(){return function e(t,n,i){function s(r,o){if(!n[r]){if(!t[r]){var c="function"==typeof require&&require;if(!o&&c)return c(r,!0);if(a)return a(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var d=n[r]={exports:{}};t[r][0].call(d.exports,(function(e){return s(t[r][1][e]||e)}),d,d.exports,e,t,n,i)}return n[r].exports}for(var a="function"==typeof require&&require,r=0;r<i.length;r++)s(i[r]);return s}({1:[function(e,t,n){var i=e("./_hashClear"),s=e("./_hashDelete"),a=e("./_hashGet"),r=e("./_hashHas"),o=e("./_hashSet");function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}c.prototype.clear=i,c.prototype.delete=s,c.prototype.get=a,c.prototype.has=r,c.prototype.set=o,t.exports=c},{"./_hashClear":43,"./_hashDelete":44,"./_hashGet":45,"./_hashHas":46,"./_hashSet":47}],2:[function(e,t,n){var i=e("./_listCacheClear"),s=e("./_listCacheDelete"),a=e("./_listCacheGet"),r=e("./_listCacheHas"),o=e("./_listCacheSet");function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}c.prototype.clear=i,c.prototype.delete=s,c.prototype.get=a,c.prototype.has=r,c.prototype.set=o,t.exports=c},{"./_listCacheClear":54,"./_listCacheDelete":55,"./_listCacheGet":56,"./_listCacheHas":57,"./_listCacheSet":58}],3:[function(e,t,n){var i=e("./_getNative")(e("./_root"),"Map");t.exports=i},{"./_getNative":39,"./_root":70}],4:[function(e,t,n){var i=e("./_mapCacheClear"),s=e("./_mapCacheDelete"),a=e("./_mapCacheGet"),r=e("./_mapCacheHas"),o=e("./_mapCacheSet");function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}c.prototype.clear=i,c.prototype.delete=s,c.prototype.get=a,c.prototype.has=r,c.prototype.set=o,t.exports=c},{"./_mapCacheClear":59,"./_mapCacheDelete":60,"./_mapCacheGet":61,"./_mapCacheHas":62,"./_mapCacheSet":63}],5:[function(e,t,n){var i=e("./_ListCache"),s=e("./_stackClear"),a=e("./_stackDelete"),r=e("./_stackGet"),o=e("./_stackHas"),c=e("./_stackSet");function l(e){var t=this.__data__=new i(e);this.size=t.size}l.prototype.clear=s,l.prototype.delete=a,l.prototype.get=r,l.prototype.has=o,l.prototype.set=c,t.exports=l},{"./_ListCache":2,"./_stackClear":74,"./_stackDelete":75,"./_stackGet":76,"./_stackHas":77,"./_stackSet":78}],6:[function(e,t,n){var i=e("./_root").Symbol;t.exports=i},{"./_root":70}],7:[function(e,t,n){var i=e("./_root").Uint8Array;t.exports=i},{"./_root":70}],8:[function(e,t,n){t.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},{}],9:[function(e,t,n){var i=e("./_baseTimes"),s=e("./isArguments"),a=e("./isArray"),r=e("./isBuffer"),o=e("./_isIndex"),c=e("./isTypedArray"),l=Object.prototype.hasOwnProperty;t.exports=function(e,t){var n=a(e),d=!n&&s(e),h=!n&&!d&&r(e),p=!n&&!d&&!h&&c(e),u=n||d||h||p,m=u?i(e.length,String):[],g=m.length;for(var f in e)!t&&!l.call(e,f)||u&&("length"==f||h&&("offset"==f||"parent"==f)||p&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||o(f,g))||m.push(f);return m}},{"./_baseTimes":25,"./_isIndex":49,"./isArguments":84,"./isArray":85,"./isBuffer":88,"./isTypedArray":94}],10:[function(e,t,n){var i=e("./_baseAssignValue"),s=e("./eq");t.exports=function(e,t,n){(void 0!==n&&!s(e[t],n)||void 0===n&&!(t in e))&&i(e,t,n)}},{"./_baseAssignValue":13,"./eq":82}],11:[function(e,t,n){var i=e("./_baseAssignValue"),s=e("./eq"),a=Object.prototype.hasOwnProperty;t.exports=function(e,t,n){var r=e[t];a.call(e,t)&&s(r,n)&&(void 0!==n||t in e)||i(e,t,n)}},{"./_baseAssignValue":13,"./eq":82}],12:[function(e,t,n){var i=e("./eq");t.exports=function(e,t){for(var n=e.length;n--;)if(i(e[n][0],t))return n;return-1}},{"./eq":82}],13:[function(e,t,n){var i=e("./_defineProperty");t.exports=function(e,t,n){"__proto__"==t&&i?i(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},{"./_defineProperty":36}],14:[function(e,t,n){var i=e("./isObject"),s=Object.create,a=function(){function e(){}return function(t){if(!i(t))return{};if(s)return s(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();t.exports=a},{"./isObject":91}],15:[function(e,t,n){var i=e("./_createBaseFor")();t.exports=i},{"./_createBaseFor":34}],16:[function(e,t,n){var i=e("./_Symbol"),s=e("./_getRawTag"),a=e("./_objectToString"),r=i?i.toStringTag:void 0;t.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":r&&r in Object(e)?s(e):a(e)}},{"./_Symbol":6,"./_getRawTag":41,"./_objectToString":67}],17:[function(e,t,n){var i=e("./_baseGetTag"),s=e("./isObjectLike");t.exports=function(e){return s(e)&&"[object Arguments]"==i(e)}},{"./_baseGetTag":16,"./isObjectLike":92}],18:[function(e,t,n){var i=e("./isFunction"),s=e("./_isMasked"),a=e("./isObject"),r=e("./_toSource"),o=/^\[object .+?Constructor\]$/,c=Function.prototype,l=Object.prototype,d=c.toString,h=l.hasOwnProperty,p=RegExp("^"+d.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(e){return!(!a(e)||s(e))&&(i(e)?p:o).test(r(e))}},{"./_isMasked":52,"./_toSource":79,"./isFunction":89,"./isObject":91}],19:[function(e,t,n){var i=e("./_baseGetTag"),s=e("./isLength"),a=e("./isObjectLike"),r={};r["[object Float32Array]"]=r["[object Float64Array]"]=r["[object Int8Array]"]=r["[object Int16Array]"]=r["[object Int32Array]"]=r["[object Uint8Array]"]=r["[object Uint8ClampedArray]"]=r["[object Uint16Array]"]=r["[object Uint32Array]"]=!0,r["[object Arguments]"]=r["[object Array]"]=r["[object ArrayBuffer]"]=r["[object Boolean]"]=r["[object DataView]"]=r["[object Date]"]=r["[object Error]"]=r["[object Function]"]=r["[object Map]"]=r["[object Number]"]=r["[object Object]"]=r["[object RegExp]"]=r["[object Set]"]=r["[object String]"]=r["[object WeakMap]"]=!1,t.exports=function(e){return a(e)&&s(e.length)&&!!r[i(e)]}},{"./_baseGetTag":16,"./isLength":90,"./isObjectLike":92}],20:[function(e,t,n){var i=e("./isObject"),s=e("./_isPrototype"),a=e("./_nativeKeysIn"),r=Object.prototype.hasOwnProperty;t.exports=function(e){if(!i(e))return a(e);var t=s(e),n=[];for(var o in e)("constructor"!=o||!t&&r.call(e,o))&&n.push(o);return n}},{"./_isPrototype":53,"./_nativeKeysIn":65,"./isObject":91}],21:[function(e,t,n){var i=e("./_Stack"),s=e("./_assignMergeValue"),a=e("./_baseFor"),r=e("./_baseMergeDeep"),o=e("./isObject"),c=e("./keysIn"),l=e("./_safeGet");t.exports=function e(t,n,d,h,p){t!==n&&a(n,(function(a,c){if(p||(p=new i),o(a))r(t,n,c,d,e,h,p);else{var u=h?h(l(t,c),a,c+"",t,n,p):void 0;void 0===u&&(u=a),s(t,c,u)}}),c)}},{"./_Stack":5,"./_assignMergeValue":10,"./_baseFor":15,"./_baseMergeDeep":22,"./_safeGet":71,"./isObject":91,"./keysIn":95}],22:[function(e,t,n){var i=e("./_assignMergeValue"),s=e("./_cloneBuffer"),a=e("./_cloneTypedArray"),r=e("./_copyArray"),o=e("./_initCloneObject"),c=e("./isArguments"),l=e("./isArray"),d=e("./isArrayLikeObject"),h=e("./isBuffer"),p=e("./isFunction"),u=e("./isObject"),m=e("./isPlainObject"),g=e("./isTypedArray"),f=e("./_safeGet"),v=e("./toPlainObject");t.exports=function(e,t,n,b,y,C,S){var E=f(e,n),T=f(t,n),I=S.get(T);if(I)i(e,n,I);else{var k=C?C(E,T,n+"",e,t,S):void 0,w=void 0===k;if(w){var P=l(T),R=!P&&h(T),x=!P&&!R&&g(T);k=T,P||R||x?l(E)?k=E:d(E)?k=r(E):R?(w=!1,k=s(T,!0)):x?(w=!1,k=a(T,!0)):k=[]:m(T)||c(T)?(k=E,c(E)?k=v(E):u(E)&&!p(E)||(k=o(T))):w=!1}w&&(S.set(T,k),y(k,T,b,C,S),S.delete(T)),i(e,n,k)}}},{"./_assignMergeValue":10,"./_cloneBuffer":28,"./_cloneTypedArray":29,"./_copyArray":30,"./_initCloneObject":48,"./_safeGet":71,"./isArguments":84,"./isArray":85,"./isArrayLikeObject":87,"./isBuffer":88,"./isFunction":89,"./isObject":91,"./isPlainObject":93,"./isTypedArray":94,"./toPlainObject":98}],23:[function(e,t,n){var i=e("./identity"),s=e("./_overRest"),a=e("./_setToString");t.exports=function(e,t){return a(s(e,t,i),e+"")}},{"./_overRest":69,"./_setToString":72,"./identity":83}],24:[function(e,t,n){var i=e("./constant"),s=e("./_defineProperty"),a=e("./identity"),r=s?function(e,t){return s(e,"toString",{configurable:!0,enumerable:!1,value:i(t),writable:!0})}:a;t.exports=r},{"./_defineProperty":36,"./constant":80,"./identity":83}],25:[function(e,t,n){t.exports=function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}},{}],26:[function(e,t,n){t.exports=function(e){return function(t){return e(t)}}},{}],27:[function(e,t,n){var i=e("./_Uint8Array");t.exports=function(e){var t=new e.constructor(e.byteLength);return new i(t).set(new i(e)),t}},{"./_Uint8Array":7}],28:[function(e,t,n){var i=e("./_root"),s="object"==typeof n&&n&&!n.nodeType&&n,a=s&&"object"==typeof t&&t&&!t.nodeType&&t,r=a&&a.exports===s?i.Buffer:void 0,o=r?r.allocUnsafe:void 0;t.exports=function(e,t){if(t)return e.slice();var n=e.length,i=o?o(n):new e.constructor(n);return e.copy(i),i}},{"./_root":70}],29:[function(e,t,n){var i=e("./_cloneArrayBuffer");t.exports=function(e,t){var n=t?i(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},{"./_cloneArrayBuffer":27}],30:[function(e,t,n){t.exports=function(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t}},{}],31:[function(e,t,n){var i=e("./_assignValue"),s=e("./_baseAssignValue");t.exports=function(e,t,n,a){var r=!n;n||(n={});for(var o=-1,c=t.length;++o<c;){var l=t[o],d=a?a(n[l],e[l],l,n,e):void 0;void 0===d&&(d=e[l]),r?s(n,l,d):i(n,l,d)}return n}},{"./_assignValue":11,"./_baseAssignValue":13}],32:[function(e,t,n){var i=e("./_root")["__core-js_shared__"];t.exports=i},{"./_root":70}],33:[function(e,t,n){var i=e("./_baseRest"),s=e("./_isIterateeCall");t.exports=function(e){return i((function(t,n){var i=-1,a=n.length,r=a>1?n[a-1]:void 0,o=a>2?n[2]:void 0;for(r=e.length>3&&"function"==typeof r?(a--,r):void 0,o&&s(n[0],n[1],o)&&(r=a<3?void 0:r,a=1),t=Object(t);++i<a;){var c=n[i];c&&e(t,c,i,r)}return t}))}},{"./_baseRest":23,"./_isIterateeCall":50}],34:[function(e,t,n){t.exports=function(e){return function(t,n,i){for(var s=-1,a=Object(t),r=i(t),o=r.length;o--;){var c=r[e?o:++s];if(!1===n(a[c],c,a))break}return t}}},{}],35:[function(e,t,n){var i=e("./_baseMerge"),s=e("./isObject");t.exports=function e(t,n,a,r,o,c){return s(t)&&s(n)&&(c.set(n,t),i(t,n,void 0,e,c),c.delete(n)),t}},{"./_baseMerge":21,"./isObject":91}],36:[function(e,t,n){var i=e("./_getNative"),s=function(){try{var e=i(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.exports=s},{"./_getNative":39}],37:[function(e,t,n){(function(e){(function(){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],38:[function(e,t,n){var i=e("./_isKeyable");t.exports=function(e,t){var n=e.__data__;return i(t)?n["string"==typeof t?"string":"hash"]:n.map}},{"./_isKeyable":51}],39:[function(e,t,n){var i=e("./_baseIsNative"),s=e("./_getValue");t.exports=function(e,t){var n=s(e,t);return i(n)?n:void 0}},{"./_baseIsNative":18,"./_getValue":42}],40:[function(e,t,n){var i=e("./_overArg")(Object.getPrototypeOf,Object);t.exports=i},{"./_overArg":68}],41:[function(e,t,n){var i=e("./_Symbol"),s=Object.prototype,a=s.hasOwnProperty,r=s.toString,o=i?i.toStringTag:void 0;t.exports=function(e){var t=a.call(e,o),n=e[o];try{e[o]=void 0;var i=!0}catch(e){}var s=r.call(e);return i&&(t?e[o]=n:delete e[o]),s}},{"./_Symbol":6}],42:[function(e,t,n){t.exports=function(e,t){return null==e?void 0:e[t]}},{}],43:[function(e,t,n){var i=e("./_nativeCreate");t.exports=function(){this.__data__=i?i(null):{},this.size=0}},{"./_nativeCreate":64}],44:[function(e,t,n){t.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},{}],45:[function(e,t,n){var i=e("./_nativeCreate"),s=Object.prototype.hasOwnProperty;t.exports=function(e){var t=this.__data__;if(i){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return s.call(t,e)?t[e]:void 0}},{"./_nativeCreate":64}],46:[function(e,t,n){var i=e("./_nativeCreate"),s=Object.prototype.hasOwnProperty;t.exports=function(e){var t=this.__data__;return i?void 0!==t[e]:s.call(t,e)}},{"./_nativeCreate":64}],47:[function(e,t,n){var i=e("./_nativeCreate");t.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=i&&void 0===t?"__lodash_hash_undefined__":t,this}},{"./_nativeCreate":64}],48:[function(e,t,n){var i=e("./_baseCreate"),s=e("./_getPrototype"),a=e("./_isPrototype");t.exports=function(e){return"function"!=typeof e.constructor||a(e)?{}:i(s(e))}},{"./_baseCreate":14,"./_getPrototype":40,"./_isPrototype":53}],49:[function(e,t,n){var i=/^(?:0|[1-9]\d*)$/;t.exports=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&i.test(e))&&e>-1&&e%1==0&&e<t}},{}],50:[function(e,t,n){var i=e("./eq"),s=e("./isArrayLike"),a=e("./_isIndex"),r=e("./isObject");t.exports=function(e,t,n){if(!r(n))return!1;var o=typeof t;return!!("number"==o?s(n)&&a(t,n.length):"string"==o&&t in n)&&i(n[t],e)}},{"./_isIndex":49,"./eq":82,"./isArrayLike":86,"./isObject":91}],51:[function(e,t,n){t.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},{}],52:[function(e,t,n){var i,s=e("./_coreJsData"),a=(i=/[^.]+$/.exec(s&&s.keys&&s.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";t.exports=function(e){return!!a&&a in e}},{"./_coreJsData":32}],53:[function(e,t,n){var i=Object.prototype;t.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||i)}},{}],54:[function(e,t,n){t.exports=function(){this.__data__=[],this.size=0}},{}],55:[function(e,t,n){var i=e("./_assocIndexOf"),s=Array.prototype.splice;t.exports=function(e){var t=this.__data__,n=i(t,e);return!(n<0)&&(n==t.length-1?t.pop():s.call(t,n,1),--this.size,!0)}},{"./_assocIndexOf":12}],56:[function(e,t,n){var i=e("./_assocIndexOf");t.exports=function(e){var t=this.__data__,n=i(t,e);return n<0?void 0:t[n][1]}},{"./_assocIndexOf":12}],57:[function(e,t,n){var i=e("./_assocIndexOf");t.exports=function(e){return i(this.__data__,e)>-1}},{"./_assocIndexOf":12}],58:[function(e,t,n){var i=e("./_assocIndexOf");t.exports=function(e,t){var n=this.__data__,s=i(n,e);return s<0?(++this.size,n.push([e,t])):n[s][1]=t,this}},{"./_assocIndexOf":12}],59:[function(e,t,n){var i=e("./_Hash"),s=e("./_ListCache"),a=e("./_Map");t.exports=function(){this.size=0,this.__data__={hash:new i,map:new(a||s),string:new i}}},{"./_Hash":1,"./_ListCache":2,"./_Map":3}],60:[function(e,t,n){var i=e("./_getMapData");t.exports=function(e){var t=i(this,e).delete(e);return this.size-=t?1:0,t}},{"./_getMapData":38}],61:[function(e,t,n){var i=e("./_getMapData");t.exports=function(e){return i(this,e).get(e)}},{"./_getMapData":38}],62:[function(e,t,n){var i=e("./_getMapData");t.exports=function(e){return i(this,e).has(e)}},{"./_getMapData":38}],63:[function(e,t,n){var i=e("./_getMapData");t.exports=function(e,t){var n=i(this,e),s=n.size;return n.set(e,t),this.size+=n.size==s?0:1,this}},{"./_getMapData":38}],64:[function(e,t,n){var i=e("./_getNative")(Object,"create");t.exports=i},{"./_getNative":39}],65:[function(e,t,n){t.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},{}],66:[function(e,t,n){var i=e("./_freeGlobal"),s="object"==typeof n&&n&&!n.nodeType&&n,a=s&&"object"==typeof t&&t&&!t.nodeType&&t,r=a&&a.exports===s&&i.process,o=function(){try{var e=a&&a.require&&a.require("util").types;return e||r&&r.binding&&r.binding("util")}catch(e){}}();t.exports=o},{"./_freeGlobal":37}],67:[function(e,t,n){var i=Object.prototype.toString;t.exports=function(e){return i.call(e)}},{}],68:[function(e,t,n){t.exports=function(e,t){return function(n){return e(t(n))}}},{}],69:[function(e,t,n){var i=e("./_apply"),s=Math.max;t.exports=function(e,t,n){return t=s(void 0===t?e.length-1:t,0),function(){for(var a=arguments,r=-1,o=s(a.length-t,0),c=Array(o);++r<o;)c[r]=a[t+r];r=-1;for(var l=Array(t+1);++r<t;)l[r]=a[r];return l[t]=n(c),i(e,this,l)}}},{"./_apply":8}],70:[function(e,t,n){var i=e("./_freeGlobal"),s="object"==typeof self&&self&&self.Object===Object&&self,a=i||s||Function("return this")();t.exports=a},{"./_freeGlobal":37}],71:[function(e,t,n){t.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},{}],72:[function(e,t,n){var i=e("./_baseSetToString"),s=e("./_shortOut")(i);t.exports=s},{"./_baseSetToString":24,"./_shortOut":73}],73:[function(e,t,n){var i=Date.now;t.exports=function(e){var t=0,n=0;return function(){var s=i(),a=16-(s-n);if(n=s,a>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},{}],74:[function(e,t,n){var i=e("./_ListCache");t.exports=function(){this.__data__=new i,this.size=0}},{"./_ListCache":2}],75:[function(e,t,n){t.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},{}],76:[function(e,t,n){t.exports=function(e){return this.__data__.get(e)}},{}],77:[function(e,t,n){t.exports=function(e){return this.__data__.has(e)}},{}],78:[function(e,t,n){var i=e("./_ListCache"),s=e("./_Map"),a=e("./_MapCache");t.exports=function(e,t){var n=this.__data__;if(n instanceof i){var r=n.__data__;if(!s||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new a(r)}return n.set(e,t),this.size=n.size,this}},{"./_ListCache":2,"./_Map":3,"./_MapCache":4}],79:[function(e,t,n){var i=Function.prototype.toString;t.exports=function(e){if(null!=e){try{return i.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},{}],80:[function(e,t,n){t.exports=function(e){return function(){return e}}},{}],81:[function(e,t,n){var i=e("./_apply"),s=e("./_baseRest"),a=e("./_customDefaultsMerge"),r=e("./mergeWith"),o=s((function(e){return e.push(void 0,a),i(r,void 0,e)}));t.exports=o},{"./_apply":8,"./_baseRest":23,"./_customDefaultsMerge":35,"./mergeWith":96}],82:[function(e,t,n){t.exports=function(e,t){return e===t||e!=e&&t!=t}},{}],83:[function(e,t,n){t.exports=function(e){return e}},{}],84:[function(e,t,n){var i=e("./_baseIsArguments"),s=e("./isObjectLike"),a=Object.prototype,r=a.hasOwnProperty,o=a.propertyIsEnumerable,c=i(function(){return arguments}())?i:function(e){return s(e)&&r.call(e,"callee")&&!o.call(e,"callee")};t.exports=c},{"./_baseIsArguments":17,"./isObjectLike":92}],85:[function(e,t,n){var i=Array.isArray;t.exports=i},{}],86:[function(e,t,n){var i=e("./isFunction"),s=e("./isLength");t.exports=function(e){return null!=e&&s(e.length)&&!i(e)}},{"./isFunction":89,"./isLength":90}],87:[function(e,t,n){var i=e("./isArrayLike"),s=e("./isObjectLike");t.exports=function(e){return s(e)&&i(e)}},{"./isArrayLike":86,"./isObjectLike":92}],88:[function(e,t,n){var i=e("./_root"),s=e("./stubFalse"),a="object"==typeof n&&n&&!n.nodeType&&n,r=a&&"object"==typeof t&&t&&!t.nodeType&&t,o=r&&r.exports===a?i.Buffer:void 0,c=(o?o.isBuffer:void 0)||s;t.exports=c},{"./_root":70,"./stubFalse":97}],89:[function(e,t,n){var i=e("./_baseGetTag"),s=e("./isObject");t.exports=function(e){if(!s(e))return!1;var t=i(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},{"./_baseGetTag":16,"./isObject":91}],90:[function(e,t,n){t.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},{}],91:[function(e,t,n){t.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},{}],92:[function(e,t,n){t.exports=function(e){return null!=e&&"object"==typeof e}},{}],93:[function(e,t,n){var i=e("./_baseGetTag"),s=e("./_getPrototype"),a=e("./isObjectLike"),r=Function.prototype,o=Object.prototype,c=r.toString,l=o.hasOwnProperty,d=c.call(Object);t.exports=function(e){if(!a(e)||"[object Object]"!=i(e))return!1;var t=s(e);if(null===t)return!0;var n=l.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==d}},{"./_baseGetTag":16,"./_getPrototype":40,"./isObjectLike":92}],94:[function(e,t,n){var i=e("./_baseIsTypedArray"),s=e("./_baseUnary"),a=e("./_nodeUtil"),r=a&&a.isTypedArray,o=r?s(r):i;t.exports=o},{"./_baseIsTypedArray":19,"./_baseUnary":26,"./_nodeUtil":66}],95:[function(e,t,n){var i=e("./_arrayLikeKeys"),s=e("./_baseKeysIn"),a=e("./isArrayLike");t.exports=function(e){return a(e)?i(e,!0):s(e)}},{"./_arrayLikeKeys":9,"./_baseKeysIn":20,"./isArrayLike":86}],96:[function(e,t,n){var i=e("./_baseMerge"),s=e("./_createAssigner")((function(e,t,n,s){i(e,t,n,s)}));t.exports=s},{"./_baseMerge":21,"./_createAssigner":33}],97:[function(e,t,n){t.exports=function(){return!1}},{}],98:[function(e,t,n){var i=e("./_copyObject"),s=e("./keysIn");t.exports=function(e){return i(e,s(e))}},{"./_copyObject":31,"./keysIn":95}],99:[function(e,t,n){var i,s;i=this,s=function(){var e=function(){},t="undefined"!=typeof window&&void 0!==window.navigator&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"];function i(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(n){return"debug"===n&&(n="log"),"undefined"!=typeof console&&("trace"===n&&t?s:void 0!==console[n]?i(console,n):void 0!==console.log?i(console,"log"):e)}function r(t,i){for(var s=0;s<n.length;s++){var a=n[s];this[a]=s<t?e:this.methodFactory(a,t,i)}this.log=this.debug}function o(e,t,n){return function(){"undefined"!=typeof console&&(r.call(this,t,n),this[e].apply(this,arguments))}}function c(e,t,n){return a(e)||o.apply(this,arguments)}function l(e,t,i){var s,a=this;t=null==t?"WARN":t;var o="loglevel";function l(){var e;if("undefined"!=typeof window&&o){try{e=window.localStorage[o]}catch(e){}if(void 0===e)try{var t=window.document.cookie,n=t.indexOf(encodeURIComponent(o)+"=");-1!==n&&(e=/^([^;]+)/.exec(t.slice(n))[1])}catch(e){}return void 0===a.levels[e]&&(e=void 0),e}}"string"==typeof e?o+=":"+e:"symbol"==typeof e&&(o=void 0),a.name=e,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=i||c,a.getLevel=function(){return s},a.setLevel=function(t,i){if("string"==typeof t&&void 0!==a.levels[t.toUpperCase()]&&(t=a.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(s=t,!1!==i&&function(e){var t=(n[e]||"silent").toUpperCase();if("undefined"!=typeof window&&o){try{return void(window.localStorage[o]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(o)+"="+t+";"}catch(e){}}}(t),r.call(a,t,e),"undefined"==typeof console&&t<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(e){t=e,l()||a.setLevel(e,!1)},a.resetLevel=function(){a.setLevel(t,!1),function(){if("undefined"!=typeof window&&o){try{return void window.localStorage.removeItem(o)}catch(e){}try{window.document.cookie=encodeURIComponent(o)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},a.enableAll=function(e){a.setLevel(a.levels.TRACE,e)},a.disableAll=function(e){a.setLevel(a.levels.SILENT,e)};var d=l();null==d&&(d=t),a.setLevel(d,!1)}var d=new l,h={};d.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=h[e];return t||(t=h[e]=new l(e,d.getLevel(),d.methodFactory)),t};var p="undefined"!=typeof window?window.log:void 0;return d.noConflict=function(){return"undefined"!=typeof window&&window.log===d&&(window.log=p),d},d.getLoggers=function(){return h},d.default=d,d},"object"==typeof t&&t.exports?t.exports=s():i.log=s()},{}],100:[function(e,t,n){var i=e("sdp");function s(e,t,n,s,a){var r=i.writeRtpDescription(e.kind,t);if(r+=i.writeIceParameters(e.iceGatherer.getLocalParameters()),r+=i.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":a||"active"),r+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?r+="a=sendrecv\r\n":e.rtpSender?r+="a=sendonly\r\n":e.rtpReceiver?r+="a=recvonly\r\n":r+="a=inactive\r\n",e.rtpSender){var o=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=o;var c="msid:"+(s?s.id:"-")+" "+o+"\r\n";r+="a="+c,r+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(r+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,r+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return r+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(r+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),r}function a(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},i=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},s=function(e,t,n,s){var a=i(e.parameters.apt,n),r=i(t.parameters.apt,s);return a&&r&&a.name.toLowerCase()===r.name.toLowerCase()};return e.codecs.forEach((function(i){for(var a=0;a<t.codecs.length;a++){var r=t.codecs[a];if(i.name.toLowerCase()===r.name.toLowerCase()&&i.clockRate===r.clockRate){if("rtx"===i.name.toLowerCase()&&i.parameters&&r.parameters.apt&&!s(i,r,e.codecs,t.codecs))continue;(r=JSON.parse(JSON.stringify(r))).numChannels=Math.min(i.numChannels,r.numChannels),n.codecs.push(r),r.rtcpFeedback=r.rtcpFeedback.filter((function(e){for(var t=0;t<i.rtcpFeedback.length;t++)if(i.rtcpFeedback[t].type===e.type&&i.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var i=0;i<t.headerExtensions.length;i++){var s=t.headerExtensions[i];if(e.uri===s.uri){n.headerExtensions.push(s);break}}})),n}function r(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function o(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function c(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}t.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function l(t,n,i,s){var a=new Event("track");a.track=n,a.receiver=i,a.transceiver={receiver:i},a.streams=s,e.setTimeout((function(){t._dispatchEvent("track",a)}))}var d=function(n){var s=this,a=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){s[e]=a[e].bind(a)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var i=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var s="string"==typeof i;return s&&(i=[i]),i=i.filter((function(e){return 0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!n?(n=!0,!0):0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp")})),delete e.url,e.urls=s?i[0]:i,!!i.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var r=n.iceCandidatePoolSize;r>0;r--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=i.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(d.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(d.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),d.prototype.onicecandidate=null,d.prototype.onaddstream=null,d.prototype.ontrack=null,d.prototype.onremovestream=null,d.prototype.onsignalingstatechange=null,d.prototype.oniceconnectionstatechange=null,d.prototype.onconnectionstatechange=null,d.prototype.onicegatheringstatechange=null,d.prototype.onnegotiationneeded=null,d.prototype.ondatachannel=null,d.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},d.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},d.prototype.getConfiguration=function(){return this._config},d.prototype.getLocalStreams=function(){return this.localStreams},d.prototype.getRemoteStreams=function(){return this.remoteStreams},d.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,i={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)i.iceTransport=this.transceivers[0].iceTransport,i.dtlsTransport=this.transceivers[0].dtlsTransport;else{var s=this._createIceAndDtlsTransports();i.iceTransport=s.iceTransport,i.dtlsTransport=s.dtlsTransport}return t||this.transceivers.push(i),i},d.prototype.addTrack=function(t,n){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var i;if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var s=0;s<this.transceivers.length;s++)this.transceivers[s].track||this.transceivers[s].kind!==t.kind||(i=this.transceivers[s]);return i||(i=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),i.track=t,i.stream=n,i.rtpSender=new e.RTCRtpSender(t,i.dtlsTransport),i.rtpSender},d.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var i=e.clone();e.getTracks().forEach((function(e,t){var n=i.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),i.getTracks().forEach((function(e){n.addTrack(e,i)}))}},d.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw c("InvalidAccessError","Sender was not created by this connection.");var i=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(i)&&this.localStreams.indexOf(i)>-1&&this.localStreams.splice(this.localStreams.indexOf(i),1),this._maybeFireNegotiationNeeded()},d.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},d.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},d.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},d.prototype._createIceGatherer=function(t,n){var i=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var s=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(s,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;s.state=n?"completed":"gathering",null!==i.transceivers[t].bufferedCandidateEvents&&i.transceivers[t].bufferedCandidateEvents.push(e)},s.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),s},d.prototype._gather=function(t,n){var s=this,a=this.transceivers[n].iceGatherer;if(!a.onlocalcandidate){var r=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,a.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),a.onlocalcandidate=function(e){if(!(s.usingBundle&&n>0)){var r=new Event("icecandidate");r.candidate={sdpMid:t,sdpMLineIndex:n};var o=e.candidate,c=!o||0===Object.keys(o).length;if(c)"new"!==a.state&&"gathering"!==a.state||(a.state="completed");else{"new"===a.state&&(a.state="gathering"),o.component=1,o.ufrag=a.getLocalParameters().usernameFragment;var l=i.writeCandidate(o);r.candidate=Object.assign(r.candidate,i.parseCandidate(l)),r.candidate.candidate=l,r.candidate.toJSON=function(){return{candidate:r.candidate.candidate,sdpMid:r.candidate.sdpMid,sdpMLineIndex:r.candidate.sdpMLineIndex,usernameFragment:r.candidate.usernameFragment}}}var d=i.getMediaSections(s._localDescription.sdp);d[r.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+r.candidate.candidate+"\r\n",s._localDescription.sdp=i.getDescription(s._localDescription.sdp)+d.join("");var h=s.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==s.iceGatheringState&&(s.iceGatheringState="gathering",s._emitGatheringStateChange()),c||s._dispatchEvent("icecandidate",r),h&&(s._dispatchEvent("icecandidate",new Event("icecandidate")),s.iceGatheringState="complete",s._emitGatheringStateChange())}},e.setTimeout((function(){r.forEach((function(e){a.onlocalcandidate(e)}))}),0)}},d.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var i=new e.RTCDtlsTransport(n);return i.ondtlsstatechange=function(){t._updateConnectionState()},i.onerror=function(){Object.defineProperty(i,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:i}},d.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var i=this.transceivers[e].dtlsTransport;i&&(delete i.ondtlsstatechange,delete i.onerror,delete this.transceivers[e].dtlsTransport)},d.prototype._transceive=function(e,n,s){var r=a(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(r.encodings=e.sendEncodingParameters,r.rtcp={cname:i.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(r.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(r)),s&&e.rtpReceiver&&r.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?r.encodings=e.recvEncodingParameters:r.encodings=[{}],r.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(r.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(r.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(r))},d.prototype.setLocalDescription=function(e){var t,n,s=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!r("setLocalDescription",e.type,s.signalingState)||s._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+s.signalingState));if("offer"===e.type)t=i.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=i.parseRtpParameters(e);s.transceivers[t].localCapabilities=n})),s.transceivers.forEach((function(e,t){s._gather(e.mid,t)}));else if("answer"===e.type){t=i.splitSections(s._remoteDescription.sdp),n=t.shift();var o=i.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var r=s.transceivers[t],c=r.iceGatherer,l=r.iceTransport,d=r.dtlsTransport,h=r.localCapabilities,p=r.remoteCapabilities;if(!(i.isRejected(e)&&0===i.matchPrefix(e,"a=bundle-only").length)&&!r.rejected){var u=i.getIceParameters(e,n),m=i.getDtlsParameters(e,n);o&&(m.role="server"),s.usingBundle&&0!==t||(s._gather(r.mid,t),"new"===l.state&&l.start(c,u,o?"controlling":"controlled"),"new"===d.state&&d.start(m));var g=a(h,p);s._transceive(r,g.codecs.length>0,!1)}}))}return s._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?s._updateSignalingState("have-local-offer"):s._updateSignalingState("stable"),Promise.resolve()},d.prototype.setRemoteDescription=function(s){var d=this;if(-1===["offer","answer"].indexOf(s.type))return Promise.reject(c("TypeError",'Unsupported type "'+s.type+'"'));if(!r("setRemoteDescription",s.type,d.signalingState)||d._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+s.type+" in state "+d.signalingState));var h={};d.remoteStreams.forEach((function(e){h[e.id]=e}));var p=[],u=i.splitSections(s.sdp),m=u.shift(),g=i.matchPrefix(m,"a=ice-lite").length>0,f=i.matchPrefix(m,"a=group:BUNDLE ").length>0;d.usingBundle=f;var v=i.matchPrefix(m,"a=ice-options:")[0];return d.canTrickleIceCandidates=!!v&&v.substr(14).split(" ").indexOf("trickle")>=0,u.forEach((function(r,c){var l=i.splitLines(r),u=i.getKind(r),v=i.isRejected(r)&&0===i.matchPrefix(r,"a=bundle-only").length,b=l[0].substr(2).split(" ")[2],y=i.getDirection(r,m),C=i.parseMsid(r),S=i.getMid(r)||i.generateIdentifier();if(v||"application"===u&&("DTLS/SCTP"===b||"UDP/DTLS/SCTP"===b))d.transceivers[c]={mid:S,kind:u,protocol:b,rejected:!0};else{var E,T,I,k,w,P,R,x,_;!v&&d.transceivers[c]&&d.transceivers[c].rejected&&(d.transceivers[c]=d._createTransceiver(u,!0));var M,D,O=i.parseRtpParameters(r);v||(M=i.getIceParameters(r,m),(D=i.getDtlsParameters(r,m)).role="client"),R=i.parseRtpEncodingParameters(r);var L=i.parseRtcpParameters(r),A=i.matchPrefix(r,"a=end-of-candidates",m).length>0,N=i.matchPrefix(r,"a=candidate:").map((function(e){return i.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===s.type||"answer"===s.type)&&!v&&f&&c>0&&d.transceivers[c]&&(d._disposeIceAndDtlsTransports(c),d.transceivers[c].iceGatherer=d.transceivers[0].iceGatherer,d.transceivers[c].iceTransport=d.transceivers[0].iceTransport,d.transceivers[c].dtlsTransport=d.transceivers[0].dtlsTransport,d.transceivers[c].rtpSender&&d.transceivers[c].rtpSender.setTransport(d.transceivers[0].dtlsTransport),d.transceivers[c].rtpReceiver&&d.transceivers[c].rtpReceiver.setTransport(d.transceivers[0].dtlsTransport)),"offer"!==s.type||v){if("answer"===s.type&&!v){T=(E=d.transceivers[c]).iceGatherer,I=E.iceTransport,k=E.dtlsTransport,w=E.rtpReceiver,P=E.sendEncodingParameters,x=E.localCapabilities,d.transceivers[c].recvEncodingParameters=R,d.transceivers[c].remoteCapabilities=O,d.transceivers[c].rtcpParameters=L,N.length&&"new"===I.state&&(!g&&!A||f&&0!==c?N.forEach((function(e){o(E.iceTransport,e)})):I.setRemoteCandidates(N)),f&&0!==c||("new"===I.state&&I.start(T,M,"controlling"),"new"===k.state&&k.start(D)),!a(E.localCapabilities,E.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&E.sendEncodingParameters[0].rtx&&delete E.sendEncodingParameters[0].rtx,d._transceive(E,"sendrecv"===y||"recvonly"===y,"sendrecv"===y||"sendonly"===y),!w||"sendrecv"!==y&&"sendonly"!==y?delete E.rtpReceiver:(_=w.track,C?(h[C.stream]||(h[C.stream]=new e.MediaStream),n(_,h[C.stream]),p.push([_,w,h[C.stream]])):(h.default||(h.default=new e.MediaStream),n(_,h.default),p.push([_,w,h.default])))}}else{(E=d.transceivers[c]||d._createTransceiver(u)).mid=S,E.iceGatherer||(E.iceGatherer=d._createIceGatherer(c,f)),N.length&&"new"===E.iceTransport.state&&(!A||f&&0!==c?N.forEach((function(e){o(E.iceTransport,e)})):E.iceTransport.setRemoteCandidates(N)),x=e.RTCRtpReceiver.getCapabilities(u),t<15019&&(x.codecs=x.codecs.filter((function(e){return"rtx"!==e.name}))),P=E.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var B,G=!1;if("sendrecv"===y||"sendonly"===y){if(G=!E.rtpReceiver,w=E.rtpReceiver||new e.RTCRtpReceiver(E.dtlsTransport,u),G)_=w.track,C&&"-"===C.stream||(C?(h[C.stream]||(h[C.stream]=new e.MediaStream,Object.defineProperty(h[C.stream],"id",{get:function(){return C.stream}})),Object.defineProperty(_,"id",{get:function(){return C.track}}),B=h[C.stream]):(h.default||(h.default=new e.MediaStream),B=h.default)),B&&(n(_,B),E.associatedRemoteMediaStreams.push(B)),p.push([_,w,B])}else E.rtpReceiver&&E.rtpReceiver.track&&(E.associatedRemoteMediaStreams.forEach((function(t){var n=t.getTracks().find((function(e){return e.id===E.rtpReceiver.track.id}));n&&function(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(n,t)})),E.associatedRemoteMediaStreams=[]);E.localCapabilities=x,E.remoteCapabilities=O,E.rtpReceiver=w,E.rtcpParameters=L,E.sendEncodingParameters=P,E.recvEncodingParameters=R,d._transceive(d.transceivers[c],!1,G)}}})),void 0===d._dtlsRole&&(d._dtlsRole="offer"===s.type?"active":"passive"),d._remoteDescription={type:s.type,sdp:s.sdp},"offer"===s.type?d._updateSignalingState("have-remote-offer"):d._updateSignalingState("stable"),Object.keys(h).forEach((function(t){var n=h[t];if(n.getTracks().length){if(-1===d.remoteStreams.indexOf(n)){d.remoteStreams.push(n);var i=new Event("addstream");i.stream=n,e.setTimeout((function(){d._dispatchEvent("addstream",i)}))}p.forEach((function(e){var t=e[0],i=e[1];n.id===e[2].id&&l(d,t,i,[n])}))}})),p.forEach((function(e){e[2]||l(d,e[0],e[1],[])})),e.setTimeout((function(){d&&d.transceivers&&d.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},d.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},d.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},d.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},d.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},d.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},d.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var a=n.transceivers.filter((function(e){return"audio"===e.kind})).length,r=n.transceivers.filter((function(e){return"video"===e.kind})).length,o=arguments[0];if(o){if(o.mandatory||o.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==o.offerToReceiveAudio&&(a=!0===o.offerToReceiveAudio?1:!1===o.offerToReceiveAudio?0:o.offerToReceiveAudio),void 0!==o.offerToReceiveVideo&&(r=!0===o.offerToReceiveVideo?1:!1===o.offerToReceiveVideo?0:o.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--a<0&&(e.wantReceive=!1):"video"===e.kind&&--r<0&&(e.wantReceive=!1)}));a>0||r>0;)a>0&&(n._createTransceiver("audio"),a--),r>0&&(n._createTransceiver("video"),r--);var l=i.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(s,a){var r=s.track,o=s.kind,c=s.mid||i.generateIdentifier();s.mid=c,s.iceGatherer||(s.iceGatherer=n._createIceGatherer(a,n.usingBundle));var l=e.RTCRtpSender.getCapabilities(o);t<15019&&(l.codecs=l.codecs.filter((function(e){return"rtx"!==e.name}))),l.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),s.remoteCapabilities&&s.remoteCapabilities.codecs&&s.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),l.headerExtensions.forEach((function(e){(s.remoteCapabilities&&s.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var d=s.sendEncodingParameters||[{ssrc:1001*(2*a+1)}];r&&t>=15019&&"video"===o&&!d[0].rtx&&(d[0].rtx={ssrc:d[0].ssrc+1}),s.wantReceive&&(s.rtpReceiver=new e.RTCRtpReceiver(s.dtlsTransport,o)),s.localCapabilities=l,s.sendEncodingParameters=d})),"max-compat"!==n._config.bundlePolicy&&(l+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),l+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){l+=s(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),l+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,l+="a="+i.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(l+="a=end-of-candidates\r\n"))}));var d=new e.RTCSessionDescription({type:"offer",sdp:l});return Promise.resolve(d)},d.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var r=i.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(r+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),r+="a=ice-options:trickle\r\n";var o=i.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,i){if(!(i+1>o)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?r+="m=application 0 DTLS/SCTP 5000\r\n":r+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?r+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(r+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(r+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;if(e.stream)"audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var l=a(e.localCapabilities,e.remoteCapabilities);!l.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,r+=s(e,l,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(r+="a=rtcp-rsize\r\n")}}));var l=new e.RTCSessionDescription({type:"answer",sdp:r});return Promise.resolve(l)},d.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(s,a){if(!n._remoteDescription)return a(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var r=e.sdpMLineIndex;if(e.sdpMid)for(var l=0;l<n.transceivers.length;l++)if(n.transceivers[l].mid===e.sdpMid){r=l;break}var d=n.transceivers[r];if(!d)return a(c("OperationError","Can not add ICE candidate"));if(d.rejected)return s();var h=Object.keys(e.candidate).length>0?i.parseCandidate(e.candidate):{};if("tcp"===h.protocol&&(0===h.port||9===h.port))return s();if(h.component&&1!==h.component)return s();if((0===r||r>0&&d.iceTransport!==n.transceivers[0].iceTransport)&&!o(d.iceTransport,h))return a(c("OperationError","Can not add ICE candidate"));var p=e.candidate.trim();0===p.indexOf("a=")&&(p=p.substr(2)),(t=i.getMediaSections(n._remoteDescription.sdp))[r]+="a="+(h.type?p:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=i.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var u=0;u<n.transceivers.length&&(n.transceivers[u].rejected||(n.transceivers[u].iceTransport.addRemoteCandidate({}),(t=i.getMediaSections(n._remoteDescription.sdp))[u]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=i.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));u++);s()}))},d.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw c("InvalidAccessError","Invalid selector.");return n.getStats()}var i=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&i.push(e[t].getStats())}))})),Promise.all(i).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var i=n.prototype.getStats;n.prototype.getStats=function(){return i.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){var i;e[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(i=e[n]).type]||i.type,t.set(n,e[n])})),t}))}}}));var h=["createOffer","createAnswer"];return h.forEach((function(e){var t=d.prototype[e];d.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(h=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=d.prototype[e];d.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=d.prototype[e];d.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),d}},{sdp:101}],101:[function(e,t,n){var i={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};i.localCName=i.generateIdentifier(),i.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},i.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},i.getDescription=function(e){var t=i.splitSections(e);return t&&t[0]},i.getMediaSections=function(e){var t=i.splitSections(e);return t.shift(),t},i.matchPrefix=function(e,t){return i.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},i.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:n[t[i]]=t[i+1]}return n},i.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},i.parseIceOptions=function(e){return e.substr(14).split(" ")},i.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},i.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},i.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},i.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},i.parseFmtp=function(e){for(var t,n={},i=e.substr(e.indexOf(" ")+1).split(";"),s=0;s<i.length;s++)n[(t=i[s].trim().split("="))[0].trim()]=t[1];return n},i.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var i=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},i.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},i.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},i.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substr(t+1,i-t-1),n.value=e.substr(i+1)):n.attribute=e.substr(t+1),n},i.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},i.getMid=function(e){var t=i.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},i.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},i.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:i.matchPrefix(e+t,"a=fingerprint:").map(i.parseFingerprint)}},i.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},i.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},i.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?i.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},i.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},i.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},i.getCryptoParameters=function(e,t){return i.matchPrefix(e+t,"a=crypto:").map(i.parseCryptoLine)},i.getIceParameters=function(e,t){var n=i.matchPrefix(e+t,"a=ice-ufrag:")[0],s=i.matchPrefix(e+t,"a=ice-pwd:")[0];return n&&s?{usernameFragment:n.substr(12),password:s.substr(10)}:null},i.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},i.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=i.splitLines(e)[0].split(" "),s=3;s<n.length;s++){var a=n[s],r=i.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(r){var o=i.parseRtpMap(r),c=i.matchPrefix(e,"a=fmtp:"+a+" ");switch(o.parameters=c.length?i.parseFmtp(c[0]):{},o.rtcpFeedback=i.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(i.parseRtcpFb),t.codecs.push(o),o.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(o.name.toUpperCase())}}}return i.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(i.parseExtmap(e))})),t},i.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){n+=i.writeRtpMap(e),n+=i.writeFmtp(e),n+=i.writeRtcpFb(e)}));var s=0;return t.codecs.forEach((function(e){e.maxptime>s&&(s=e.maxptime)})),s>0&&(n+="a=maxptime:"+s+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){n+=i.writeExtmap(e)})),n},i.parseRtpEncodingParameters=function(e){var t,n=[],s=i.parseRtpParameters(e),a=-1!==s.fecMechanisms.indexOf("RED"),r=-1!==s.fecMechanisms.indexOf("ULPFEC"),o=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=o.length>0&&o[0].ssrc,l=i.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));l.length>0&&l[0].length>1&&l[0][0]===c&&(t=l[0][1]),s.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var i={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(i.rtx={ssrc:t}),n.push(i),a&&((i=JSON.parse(JSON.stringify(i))).fec={ssrc:c,mechanism:r?"red+ulpfec":"red"},n.push(i))}})),0===n.length&&c&&n.push({ssrc:c});var d=i.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?1e3*parseInt(d[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(e){e.maxBitrate=d}))),n},i.parseRtcpParameters=function(e){var t={},n=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var s=i.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=s.length>0,t.compound=0===s.length;var a=i.matchPrefix(e,"a=rtcp-mux");return t.mux=a.length>0,t},i.parseMsid=function(e){var t,n=i.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var s=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return s.length>0?{stream:(t=s[0].value.split(" "))[0],track:t[1]}:void 0},i.parseSctpDescription=function(e){var t,n=i.parseMLine(e),s=i.matchPrefix(e,"a=max-message-size:");s.length>0&&(t=parseInt(s[0].substr(19),10)),isNaN(t)&&(t=65536);var a=i.matchPrefix(e,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(i.matchPrefix(e,"a=sctpmap:").length>0){var r=i.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(r[0],10),protocol:r[1],maxMessageSize:t}}},i.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},i.generateSessionId=function(){return Math.random().toString().substr(2,21)},i.writeSessionBoilerplate=function(e,t,n){var s=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||i.generateSessionId())+" "+s+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},i.writeMediaSection=function(e,t,n,s){var a=i.writeRtpDescription(e.kind,t);if(a+=i.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=i.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),a+="a=mid:"+e.mid+"\r\n",e.direction?a+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var r="msid:"+s.id+" "+e.rtpSender.track.id+"\r\n";a+="a="+r,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+r,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+r,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),a},i.getDirection=function(e,t){for(var n=i.splitLines(e),s=0;s<n.length;s++)switch(n[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[s].substr(2)}return t?i.getDirection(t):"sendrecv"},i.getKind=function(e){return i.splitLines(e)[0].split(" ")[0].substr(2)},i.isRejected=function(e){return"0"===e.split(" ",2)[1]},i.parseMLine=function(e){var t=i.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},i.parseOLine=function(e){var t=i.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},i.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=i.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=i)},{}],102:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=(0,e("./adapter_factory.js").adapterFactory)({window:"undefined"==typeof window?void 0:window});n.default=i},{"./adapter_factory.js":103}],103:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.window,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},l=i.log,d=i.detectBrowser(t),h={browserDetails:d,commonShim:c,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings};switch(d.browser){case"chrome":if(!s||!s.shimPeerConnection||!n.shimChrome)return l("Chrome shim is not included in this adapter release."),h;if(null===d.version)return l("Chrome shim can not determine version, not shimming."),h;l("adapter.js shimming chrome."),h.browserShim=s,c.shimAddIceCandidateNullOrEmpty(t,d),s.shimGetUserMedia(t,d),s.shimMediaStream(t,d),s.shimPeerConnection(t,d),s.shimOnTrack(t,d),s.shimAddTrackRemoveTrack(t,d),s.shimGetSendersWithDtmf(t,d),s.shimGetStats(t,d),s.shimSenderReceiverGetStats(t,d),s.fixNegotiationNeeded(t,d),c.shimRTCIceCandidate(t,d),c.shimConnectionState(t,d),c.shimMaxMessageSize(t,d),c.shimSendThrowTypeError(t,d),c.removeExtmapAllowMixed(t,d);break;case"firefox":if(!r||!r.shimPeerConnection||!n.shimFirefox)return l("Firefox shim is not included in this adapter release."),h;l("adapter.js shimming firefox."),h.browserShim=r,c.shimAddIceCandidateNullOrEmpty(t,d),r.shimGetUserMedia(t,d),r.shimPeerConnection(t,d),r.shimOnTrack(t,d),r.shimRemoveStream(t,d),r.shimSenderGetStats(t,d),r.shimReceiverGetStats(t,d),r.shimRTCDataChannel(t,d),r.shimAddTransceiver(t,d),r.shimGetParameters(t,d),r.shimCreateOffer(t,d),r.shimCreateAnswer(t,d),c.shimRTCIceCandidate(t,d),c.shimConnectionState(t,d),c.shimMaxMessageSize(t,d),c.shimSendThrowTypeError(t,d);break;case"edge":if(!a||!a.shimPeerConnection||!n.shimEdge)return l("MS edge shim is not included in this adapter release."),h;l("adapter.js shimming edge."),h.browserShim=a,a.shimGetUserMedia(t,d),a.shimGetDisplayMedia(t,d),a.shimPeerConnection(t,d),a.shimReplaceTrack(t,d),c.shimMaxMessageSize(t,d),c.shimSendThrowTypeError(t,d);break;case"safari":if(!o||!n.shimSafari)return l("Safari shim is not included in this adapter release."),h;l("adapter.js shimming safari."),h.browserShim=o,c.shimAddIceCandidateNullOrEmpty(t,d),o.shimRTCIceServerUrls(t,d),o.shimCreateOfferLegacy(t,d),o.shimCallbacksAPI(t,d),o.shimLocalStreamsAPI(t,d),o.shimRemoteStreamsAPI(t,d),o.shimTrackEventTransceiver(t,d),o.shimGetUserMedia(t,d),o.shimAudioContext(t,d),c.shimRTCIceCandidate(t,d),c.shimMaxMessageSize(t,d),c.shimSendThrowTypeError(t,d),c.removeExtmapAllowMixed(t,d);break;default:l("Unsupported browser!")}return h};var i=l(e("./utils")),s=l(e("./chrome/chrome_shim")),a=l(e("./edge/edge_shim")),r=l(e("./firefox/firefox_shim")),o=l(e("./safari/safari_shim")),c=l(e("./common_shim"));function l(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}},{"./chrome/chrome_shim":104,"./common_shim":107,"./edge/edge_shim":108,"./firefox/firefox_shim":112,"./safari/safari_shim":115,"./utils":116}],104:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return s.shimGetUserMedia}});var a=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}}),n.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},n.shimOnTrack=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(i){var s=void 0;s=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===i.track.id})):{track:i.track};var a=new Event("track");a.track=i.track,a.receiver=s,a.transceiver={receiver:s},a.streams=[t.stream],n.dispatchEvent(a)})),t.stream.getTracks().forEach((function(i){var s=void 0;s=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===i.id})):{track:i};var a=new Event("track");a.track=i,a.receiver=s,a.transceiver={receiver:s},a.streams=[t.stream],n.dispatchEvent(a)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else r.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}))},n.shimGetSendersWithDtmf=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){var s=n.apply(this,arguments);return s||(s=t(this,e),this._senders.push(s)),s};var s=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){s.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var a=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._senders=this._senders||[],a.apply(this,[e]),e.getTracks().forEach((function(e){n._senders.push(t(n,e))}))};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach((function(e){var n=t._senders.find((function(t){return t.track===e}));n&&t._senders.splice(t._senders.indexOf(n),1)}))}}else if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var o=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=o.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},n.shimGetStats=function(e){if(!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,n=Array.prototype.slice.call(arguments),i=n[0],s=n[1],a=n[2];if(arguments.length>0&&"function"==typeof i)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof i))return t.apply(this,[]);var r=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t},o=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){var c=function(e){s(o(r(e)))};return t.apply(this,[c,i])}return new Promise((function(n,i){t.apply(e,[function(e){n(o(r(e)))},i])})).then(s,a)}},n.shimSenderReceiverGetStats=function(e){if(!("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var s=e.RTCPeerConnection.prototype.getReceivers;s&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=s.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!1)}))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;var a=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],n=void 0,i=void 0,s=void 0;return this.getSenders().forEach((function(e){e.track===t&&(n?s=!0:n=e)})),this.getReceivers().forEach((function(e){return e.track===t&&(i?s=!0:i=e),e.track===t})),s||n&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return a.apply(this,arguments)}},n.shimAddTrackRemoveTrackWithNative=c,n.shimAddTrackRemoveTrack=function(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return c(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(n.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var s=new e.MediaStream(t.getTracks());this._streams[t.id]=s,this._reverseStreams[s.id]=t,t=s}i.apply(this,[t])};var s=e.RTCPeerConnection.prototype.removeStream;function a(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var i=e._reverseStreams[t],s=e._streams[i.id];n=n.replace(new RegExp(s.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}function r(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var i=e._reverseStreams[t],s=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),s.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var i=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var s=[].slice.call(arguments,1);if(1!==s.length||!s[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var a=this.getSenders().find((function(e){return e.track===t}));if(a)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var r=this._streams[n.id];if(r)r.addTrack(t),Promise.resolve().then((function(){i.dispatchEvent(new Event("negotiationneeded"))}));else{var o=new e.MediaStream([t]);this._streams[n.id]=o,this._reverseStreams[o.id]=n,this.addStream(o)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],i=o({},t,(function(){var e=this,t=arguments,i=arguments.length&&"function"==typeof arguments[0];return i?n.apply(this,[function(n){var i=a(e,n);t[0].apply(null,[i])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then((function(t){return a(e,t)}))}));e.RTCPeerConnection.prototype[t]=i[t]}));var l=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=r(this,arguments[0]),l.apply(this,arguments)):l.apply(this,arguments)};var d=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=d.get.apply(this);return""===e.type?e:a(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var n=void 0;Object.keys(this._streams).forEach((function(i){t._streams[i].getTracks().find((function(t){return e.track===t}))&&(n=t._streams[i])})),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}},n.shimPeerConnection=function(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection);if(!e.RTCPeerConnection)return;t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],i=o({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=i[t]}))},n.fixNegotiationNeeded=function(e,t){r.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){var n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils.js"));function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var i=this.getSenders();n.apply(this,arguments);var s=this.getSenders().filter((function(e){return-1===i.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(s)};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};var s=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(n){var i=t._shimmedLocalStreams[n].indexOf(e);-1!==i&&t._shimmedLocalStreams[n].splice(i,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]})),s.apply(this,arguments)}}},{"../utils.js":116,"./getdisplaymedia":105,"./getusermedia":106}],105:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;if(!e.navigator.mediaDevices)return;if("function"!=typeof t)return void console.error("shimGetDisplayMedia: getSourceId argument is not a function");e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((function(t){var i=n.video&&n.video.width,s=n.video&&n.video.height,a=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:a||3}},i&&(n.video.mandatory.maxWidth=i),s&&(n.video.mandatory.maxHeight=s),e.navigator.mediaDevices.getUserMedia(n)}))}}},{}],106:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimGetUserMedia=function(e,t){var n=e&&e.navigator;if(!n.mediaDevices)return;var a=function(e){if("object"!==(void 0===e?"undefined":i(e))||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var s="object"===i(e[n])?e[n]:{ideal:e[n]};void 0!==s.exact&&"number"==typeof s.exact&&(s.min=s.max=s.exact);var a=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==s.ideal){t.optional=t.optional||[];var r={};"number"==typeof s.ideal?(r[a("min",n)]=s.ideal,t.optional.push(r),(r={})[a("max",n)]=s.ideal,t.optional.push(r)):(r[a("",n)]=s.ideal,t.optional.push(r))}void 0!==s.exact&&"number"!=typeof s.exact?(t.mandatory=t.mandatory||{},t.mandatory[a("",n)]=s.exact):["min","max"].forEach((function(e){void 0!==s[e]&&(t.mandatory=t.mandatory||{},t.mandatory[a(e,n)]=s[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},r=function(e,r){if(t.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===i(e.audio)){var o=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};o((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),o(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=a(e.audio)}if(e&&"object"===i(e.video)){var c=e.video.facingMode;c=c&&("object"===(void 0===c?"undefined":i(c))?c:{ideal:c});var l=t.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||l)){delete e.video.facingMode;var d=void 0;if("environment"===c.exact||"environment"===c.ideal?d=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(d=["front"]),d)return n.mediaDevices.enumerateDevices().then((function(t){var n=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return d.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!n&&t.length&&d.includes("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=c.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=a(e.video),s("chrome: "+JSON.stringify(e)),r(e)}))}e.video=a(e.video)}return s("chrome: "+JSON.stringify(e)),r(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,i){r(e,(function(e){n.webkitGetUserMedia(e,t,(function(e){i&&i(o(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){var c=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return r(e,(function(e){return c(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(o(e))}))}))}}};var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils.js")).log},{"../utils.js":116}],107:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimRTCIceCandidate=function(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),s=r.default.parseCandidate(e.candidate),a=Object.assign(n,s);return a.toJSON=function(){return{candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex,usernameFragment:a.usernameFragment}},a}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,o.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))},n.shimMaxMessageSize=function(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=function(e){if(!e||!e.sdp)return!1;var t=r.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=r.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},i=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n},s=function(e){var n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},a=function(e,n){var i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);var s=r.default.matchPrefix(e.sdp,"a=max-message-size:");return s.length>0?i=parseInt(s[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i},o=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var e=this.getConfiguration(),r=e.sdpSemantics;"plan-b"===r&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){var c=i(arguments[0]),l=s(c),d=a(arguments[0],c),h=void 0;h=0===l&&0===d?Number.POSITIVE_INFINITY:0===l||0===d?Math.max(l,d):Math.min(l,d);var p={};Object.defineProperty(p,"maxMessageSize",{get:function(){return h}}),this._sctp=p}return o.apply(this,arguments)}},n.shimSendThrowTypeError=function(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){var n=e.send;e.send=function(){var i=arguments[0],s=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&s>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}var n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=n.apply(this,arguments);return t(e,this),e},o.wrapPeerConnectionEvent(e,"datachannel",(function(e){return t(e.channel,e.target),e}))},n.shimConnectionState=function(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))},n.removeExtmapAllowMixed=function(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){var i=t.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:i}):t.sdp=i}return n.apply(this,arguments)}},n.shimAddIceCandidateNullOrEmpty=function(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;var n=e.RTCPeerConnection.prototype.addIceCandidate;if(!n||0===n.length)return;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}};var s,a=e("sdp"),r=(s=a)&&s.__esModule?s:{default:s},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./utils"))},{"./utils":116,sdp:101}],108:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0;var i=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}});var s=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}}),n.shimPeerConnection=function(e,t){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}});e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var i=(0,l.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,o.filterIceServers)(e.iceServers,t.version),r.log("ICE servers after filtering:",e.iceServers)),new i(e)},e.RTCPeerConnection.prototype=i.prototype},n.shimReplaceTrack=function(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};var a,r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils")),o=e("./filtericeservers"),c=e("rtcpeerconnection-shim"),l=(a=c)&&a.__esModule?a:{default:a}},{"../utils":116,"./filtericeservers":109,"./getdisplaymedia":110,"./getusermedia":111,"rtcpeerconnection-shim":100}],109:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&i.deprecated("RTCIceServer.url","RTCIceServer.urls");var s="string"==typeof t;return s&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n})),delete e.url,e.urls=s?t[0]:t,!!t.length}}))};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":116}],110:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e){if(!("getDisplayMedia"in e.navigator))return;if(!e.navigator.mediaDevices)return;if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)}},{}],111:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},{}],112:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return s.shimGetUserMedia}});var a=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}}),n.shimOnTrack=function(e){"object"===(void 0===e?"undefined":i(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(e,t){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection);t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],i=function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=i[t]}));var n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),i=e[0],a=e[1],r=e[2];return s.apply(this,[i||null]).then((function(e){if(t.version<53&&!a)try{e.forEach((function(e){e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,i){e.set(i,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(a,r)}},n.shimSenderGetStats=function(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e});e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}},n.shimReceiverGetStats=function(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}},n.shimRemoveStream=function(e){if(!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype)return;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;r.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(n){n.track&&e.getTracks().includes(n.track)&&t.removeTrack(n)}))}},n.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},n.shimAddTransceiver=function(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((function(e){if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var i=t.apply(this,arguments);if(n){var s=i.sender,a=s.getParameters();(!("encodings"in a)||1===a.encodings.length&&0===Object.keys(a.encodings[0]).length)&&(a.encodings=e.sendEncodings,s.sendEncodings=e.sendEncodings,this.setParametersPromises.push(s.setParameters(a).then((function(){delete s.sendEncodings})).catch((function(){delete s.sendEncodings}))))}return i})},n.shimGetParameters=function(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCRtpSender)return;var t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})},n.shimCreateOffer=function(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=this,n=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,n)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}},n.shimCreateAnswer=function(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=this,n=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,n)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":116,"./getdisplaymedia":113,"./getusermedia":114}],113:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;if(!e.navigator.mediaDevices)return;e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)}}},{}],114:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimGetUserMedia=function(e,t){var n=e&&e.navigator,a=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){s.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var r=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":i(e))&&"object"===i(e.audio)&&(e=JSON.parse(JSON.stringify(e)),r(e.audio,"autoGainControl","mozAutoGainControl"),r(e.audio,"noiseSuppression","mozNoiseSuppression")),o(e)},a&&a.prototype.getSettings){var c=a.prototype.getSettings;a.prototype.getSettings=function(){var e=c.apply(this,arguments);return r(e,"mozAutoGainControl","autoGainControl"),r(e,"mozNoiseSuppression","noiseSuppression"),e}}if(a&&a.prototype.applyConstraints){var l=a.prototype.applyConstraints;a.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":i(e))&&(e=JSON.parse(JSON.stringify(e)),r(e,"autoGainControl","mozAutoGainControl"),r(e,"noiseSuppression","mozNoiseSuppression")),l.apply(this,[e])}}}};var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":116}],115:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimLocalStreamsAPI=function(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection)return;"getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams});if(!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(i){return t.call(n,i,e)})),e.getVideoTracks().forEach((function(i){return t.call(n,i,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=this,i=arguments.length,s=Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];return s&&s.forEach((function(e){n._localStreams?n._localStreams.includes(e)||n._localStreams.push(e):n._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(e);if(-1!==n){this._localStreams.splice(n,1);var i=e.getTracks();this.getSenders().forEach((function(e){i.includes(e.track)&&t.removeTrack(e)}))}})},n.shimRemoteStreamsAPI=function(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection)return;"getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]});if(!("onaddstream"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}}))}),t.apply(e,arguments)}}},n.shimCallbacksAPI=function(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype,n=t.createOffer,s=t.createAnswer,a=t.setLocalDescription,r=t.setRemoteDescription,o=t.addIceCandidate;t.createOffer=function(e,t){var i=arguments.length>=2?arguments[2]:arguments[0],s=n.apply(this,[i]);return t?(s.then(e,t),Promise.resolve()):s},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=s.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};var c=function(e,t,n){var i=a.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=c,c=function(e,t,n){var i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=c,c=function(e,t,n){var i=o.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=c},n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var n=t.mediaDevices,i=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=function(e){return i(a(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t))},n.shimConstraints=a,n.shimRTCIceServerUrls=function(e){if(!e.RTCPeerConnection)return;var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var i=[],a=0;a<e.iceServers.length;a++){var r=e.iceServers[a];!r.hasOwnProperty("urls")&&r.hasOwnProperty("url")?(s.deprecated("RTCIceServer.url","RTCIceServer.urls"),(r=JSON.parse(JSON.stringify(r))).urls=r.url,delete r.url,i.push(r)):i.push(e.iceServers[a])}e.iceServers=i}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},n.shimTrackEventTransceiver=function(e){"object"===(void 0===e?"undefined":i(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var i=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==e.offerToReceiveVideo||i||this.addTransceiver("video")}return t.apply(this,arguments)}},n.shimAudioContext=function(e){if("object"!==(void 0===e?"undefined":i(e))||e.AudioContext)return;e.AudioContext=e.webkitAudioContext};var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"));function a(e){return e&&void 0!==e.video?Object.assign({},e,{video:s.compactObject(e.video)}):e}},{"../utils":116}],116:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.extractVersion=r,n.wrapPeerConnectionEvent=function(e,t,n){if(!e.RTCPeerConnection)return;var i=e.RTCPeerConnection.prototype,s=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return s.apply(this,arguments);var a=function(e){var t=n(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,a),s.apply(this,[e,a])};var a=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return a.apply(this,arguments);if(!this._eventMap[t].has(n))return a.apply(this,arguments);var i=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,a.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})},n.disableLog=function(e){if("boolean"!=typeof e)return new Error("Argument type: "+(void 0===e?"undefined":i(e))+". Please use a boolean.");return s=e,e?"adapter.js logging disabled":"adapter.js logging enabled"},n.disableWarnings=function(e){if("boolean"!=typeof e)return new Error("Argument type: "+(void 0===e?"undefined":i(e))+". Please use a boolean.");return a=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled")},n.log=function(){if("object"===("undefined"==typeof window?"undefined":i(window))){if(s)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},n.deprecated=function(e,t){if(!a)return;console.warn(e+" is deprecated, please use "+t+" instead.")},n.detectBrowser=function(e){var t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;var n=e.navigator;if(n.mozGetUserMedia)t.browser="firefox",t.version=r(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=r(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.mediaDevices&&n.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=r(n.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=r(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t},n.compactObject=function e(t){if(!o(t))return t;return Object.keys(t).reduce((function(n,i){var s=o(t[i]),a=s?e(t[i]):t[i],r=s&&!Object.keys(a).length;return void 0===a||r?n:Object.assign(n,function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}({},i,a))}),{})},n.walkStats=c,n.filterStats=function(e,t,n){var i=n?"outbound-rtp":"inbound-rtp",s=new Map;if(null===t)return s;var a=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)})),a.forEach((function(t){e.forEach((function(n){n.type===i&&n.trackId===t.id&&c(e,n,s)}))})),s};var s=!0,a=!0;function r(e,t,n){var i=e.match(t);return i&&i.length>=n&&parseInt(i[n],10)}function o(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((function(i){i.endsWith("Id")?c(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach((function(t){c(e,e.get(t),n)}))})))}},{}],117:[function(e,t,n){const i=e("./plugins/CoordinateUtils"),s=e("./plugins/KeyboardEvents"),a=e("./plugins/MouseEvents"),r=e("./plugins/PeerConnectionStats"),o=e("./plugins/Gamepad"),c=e("loglevel");c.setDefaultLevel("debug"),t.exports=class{constructor(e,t){this.timeoutCallbacks=[],this.videoBackupStyleBackground="",this.options=t,this.initialized=!1,this.reconnecting=!1,this.keyboardEventsEnabled=!1,this.touchEventsEnabled=!1,this.mouseEventsEnabled=!1,this.gamepadEventsEnabled=!1,this.webRTCWebsocket=null,this.webRTCWebsocketName="gm-webrtc",this.useWebsocketAsDataChannel=!1,this.root=e,this.video=this.getChildByClass(this.root,"gm-video"),this.wrapper=this.getChildByClass(this.root,"gm-wrapper"),this.videoWrapper=this.getChildByClass(this.root,"gm-video-wrapper"),this.stream=null,this.callbacks={},this.peerConnection=null,this.signalingDataChannel=null,this.cameraSender=null,this.microphoneSender=null,this.sdpConstraints={offerToReceiveAudio:!0,offerToReceiveVideo:!0},this.x=0,this.y=0,document.addEventListener("click",e=>{this.hasSomeParentTheClass(e.target,"gm-overlay")||e.target.classList.contains("gm-icon-button")||e.target.classList.contains("gm-dont-close")||this.emit("close-overlays")})}addCustomPlugins(){[{enabled:this.options.touch||this.options.mouse,class:i},{enabled:this.options.keyboard,class:s},{enabled:this.options.mouse,class:a},{enabled:this.options.gamepad,class:o,params:[this.gamepadManager,this.options.i18n]}].forEach(e=>{const t=e.params||[];e.enabled&&new e.class(this,...t)})}dispatchEvent(e,t){window.dispatchEvent(new CustomEvent(e,{detail:t}))}getChildByClass(e,t){for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];if(i.classList&&i.classList.contains(t))return i;const s=this.getChildByClass(i,t);if(s)return s}return null}registerEventCallback(e,t){this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t)}emit(e,t){this.callbacks[e]&&this.callbacks[e].forEach(e=>{e(t)})}hasSomeParentTheClass(e,t){return!(!e.classList||!e.classList.contains(t))||e.parentNode&&this.hasSomeParentTheClass(e.parentNode,t)}isWebsocketOpen(e){return e&&e instanceof WebSocket&&e.readyState===e.OPEN}onWebRTCReady(){this.webRTCConnectionRetryCount=0,this.openWebRTCConnection()}openWebRTCConnection(){this.webRTCWebsocket&&(this.disconnect(),this.reconnecting=!0),this.webRTCWebsocket=new WebSocket(this.options.webRTCUrl,this.webRTCWebsocketName),this.webRTCWebsocket.onopen=this.sendAuthenticationToken.bind(this),this.webRTCWebsocket.onmessage=this.onWebSocketMessage.bind(this),this.webRTCWebsocket.onerror=this.onWebSocketMessage.bind(this),this.webRTCWebsocket.binaryType="arraybuffer",this.webRTCConnectionRetryCount<=13?this.onConnectionClosed():c.error("Unable to establish connection to your instance.")}onConnectionClosed(){this.webRTCWebsocket.onclose=e=>{switch(this.video.style.background=this.videoBackupStyleBackground,this.initialized=!1,c.debug("Error! Maybe your VM is not available yet? ("+e.code+") "+e.reason),e.code){case 1e3:case 1001:case 1005:c.debug("Closing websocket"),this.dispatchEvent("closeConnection",{msg:"Closing connection"});break;case 1002:case 1003:case 1006:case 1007:case 1008:case 1009:case 1010:case 1011:case 1012:case 1013:case 1014:case 1015:{this.dispatchEvent("closeConnectionUnavailable",{msg:"Can't connect to the WebSocket"}),c.debug("Retrying in 3 seconds...");const e=setTimeout(()=>{this.openWebRTCConnection()},3e3);this.timeoutCallbacks.push(e),this.webRTCConnectionRetryCount++;break}case 4242:this.dispatchEvent("closeWrongToken",{msg:"Wrong token, can't establish connection"});break;case 4243:this.dispatchEvent("closeNoLongerValidToken",{msg:"The token provided is no longer valid"});break;case 4244:this.dispatchEvent("closeServerShutdown",{msg:"Server is shutting down..."});break;default:this.dispatchEvent("defaultCloseConnection",{msg:"Default close connection"})}}}sendAuthenticationToken(){const e={type:"token",token:this.options.token};this.isWebsocketOpen(this.webRTCWebsocket)&&this.webRTCWebsocket.send(JSON.stringify(e))}disconnect(){if(this.initialized=!1,void 0!==this.camera&&void 0!==this.camera.getClientVideoStream&&this.removeLocalStream(this.camera.getClientVideoStream()),this.webRTCWebsocket&&(this.webRTCWebsocket.close(),this.webRTCWebsocket=null,this.timeoutCallbacks.forEach(e=>{clearTimeout(e)}),this.timeoutCallbacks=[]),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.signalingDataChannel&&(this.signalingDataChannel.close(),this.signalingDataChannel=null),void 0!==this.fileUpload){const e={type:"close"};this.fileUpload.loaderWorker.postMessage(e)}}sendEvent(e){e=JSON.stringify(e),this.useWebsocketAsDataChannel?this.isWebsocketOpen(this.webRTCWebsocket)&&this.webRTCWebsocket.send(e):this.signalingDataChannel&&"open"===this.signalingDataChannel.readyState?this.signalingDataChannel.send(e):c.warn("cannot send event, signaling data channel closed")}renegotiateWebRTCConnection(){/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&(this.peerConnection.addTransceiver("audio"),this.peerConnection.addTransceiver("video")),this.peerConnection.createOffer(this.setLocalDescription.bind(this),this.onWebRTCConnectionError.bind(this),this.sdpConstraints)}setTransceiverDirection(e){this.peerConnection.getTransceivers().forEach(t=>{t.sender===e&&(t.direction="sendrecv")})}addLocalStream(e){"function"==typeof this.peerConnection.addTrack?(e.getVideoTracks().length>0&&(this.cameraSender?(c.debug("Replacing video track on sender"),this.cameraSender.replaceTrack(e.getVideoTracks()[0]),this.setTransceiverDirection(this.cameraSender,"sendrecv")):this.cameraSender=this.peerConnection.addTrack(e.getVideoTracks()[0],e)),this.options.microphone&&e.getAudioTracks().length>0&&(this.microphoneSender?(c.debug("Replacing audio track on sender"),this.microphoneSender.replaceTrack(e.getAudioTracks()[0]),this.setTransceiverDirection(this.microphoneSender,"sendrecv")):this.microphoneSender=this.peerConnection.addTrack(e.getAudioTracks()[0],e))):this.peerConnection.addStream(e),this.renegotiateWebRTCConnection()}removeLocalStream(e){e instanceof MediaStream&&(e.getTracks().forEach(e=>{e.stop()}),"function"==typeof this.peerConnection.addTrack?(this.peerConnection.removeTrack(this.cameraSender),this.microphoneSender&&this.peerConnection.removeTrack(this.microphoneSender)):this.peerConnection.removeStream(e),this.renegotiateWebRTCConnection())}createPeerConnection(){c.debug("Creating peer connection");const e=[];Array.isArray(this.options.stun)?this.options.stun.forEach(t=>{e.push(t)}):Object.keys(this.options.stun).length>0&&e.push(this.options.stun),Array.isArray(this.options.turn)?this.options.turn.forEach(t=>{e.push(t)}):Object.keys(this.options.turn).length>0&&e.push(this.options.turn);const t={iceServers:e};if(this.peerConnection)c.debug("Peer connection already exists");else try{this.peerConnection=new RTCPeerConnection(t)}catch(e){c.warn("Failed to create PeerConnection, exception:",e.message)}void 0!==this.peerConnection.createDataChannel?this.createDataChannels():this.useWebsocketAsDataChannel=!0,this.peerConnection.onicecandidate=e=>{void 0!==e.candidate&&(e.candidate?this.sendIceCandidate(e.candidate):c.debug("All candidates ready"))},this.peerConnection.ontrack=e=>{if(c.debug("Received track:",e.track.kind),"video"!==e.track.kind)return;c.debug("Added remote video track using ontrack"),this.video.srcObject=e.streams[0],this.video.setAttribute("playsinline",!0),this.stream=e.streams[0],new r(this,this.peerConnection,3e3),this.videoBackupStyleBackground=this.video.style.background,this.video.style.background="transparent",this.touchEventsEnabled&&this.touchEvents.addTouchCallbacks(),this.mouseEventsEnabled&&this.mouseEvents.addMouseCallbacks(),this.keyboardEventsEnabled&&this.keyboardEvents.addKeyboardCallbacks(),this.gamepadEventsEnabled&&this.gamepadManager.addGamepadCallbacks();const t=this.video.play();t&&t.then(()=>{c.debug("Playing video with sound enabled"),this.dispatchEvent("video",{msg:"play automatically allowed with sound"})}).catch(()=>{c.debug("Can't play video with sound enabled"),this.dispatchEvent("video",{msg:"play with sound denied"}),this.video.muted=!0;this.video.play().then(()=>{c.debug("Playing video with sound disabled"),this.dispatchEvent("video",{msg:"play automatically allowed without sound"});const e=document.createElement("div");e.classList.add("gm-click-to-unmute"),e.innerHTML="By default, the sound has been turned off, please click anywhere to re-enable audio",this.videoWrapper.prepend(e);const t=()=>{this.video.muted=!1,this.video.removeEventListener("click",t),this.video.removeEventListener("touchend",t),this.dispatchEvent("video",{msg:"sound manually allowed by click"}),e.remove(),c.debug("Playing video with sound enabled has been authorized due to user click")};this.video.addEventListener("click",t),this.video.addEventListener("touchend",t)}).catch(()=>{c.debug("Can't play video, even with sound disabled"),this.dispatchEvent("video",{msg:"play denied even without sound"});const e=document.createElement("div");this.classList.add("gm-click-to-display"),this.classList.add("gm-video-overlay"),this.videoWrapper.prepend(e);const t=()=>{this.video.play(),e.remove(),this.dispatchEvent("video",{msg:"play manually allowed by click"}),c.debug("Playing video with sound disabled has been authorized due to user click")};e.addEventListener("click",t),e.addEventListener("touchend",t)})})},this.peerConnection.oniceconnectionstatechange=()=>{const e=this.peerConnection?this.peerConnection.iceConnectionState:"No peerConnection";if(c.debug("iceConnectionState: ",e),this.dispatchEvent("iceConnectionState",{msg:e}),"failed"!==e)return;let t='<div class="gm-error-text">Aw, snap!<br/>Connection failed.<p>Check your internet connection & firewall rules.{DOC_AVAILABLE}</p></div>';const n=document.createElement("div");if(n.classList.add("gm-overlay-cant-connect"),n.classList.add("gm-video-overlay"),this.videoWrapper.prepend(n),this.options.connectionFailedURL){t=t.replace("{DOC_AVAILABLE}",'</br>See <a href="">help</a> to setup TURN configuration.');const e=()=>{this.dispatchEvent("iceConnectionStateDocumentation",{msg:"clicked"}),n.remove(),window.open(this.options.connectionFailedURL,"_blank")};n.addEventListener("click",e),n.addEventListener("touchend",e)}else t=t.replace("{DOC_AVAILABLE}","");n.innerHTML=t},this.peerConnection.onconnectionstatechange=()=>{c.debug("ConnectionState changed:",this.peerConnection.iceConnectionState),"disconnected"===this.peerConnection.iceConnectionState&&this.onWebRTCReady()},this.peerConnection.onnegotiationneeded=()=>{c.debug("on Negotiation needed")},this.renegotiateWebRTCConnection()}createDataChannels(){this.signalingDataChannel=this.peerConnection.createDataChannel("events",{ordered:!0}),this.signalingDataChannel.onerror=e=>{c.warn("Data Channel Error:",e)},this.signalingDataChannel.onmessage=e=>{c.debug("Got Data Channel Message:",e.data)},this.signalingDataChannel.onopen=()=>{c.debug("Data Channel opened")},this.signalingDataChannel.onclose=()=>{c.debug("The Data Channel is Closed")},this.peerConnection.ondatachannel=e=>{e.channel.onmessage=this.onDataChannelMessage.bind(this)}}sendIceCandidate(e){this.isWebsocketOpen(this.webRTCWebsocket)&&this.webRTCWebsocket.send(JSON.stringify(e))}setLocalDescription(e){const t=e.sdp.matchAll(/a=rtpmap:(\d+) opus\/48000\/2/g)[0];t&&(e.sdp=e.sdp.replace(new RegExp("a=fmtp:"+t[1],"g"),"a=fmtp:"+t[1]+" stereo=1;maxplaybackrate=48000;maxaveragebitrate=256000")),this.peerConnection.setLocalDescription(e),this.isWebsocketOpen(this.webRTCWebsocket)&&this.webRTCWebsocket.send(JSON.stringify(e))}onWebSocketMessage(e){let t=null;try{t=JSON.parse(e.data)}catch(e){return}if(t)if(t.sdp)try{const e=new RTCSessionDescription(t);this.peerConnection.setRemoteDescription(e,this.onWebRTCConnectionEstablished.bind(this),this.onWebRTCConnectionError.bind(this))}catch(e){c.warn("Failed to create SDP ",e.message)}else if(t.candidate){if("end-of-candidates"===t.candidate)return void c.debug("End of ICE candidates received");try{const e=new RTCIceCandidate(t);this.peerConnection.addIceCandidate(e)}catch(e){c.warn("Failed to create ICE ",e.message)}}else t.connection?this.createPeerConnection():this.handleMessage(t)}onWebRTCConnectionEstablished(){if(c.debug("WebRTC connection success"),!this.initialized&&(this.initialized=!0,this.reconnecting?this.reconnecting=!1:this.dispatchEvent("successConnection",{msg:"Connection established"}),this.fileUpload)){const e={type:"address",fileUploadAddress:this.options.fileUploadUrl,token:this.options.token};this.fileUpload.loaderWorker&&this.fileUpload.loaderWorker.postMessage(e)}}onWebRTCConnectionError(e){c.debug("Failure callback:",e)}onDataChannelMessage(e){const t=JSON.parse(e.data);this.handleMessage(t)}handleMessage(e){if("USERS"===e.type)"SUCCESS"===e.code&&this.dispatchEvent("userListUpdated",{msg:e.message});else if("VERSION"===e.type){if("SUCCESS"===e.code){const t=this.getChildByClass(this.root,"gm-version-number");t&&(t.innerHTML=e.message)}}else"CAPABILITIES"===e.type&&[{widget:this.battery,capability:e.message.battery},{widget:this.camera,capability:e.message.camera},{widget:this.gps,capability:e.message.gps},{widget:this.identifiers,capability:e.message.identifiers},{widget:this.network,capability:e.message.network},{widget:this.network,capability:e.message.mobileThrottling,enable:e=>{e.enableMobileThrottling()},disable:e=>{e.disableMobileThrottling()}},{widget:this.network,capability:e.message.enable5G,enable:e=>{e.enable5G()},disable:e=>{e.disable5G()}},{widget:this.phone,capability:e.message.phone},{widget:this.baseband,capability:e.message.phone},{widget:this.diskIO,capability:e.message.diskIO},{widget:this.buttonsEvents,capability:e.message.accelerometer,enable:e=>{e.enableRotation()},disable:e=>{e.disableRotation()}},{widget:this.fileUpload,capability:e.message.systemPatcher,enable:e=>{e.setAvailability(!0)},disable:e=>{e.setAvailability(!1)}}].forEach(e=>{void 0!==e.widget&&(!0===e.capability?e.enable?e.enable(e.widget):e.widget.enable():e.disable?e.disable(e.widget):e.widget.disable())});"SUCCESS"===e.code&&this.emit(e.type,e.message)}}},{"./plugins/CoordinateUtils":125,"./plugins/Gamepad":129,"./plugins/KeyboardEvents":133,"./plugins/MouseEvents":134,"./plugins/PeerConnectionStats":137,loglevel:99}],118:[function(e,t,n){const i=e("./DeviceRenderer"),s=e("lodash/defaultsDeep"),a=e("./plugins/GPS"),r=e("./plugins/MultiTouchEvents"),o=e("./plugins/ButtonsEvents"),c=e("./plugins/Fullscreen"),l=e("./plugins/Clipboard"),d=e("./plugins/FileUpload"),h=e("./plugins/Camera"),p=e("./plugins/Battery"),u=e("./plugins/StreamBitrate"),m=e("./plugins/Screencast"),g=e("./plugins/Identifiers"),f=e("./plugins/Network"),v=e("./plugins/Phone"),b=e("./plugins/BasebandRIL"),y=e("./plugins/StreamResolution"),C=e("./plugins/IOThrottling"),S=e("./plugins/GamepadManager"),E=e("loglevel");E.setDefaultLevel("debug");const T={template:"renderer",touch:!0,mouse:!0,volume:!0,rotation:!0,navbar:!0,power:!0,keyboard:!0,fullscreen:!0,camera:!0,microphone:!1,fileUpload:!0,streamBitrate:!1,clipboard:!0,battery:!0,gps:!0,gpsSpeedSupport:!1,capture:!0,identifiers:!0,network:!0,mobilethrottling:!1,baseband:!1,phone:!0,streamResolution:!0,diskIO:!0,gamepad:!1,translateHomeKey:!1,token:"",i18n:{},stun:{urls:["stun:stun-eu.genymotion.com:80","stun:stun-eu.genymotion.com:443","stun:stun-eu.genymotion.com:3478","stun:stun-eu.genymotion.com:5349","stun:stun-na.genymotion.com:80","stun:stun-na.genymotion.com:443","stun:stun-na.genymotion.com:3478","stun:stun-na.genymotion.com:5349"]},connectionFailedURL:"",turn:{}};t.exports=class{constructor(){this.instances=[],this.templates={bootstrap:{html:'<div class="gm-wrapper">    <div style="text-align: center" class="gm-video-wrapper embed-responsive embed-responsive-16by9">        <video class="gm-video embed-responsive-item" autoplay preload="none">            Your browser does not support the VIDEO tag        </video>    </div>    <div class="gm-toolbars">        <div class="gm-toolbar">            <ul>            </ul>        </div>    </div></div>',css:".gm_bootstrap .gm-video {    background: transparent;    background-size: contain;    background-position: center;    width: 99%}.gm_bootstrap {    background-color: black;}.gm_bootstrap .gm-toolbars {    position: absolute;    width: 47px;    height: 100%;    top: 0;    right: 0;    margin: 0;}.gm_bootstrap .gm-toolbar {    position: absolute;    top: 5%;    right: 0;    margin: 0;}.gm_bootstrap li img {    margin: auto}@media (min-width: 1200px) {    .gm_bootstrap li img {        width: 85%;    }}"},fullscreen:{html:'<a class="gm-fullscreen-message" href="#"></a><div class="gm-wrapper hide">    <div class="gm-video-wrapper">        <video class="gm-video" autoplay preload="none">            Your browser does not support the VIDEO tag        </video>    </div>    <div class="gm-toolbars">        <div class="gm-toolbar">            <ul>            </ul>        </div>    </div></div><p class="gm-layout-fullwindow" hidden></p>',js:"",css:".gm-fullscreen {    position: absolute;    top: 0;    left: 0;    margin: 0;    padding: 0;    display: block;    width: 100%;    height: 97%;    background-color: black;}.gm-fullscreen .gm-fullscreen-message {    display: block;    padding: 0;    margin: 0;    height: 100%;    width: 100%;    background: white;    background-size: cover;}.gm-video .hide {    display: none;}.gm-fullscreen .gm-video {    background: transparent;    position: absolute;    top: 0;    left: 0;    width: 95%;    height: 100%;    padding: 0;}.gm-toolbars {    position: absolute;    top: 0;    right: 0;}"},fullwindow:{html:'<div class="gm-wrapper">    <div class="gm-video-wrapper">        <video class="gm-video" autoplay preload="none">            Your browser does not support the VIDEO tag        </video>    </div>    <div class="gm-toolbar">        <ul>        </ul>    </div></div><p class="gm-layout-fullwindow" hidden></p>',js:"",css:".gm_fullwindow {    position: absolute;    top: 0;    left: 0;    margin: 0;    padding: 0;    display: block;    width: 100%;    height: 97%;    min-height: 560px;    background-color: black;}.gm_fullwindow .gm-video {    background: transparent;    position: absolute;    top: 0;    left: 0;    width: calc(95% - 50px);    height: 100%;    padding: 0;}.gm_fullwindow .toolbar {    position: absolute;    top: 10px;    right: 0;    padding-right: 10px;    margin: 0;    width: 50px;}"},renderer:{html:'<div class="gm-wrapper">    <div class="device-renderer">        <div class="gm-video-wrapper">            <video class="gm-video" autoplay preload="none">                Your browser does not support the VIDEO tag            </video>        </div>        <div class="gm-toolbars">            <div class="gm-toolbar">                <ul>                </ul>            </div>        </div>    </div></div>',js:"",css:'.gm-template-renderer .device-renderer {    position: relative;    border-collapse: separate;    border-radius: 3px;    padding: 40px 10px 40px 10px;    margin-left: auto;    margin-right: auto;    background-color: black;}.gm-template-renderer .gm-video {    background: transparent url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHdpZHRoPScxMjJweCcgaGVpZ2h0PScxMjJweCcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQiIGNsYXNzPSJ1aWwtcmluZyI+PHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiIGZpbGw9Im5vbmUiIGNsYXNzPSJiayI+PC9yZWN0PjxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIHI9IjQ1IiBzdHJva2UtZGFzaGFycmF5PSIxNTUuNTA4ODM2MzUyNjk0NzcgMTI3LjIzNDUwMjQ3MDM4NjYyIiBzdHJva2U9IiNFNjE5NUUiIGZpbGw9Im5vbmUiIHN0cm9rZS13aWR0aD0iMTAiPjxhbmltYXRlVHJhbnNmb3JtIGF0dHJpYnV0ZU5hbWU9InRyYW5zZm9ybSIgdHlwZT0icm90YXRlIiB2YWx1ZXM9IjAgNTAgNTA7MTgwIDUwIDUwOzM2MCA1MCA1MDsiIGtleVRpbWVzPSIwOzAuNTsxIiBkdXI9IjFzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgYmVnaW49IjBzIj48L2FuaW1hdGVUcmFuc2Zvcm0+PC9jaXJjbGU+PC9zdmc+") no-repeat center;    width: 1024px;    height: 600px;    margin-right: 60px;}.gm-template-renderer .gm-toolbars {    position: absolute;    top: 0;    right: 0;    width: 60px;}'},renderer_minimal:{html:'<div class="gm-wrapper">    <div class="gm-video-wrapper">        <video class="gm-video" autoplay preload="none">            Your browser does not support the VIDEO tag        </video>    </div>    <div class="gm-toolbar">        <ul>        </ul>    </div>    <span class="gm-version-number"></span></div>',js:"",css:'.gm-template-renderer_minimal {    position: absolute;    top: 0;    left: 0;    margin: 0;    padding: 0;    display: block;    width: 100%;    height: 100%;    min-height: 560px;    background-color: black;}.gm-template-renderer_minimal .gm-video {    position: fixed;    top: 0;    left: 0;    width: calc(100vw - 57px);    height: 100vh;    padding: 0;    margin: 0;    background: transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NCA2NCIgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSJ3aGl0ZSI+CiAgPGNpcmNsZSB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNiAxNikiIGN4PSIwIiBjeT0iMTYiIHI9IjAiPiAKICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InIiIHZhbHVlcz0iMDsgNDsgMDsgMCIgZHVyPSIxLjJzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgYmVnaW49IjAiCiAgICAgIGtleXRpbWVzPSIwOzAuMjswLjc7MSIga2V5U3BsaW5lcz0iMC4yIDAuMiAwLjQgMC44OzAuMiAwLjYgMC40IDAuODswLjIgMC42IDAuNCAwLjgiIGNhbGNNb2RlPSJzcGxpbmUiIC8+CiAgPC9jaXJjbGU+CiAgPGNpcmNsZSB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMiAxNikiIGN4PSIwIiBjeT0iMTYiIHI9IjAiPiAKICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InIiIHZhbHVlcz0iMDsgNDsgMDsgMCIgZHVyPSIxLjJzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgYmVnaW49IjAuMyIKICAgICAga2V5dGltZXM9IjA7MC4yOzAuNzsxIiBrZXlTcGxpbmVzPSIwLjIgMC4yIDAuNCAwLjg7MC4yIDAuNiAwLjQgMC44OzAuMiAwLjYgMC40IDAuOCIgY2FsY01vZGU9InNwbGluZSIgLz4KICA8L2NpcmNsZT4KICA8Y2lyY2xlIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ4IDE2KSIgY3g9IjAiIGN5PSIxNiIgcj0iMCI+IAogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgdmFsdWVzPSIwOyA0OyAwOyAwIiBkdXI9IjEuMnMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBiZWdpbj0iMC42IgogICAgICBrZXl0aW1lcz0iMDswLjI7MC43OzEiIGtleVNwbGluZXM9IjAuMiAwLjIgMC40IDAuODswLjIgMC42IDAuNCAwLjg7MC4yIDAuNiAwLjQgMC44IiBjYWxjTW9kZT0ic3BsaW5lIiAvPgogIDwvY2lyY2xlPgo8L3N2Zz4K") center no-repeat;    background-size: 40%;}.gm-template-renderer_minimal .gm-toolbar {    position: absolute;    top: 10px;    right: 0;    padding-right: 5px;    margin: 0;    width: 50px;}.gm-template-renderer_minimal .gm-version-number {    position: fixed;    right: 5px;    bottom: 5px;    z-index: 2;    color: white;}'},renderer_no_toolbar:{html:'<div class="gm-wrapper">    <div class="gm-video-wrapper">        <video class="gm-video" autoplay poster="src/assets/images/loader.svg" disablePictureInPicture>            Your browser does not support the VIDEO tag        </video>    </div></div>',js:"",css:'.gm-template-renderer_no_toolbar {    position: absolute;    top: 0;    left: 0;    margin: 0;    padding: 0;    display: block;    width: 100%;    height: 100%;    min-height: 560px;    background-color: black;}.gm-template-renderer_no_toolbar .gm-video {    position: fixed;    top: 0;    left: 0;    width: 100%;    height: 100%;    padding: 0;    background: transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NCA2NCIgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSJ3aGl0ZSI+CiAgPGNpcmNsZSB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNiAxNikiIGN4PSIwIiBjeT0iMTYiIHI9IjAiPiAKICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InIiIHZhbHVlcz0iMDsgNDsgMDsgMCIgZHVyPSIxLjJzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgYmVnaW49IjAiCiAgICAgIGtleXRpbWVzPSIwOzAuMjswLjc7MSIga2V5U3BsaW5lcz0iMC4yIDAuMiAwLjQgMC44OzAuMiAwLjYgMC40IDAuODswLjIgMC42IDAuNCAwLjgiIGNhbGNNb2RlPSJzcGxpbmUiIC8+CiAgPC9jaXJjbGU+CiAgPGNpcmNsZSB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMiAxNikiIGN4PSIwIiBjeT0iMTYiIHI9IjAiPiAKICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InIiIHZhbHVlcz0iMDsgNDsgMDsgMCIgZHVyPSIxLjJzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgYmVnaW49IjAuMyIKICAgICAga2V5dGltZXM9IjA7MC4yOzAuNzsxIiBrZXlTcGxpbmVzPSIwLjIgMC4yIDAuNCAwLjg7MC4yIDAuNiAwLjQgMC44OzAuMiAwLjYgMC40IDAuOCIgY2FsY01vZGU9InNwbGluZSIgLz4KICA8L2NpcmNsZT4KICA8Y2lyY2xlIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ4IDE2KSIgY3g9IjAiIGN5PSIxNiIgcj0iMCI+IAogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgdmFsdWVzPSIwOyA0OyAwOyAwIiBkdXI9IjEuMnMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBiZWdpbj0iMC42IgogICAgICBrZXl0aW1lcz0iMDswLjI7MC43OzEiIGtleVNwbGluZXM9IjAuMiAwLjIgMC40IDAuODswLjIgMC42IDAuNCAwLjg7MC4yIDAuNiAwLjQgMC44IiBjYWxjTW9kZT0ic3BsaW5lIiAvPgogIDwvY2lyY2xlPgo8L3N2Zz4K") center no-repeat;    background-size: 40%;}'},renderer_partial:{html:'<div class="gm-wrapper">    <div class="gm-video-wrapper">        <video class="gm-video" autoplay preload="none">            Your browser does not support the VIDEO tag        </video>    </div>    <div class="gm-toolbar">        <ul>        </ul>    </div>    <span class="gm-version-number"></span></div>',js:"",css:'.gm-template-renderer_partial {    top: 0;    left: 0;    margin: 0;    padding: 0;    display: block;    min-height: 800px;    height: 100%;    background-color: black;}.gm-template-renderer_partial .gm-wrapper {    top: 0;    left: 0;    margin: 0;    padding: 0;    display: block;    width: 100%;    height: 100%;}.gm-template-renderer_partial .gm-video-wrapper {    position: relative;    top: 0;    left: 0;    margin: 0;    padding: 0;    display: block;    width: 100%;    height: 100%;}.gm-template-renderer_partial .gm-video {    position: relative;    top: 0;    left: 0;    width: calc(95% - 50px);    height: 100%;    padding: 0;    background: transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NCA2NCIgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSJ3aGl0ZSI+CiAgPGNpcmNsZSB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNiAxNikiIGN4PSIwIiBjeT0iMTYiIHI9IjAiPiAKICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InIiIHZhbHVlcz0iMDsgNDsgMDsgMCIgZHVyPSIxLjJzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgYmVnaW49IjAiCiAgICAgIGtleXRpbWVzPSIwOzAuMjswLjc7MSIga2V5U3BsaW5lcz0iMC4yIDAuMiAwLjQgMC44OzAuMiAwLjYgMC40IDAuODswLjIgMC42IDAuNCAwLjgiIGNhbGNNb2RlPSJzcGxpbmUiIC8+CiAgPC9jaXJjbGU+CiAgPGNpcmNsZSB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMiAxNikiIGN4PSIwIiBjeT0iMTYiIHI9IjAiPiAKICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InIiIHZhbHVlcz0iMDsgNDsgMDsgMCIgZHVyPSIxLjJzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgYmVnaW49IjAuMyIKICAgICAga2V5dGltZXM9IjA7MC4yOzAuNzsxIiBrZXlTcGxpbmVzPSIwLjIgMC4yIDAuNCAwLjg7MC4yIDAuNiAwLjQgMC44OzAuMiAwLjYgMC40IDAuOCIgY2FsY01vZGU9InNwbGluZSIgLz4KICA8L2NpcmNsZT4KICA8Y2lyY2xlIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ4IDE2KSIgY3g9IjAiIGN5PSIxNiIgcj0iMCI+IAogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgdmFsdWVzPSIwOyA0OyAwOyAwIiBkdXI9IjEuMnMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBiZWdpbj0iMC42IgogICAgICBrZXl0aW1lcz0iMDswLjI7MC43OzEiIGtleVNwbGluZXM9IjAuMiAwLjIgMC40IDAuODswLjIgMC42IDAuNCAwLjg7MC4yIDAuNiAwLjQgMC44IiBjYWxjTW9kZT0ic3BsaW5lIiAvPgogIDwvY2lyY2xlPgo8L3N2Zz4K") center no-repeat;    background-size: 40%;}.gm-template-renderer_partial .gm-toolbar {    position: absolute;    top: 10px;    right: 0;    padding-right: 5px;    margin: 0;    width: 50px;}.gm-template-renderer_partial .gm-version-number {    position: fixed;    right: 5px;    bottom: 5px;    z-index: 2;    color: white;}@media only screen and (max-width: 650px)  {    .gm-overlay {        left: auto;        width: calc(100vw - 100px);        right: 55px;        min-height: 0;    }}@media only screen and (min-width: 475px)  {    .gm-click-to-unmute {        left: calc(50% - 190px) !important;    }}'}}}setupRenderer(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i;"string"==typeof e&&(e=document.getElementById(e)),void 0===n&&(n={}),(n=s(n,T)).webRTCUrl=t,n.buttons=n.volume||n.rotation||n.navbar||n.power,E.debug("Creating genymotion display on "+t),e.classList.add("device-renderer-instance"),e.classList.add("gm-template-"+n.template),document.body.classList.add("gm-template-"+n.template+"-body"),this.loadTemplate(e,this.templates[n.template],n);const r=new a(e,n);return this.instances.push(r),this.addPlugins(r,r.options),r.onWebRTCReady(),r}loadTemplate(e,t,n){const i=document.getElementsByTagName("head")[0],s="device-renderer-js-"+n.template,a="device-renderer-css-"+n.template;if(!document.getElementById(s)){const e=document.createElement("script");e.id=s,e.text=t.js,i.appendChild(e)}if(!document.getElementById(a)){const e=document.createElement("style");e.id=a,e.appendChild(document.createTextNode(t.css)),i.appendChild(e)}e.innerHTML=t.html}addPlugins(e,t){[{enabled:t.touch,class:r},{enabled:t.fullscreen,class:c},{enabled:t.clipboard,class:l,params:[t.i18n]},{enabled:t.fileUpload,class:d,params:[t.i18n]},{enabled:t.camera,class:h,params:[t.i18n]},{enabled:t.battery,class:p,params:[t.i18n]},{enabled:t.streamBitrate,class:u,params:[t.i18n]},{enabled:t.gps,class:a,params:[t.i18n,t.gpsSpeedSupport]},{enabled:t.capture,class:m,params:[t.i18n]},{enabled:t.identifiers,class:g,params:[t.i18n]},{enabled:t.network,class:f,params:[t.i18n]},{enabled:t.phone,class:v,params:[t.i18n]},{enabled:t.baseband,class:b,params:[t.i18n,t.baseband]},{enabled:t.streamResolution,class:y},{enabled:t.diskIO,class:C,params:[t.i18n]},{enabled:t.gamepad,class:S},{enabled:t.buttons,class:o,params:[t.i18n,t.translateHomeKey]}].forEach(t=>{const n=t.params||[];t.enabled&&new t.class(e,...n)}),"function"==typeof e.addCustomPlugins&&e.addCustomPlugins()}}},{"./DeviceRenderer":117,"./plugins/BasebandRIL":120,"./plugins/Battery":121,"./plugins/ButtonsEvents":122,"./plugins/Camera":123,"./plugins/Clipboard":124,"./plugins/FileUpload":126,"./plugins/Fullscreen":127,"./plugins/GPS":128,"./plugins/GamepadManager":130,"./plugins/IOThrottling":131,"./plugins/Identifiers":132,"./plugins/MultiTouchEvents":135,"./plugins/Network":136,"./plugins/Phone":138,"./plugins/Screencast":139,"./plugins/StreamBitrate":140,"./plugins/StreamResolution":141,"lodash/defaultsDeep":81,loglevel:99}],119:[function(e,t,n){const i=e("./DeviceRenderer"),s=e("./DeviceRendererFactory"),a=e("./plugins/CoordinateUtils"),r=e("./plugins/KeyboardEvents"),o=e("./plugins/MouseEvents");t.exports={DeviceRenderer:i,DeviceRendererFactory:s,CoordinateUtils:a,KeyboardEvents:r,MouseEvents:o}},{"./DeviceRenderer":117,"./DeviceRendererFactory":118,"./plugins/CoordinateUtils":125,"./plugins/KeyboardEvents":133,"./plugins/MouseEvents":134}],120:[function(e,t,n){const i=e("./util/OverlayPlugin");t.exports=class extends i{constructor(e,t,n){super(e),this.instance=e,this.instance.baseband=this,this.i18n=t||{},this.basebandEnabled=n,this.renderToolbarButton(),this.renderWidget(),this.instance.registerEventCallback("baseband",e=>{this.handleBasebandEvent(e)})}handleBasebandEvent(e){const t=e.split(" ");t.length<3||("network"===t[0]&&"operator"===t[1]&&(this.networkOperatorMMC.value=t[2]),"network"===t[0]&&"operator_name"===t[1]&&(this.networkOperatorName.value=t.slice(2).join(" ")),"sim"===t[0]&&"operator"===t[1]&&(this.simOperatorMMC.value=t[2]),"sim"===t[0]&&"operator_name"===t[1]&&(this.simOperatorName.value=t.slice(2).join(" ")),"sim"===t[0]&&"imsi_id"===t[1]&&(this.simMSIN.value=t[2]),"sim"===t[0]&&"phone_number"===t[1]&&(this.simOperatorPhoneNumber.value=t[2]))}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-sim-button",this.toolbarBtnImage.title=this.i18n.BASEBAND_TITLE||"Baseband",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.form=document.createElement("form");const e=document.createElement("div");if(e.className="gm-title",e.innerHTML=this.i18n.BASEBAND_TITLE||"Baseband",this.form.appendChild(e),this.basebandEnabled){this.networkOperator=document.createElement("div");const e=document.createElement("div");e.className="gm-section";const t=document.createElement("label");t.innerHTML=this.i18n.NETWORK_OPERATOR||"Network Operator",e.appendChild(t);const n=document.createElement("div");n.className="gm-fields";const i=document.createElement("label");i.innerHTML="MCC/MNC",this.networkOperatorMMC=document.createElement("input"),this.networkOperatorMMC.className="gm-network-network-mmc",this.networkOperatorMMC.placeholder="eg: 20814",this.networkOperatorMMC.pattern="[0-9]{5,6}",this.networkOperatorMMC.title="Operator MCC/MNC",n.appendChild(i),n.appendChild(this.networkOperatorMMC);const s=document.createElement("div");s.className="gm-fields";const a=document.createElement("label");a.innerHTML="Name",this.networkOperatorName=document.createElement("input"),this.networkOperatorName.className="gm-network-network-name",this.networkOperatorName.placeholder="eg: Verizon",this.networkOperatorName.title="Operator Name",s.appendChild(a),s.appendChild(this.networkOperatorName),this.networkOperator.appendChild(e),this.networkOperator.appendChild(n),this.networkOperator.appendChild(s),this.simOperator=document.createElement("div");const r=document.createElement("div");r.className="gm-section";const o=document.createElement("label");o.innerHTML=this.i18n.NETWORK_SIM_OPERATOR||"SIM Operator",r.appendChild(o);const c=document.createElement("div");c.className="gm-fields";const l=document.createElement("label");l.innerHTML="MCC/MNC",this.simOperatorMMC=document.createElement("input"),this.simOperatorMMC.className="gm-network-sim-mmc",this.simOperatorMMC.placeholder="eg: 20814",this.simOperatorMMC.pattern="[0-9]{5,6}",this.simOperatorMMC.title="SIM Operator MCC/MNC",this.simOperatorMMC.addEventListener("keyup",this.checkSimImsiErrors.bind(this)),c.appendChild(l),c.appendChild(this.simOperatorMMC);const d=document.createElement("div");d.className="gm-fields";const h=document.createElement("label");h.innerHTML="Name",this.simOperatorName=document.createElement("input"),this.simOperatorName.className="gm-network-sim-name",this.simOperatorName.placeholder="eg: AT&T",this.simOperatorName.title="SIM Operator Name",d.appendChild(h),d.appendChild(this.simOperatorName);const p=document.createElement("div");p.className="gm-fields";const u=document.createElement("label");u.innerHTML="MSIN",this.simMSIN=document.createElement("input"),this.simMSIN.className="gm-network-sim-msin",this.simMSIN.placeholder="eg: 2176510739",this.simMSIN.pattern="[0-9]{9,10}",this.simMSIN.title="SIM MSIN",this.simMSIN.addEventListener("keyup",this.checkSimImsiErrors.bind(this)),p.appendChild(u),p.appendChild(this.simMSIN);const m=document.createElement("div");m.className="gm-fields";const g=document.createElement("label");g.innerHTML="Phone Number",this.simOperatorPhoneNumber=document.createElement("input"),this.simOperatorPhoneNumber.className="gm-network-sim-phone",this.simOperatorPhoneNumber.placeholder="eg: 8004337300",this.simOperatorPhoneNumber.pattern="[0-9]*",this.simOperatorPhoneNumber.title="Phone Number",m.appendChild(g),m.appendChild(this.simOperatorPhoneNumber),this.simOperator.appendChild(r),this.simOperator.appendChild(c),this.simOperator.appendChild(p),this.simOperator.appendChild(d),this.simOperator.appendChild(m)}this.submitBtn=document.createElement("button"),this.submitBtn.className="gm-network-update",this.submitBtn.innerHTML=this.i18n.NETWORK_UPDATE||"Update",this.submitBtn.onclick=this.sendDataToInstance.bind(this),this.basebandEnabled&&(this.form.appendChild(this.networkOperator),this.form.appendChild(this.simOperator)),this.form.appendChild(this.submitBtn),this.widget.className="gm-overlay gm-baseband-plugin gm-hidden";const t=document.createElement("div");t.className="gm-close-btn",t.onclick=this.toggleWidget.bind(this),this.widget.appendChild(t),this.widget.appendChild(this.form),this.overlays.push(this.widget),this.instance.root.appendChild(this.widget)}toggleWidget(){this.widget.classList.contains("gm-hidden")?(this.instance.emit("close-overlays"),this.instance.emit("keyboard-disable")):this.instance.emit("keyboard-enable"),this.widget.classList.toggle("gm-hidden"),this.toolbarBtnImage.classList.toggle("gm-active")}checkSimImsiErrors(){this.simMSIN.setCustomValidity(""),this.simOperatorMMC.value.length>0&&this.simMSIN.value.length>0&&(6===this.simOperatorMMC.value.length&&9!==this.simMSIN.value.length?this.simMSIN.setCustomValidity("Should be 9"):5===this.simOperatorMMC.value.length&&10!==this.simMSIN.value.length&&this.simMSIN.setCustomValidity("Should be 10"))}sendDataToInstance(e){if(e.preventDefault(),!this.form.checkValidity())return;const t=[];if(this.basebandEnabled&&(this.networkOperatorMMC.value&&t.push("network operator "+this.networkOperatorMMC.value),this.networkOperatorName.value&&t.push("network operator_name "+this.networkOperatorName.value),this.simOperatorMMC.value&&t.push("sim operator "+this.simOperatorMMC.value),this.simOperatorName.value&&t.push("sim operator_name "+this.simOperatorName.value),this.simMSIN.value&&t.push("sim imsi_id "+this.simMSIN.value),this.simOperatorPhoneNumber.value&&t.push("sim phone_number "+this.simOperatorPhoneNumber.value),t.length>0)){const e={channel:"baseband",messages:t};this.instance.sendEvent(e)}this.toggleWidget()}}},{"./util/OverlayPlugin":142}],121:[function(e,t,n){const i=e("./util/OverlayPlugin");t.exports=class extends i{constructor(e,t){super(e),this.instance=e,this.i18n=t||{},this.instance.battery=this,this.instance.registerEventCallback("BATTERY_STATUS",e=>{this.updateUIBatteryChargingState("false"!==e)}),this.renderToolbarButton(),this.renderWidget(),this.instance.registerEventCallback("BATTERY_LEVEL",this.onBatteryLevelChange.bind(this)),this.instance.registerEventCallback("battery",e=>{const t=e.split(" ").splice(-2);2===t.length&&(this.updateUIBatteryChargingState("discharging"!==t[0]),this.onBatteryLevelChange(t[1]))})}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-battery-button",this.toolbarBtnImage.title=this.i18n.BATTERY_TITLE||"Battery",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.container=document.createElement("div");const e=document.createElement("div");e.className="gm-title",e.innerHTML=this.i18n.BATTERY_TITLE||"Battery",this.container.appendChild(e);const t=document.createElement("div");t.className="gm-inputs";const n=this.i18n.BATTERY_CHARGE_LEVEL||"Charge level";t.innerHTML="<label>"+n+"</label>",t.appendChild(this.createLevelSection());const i=document.createElement("label");i.innerHTML=this.i18n.BATTERY_CHARGE_STATE||"State of charge",t.appendChild(i),t.appendChild(this.createChargingSection()),this.container.appendChild(t),this.widget.className="gm-overlay gm-battery-plugin gm-hidden";const s=document.createElement("div");s.onclick=this.toggleWidget.bind(this),s.className="gm-close-btn",this.widget.appendChild(s),this.widget.appendChild(this.container),this.overlays.push(this.widget),this.instance.root.appendChild(this.widget)}createChargingSection(){const e=document.createElement("div");return this.chargingInput=document.createElement("input"),this.chargingStatus=document.createElement("div"),e.className="gm-charging-group",this.chargingInput.type="checkbox",this.chargingInput.className="gm-charging-checkbox",this.chargingInput.onchange=this.toggleChargingState.bind(this),this.chargingInput.checked=!0,this.chargingStatus.className="gm-charging-status",this.chargingStatus.innerHTML="Discharging",e.appendChild(this.chargingInput),e.appendChild(this.chargingStatus),e}createLevelSection(){const e=document.createElement("div");e.className="gm-charge-level-group";const t=document.createElement("div");this.chargeInput=document.createElement("input");const n=document.createElement("span");n.innerHTML="%",this.chargeInput.className="gm-charge-input",this.chargeInput.type="number",this.chargeInput.value=50,this.chargeInput.max=100,this.chargeInput.min=0,this.chargeInput.step=1,this.chargeInput.oninput=this.onBatteryLevelChangeEvent.bind(this),t.appendChild(this.chargeInput),t.appendChild(n),e.appendChild(t);const i=document.createElement("div");this.chargeSlider=document.createElement("input"),this.chargeSlider.className="gm-charge-slider",this.chargeSlider.type="range",this.chargeSlider.orient="vertical",this.chargeSlider.max=100,this.chargeSlider.min=0,this.chargeSlider.step=1,this.chargeSlider.value=50,this.chargeSlider.onchange=this.onBatteryLevelChangeEvent.bind(this),i.appendChild(this.chargeSlider),e.appendChild(i);const s=document.createElement("div");return this.chargeImage=document.createElement("div"),this.chargeImageOverlay=document.createElement("div"),this.chargeImage.className="gm-charge-image",this.chargeImageOverlay.className="gm-charge-image-overlay",this.chargeImageOverlay.style.cssText="height: 40%;",s.appendChild(this.chargeImage),this.chargeImage.appendChild(this.chargeImageOverlay),e.appendChild(s),e}toggleWidget(){this.widget.classList.contains("gm-hidden")?(this.instance.emit("close-overlays"),this.instance.emit("keyboard-disable")):this.instance.emit("keyboard-enable"),this.widget.classList.toggle("gm-hidden"),this.toolbarBtnImage.classList.toggle("gm-active")}toggleChargingState(){this.chargingStatus.classList.toggle("charging");const e=this.i18n.BATTERY_CHARGING||"Charging",t=this.i18n.BATTERY_DISCHARGING||"Discharging";this.chargingStatus.innerHTML=this.chargingInput.checked?e:t,this.sendDataToInstance()}updateUIBatteryChargingState(e){this.chargingInput.checked=e,this.chargingStatus.classList[e?"add":"remove"]("charging");const t=this.i18n.BATTERY_CHARGING||"Charging",n=this.i18n.BATTERY_DISCHARGING||"Discharging";this.chargingStatus.innerHTML=e?t:n}onBatteryLevelChangeEvent(e){const t=Number(e.target.value);this.onBatteryLevelChange(t)&&this.sendDataToInstance()}onBatteryLevelChange(e){return e=Number(e),!Number.isNaN(e)&&(e=Math.min(Math.max(0,e),100),this.chargeSlider.value=e,this.chargeInput.value=e,this.chargeImageOverlay.style.cssText="height: "+(.7*e+4)+"%;",!0)}sendDataToInstance(){const e={channel:"battery",messages:["set state level "+Number(this.chargeInput.value),"set state status "+(this.chargingInput.checked?"charging":"discharging")]};this.instance.sendEvent(e)}}},{"./util/OverlayPlugin":142}],122:[function(e,t,n){t.exports=class{constructor(e,t,n){this.instance=e,this.translateHomeKey=n,this.instance.buttonsEvents=this,this.instance.options.rotation&&this.renderToolbarButton("gm-rotation","gm-rotate",t.BUTTONS_ROTATE||"Rotate",!1),this.instance.options.volume&&(this.renderToolbarButton("0x01000070","gm-sound-down",t.BUTTONS_SOUND_DOWN||"Sound down",!1),this.renderToolbarButton("0x01000072","gm-sound-up",t.BUTTONS_SOUND_UP||"Sound up",!1)),this.instance.options.navbar&&(this.renderToolbarButton("0x010000be","gm-recent",t.BUTTONS_RECENT_APPS||"Recent applications",!0),this.renderToolbarButton("0x01000010","gm-home",t.BUTTONS_HOME||"Home",!0),this.renderToolbarButton("0x01000061","gm-back",t.BUTTONS_BACK||"Back",!0)),this.instance.options.power&&this.renderToolbarButton("0x0100010b","gm-power",t.BUTTONS_POWER||"Power",!0);const i=document.getElementsByClassName("gm-icon-button");for(let e=0;e<i.length;e++){const t=i[e];t.onmousedown=this.mouseButtonPressEvent.bind(this),t.onmouseup=this.mouseButtonReleaseEvent.bind(this)}}keyPressEvent(e,t){const n={type:"KEYBOARD_PRESS",keychar:t,keycode:e};this.instance.sendEvent(n)}keyReleaseEvent(e,t){const n={type:"KEYBOARD_RELEASE",keychar:t,keycode:e};this.instance.sendEvent(n)}mouseButtonPressEvent(e){const t=e.target.classList[1];if(t)if("0x01000010"===t&&this.translateHomeKey)this.keyPressEvent(parseInt("0x01000022"),""),this.keyPressEvent(parseInt("0x01000005"),"");else if("0x"===t.substring(0,2)){const e=parseInt(t,16);this.keyPressEvent(e,"0\n")}}mouseButtonReleaseEvent(e){const t=e.target.classList[1];if(t)if("0x01000010"===t&&this.translateHomeKey)this.keyReleaseEvent(parseInt("0x01000005"),""),this.keyReleaseEvent(parseInt("0x01000022"),"");else if("gm-rotation"===t){const e={type:"ROTATE"};this.instance.sendEvent(e)}else if("0x"===t.substring(0,2)){const e=parseInt(t,16);this.keyReleaseEvent(e,"0\n")}}getButtonState(e){const t=this.instance.getChildByClass(this.instance.root,e),n=t.parentNode;return{image:{className:t.className},button:{className:n.className,onclick:n.onclick}}}setButtonState(e,t){const n=this.instance.getChildByClass(this.instance.root,e),i=n.parentNode;n.className=t.image.className,i.className=t.button.className,i.onclick=t.button.onclick}disableRotation(){if(!this.instance.getChildByClass(this.instance.root,"gm-rotate"))return;this.savedRotationState||(this.savedRotationState=this.getButtonState("gm-rotate"));const e=this.instance.getChildByClass(this.instance.root,"gm-rotate"),t=e.parentNode;t.className+=" gm-disabled-widget-pop-up",e.className+=" gm-disabled-widget-icon",t.onclick=null}enableRotation(){this.instance.getChildByClass(this.instance.root,"gm-rotate")&&this.savedRotationState&&(this.setButtonState("gm-rotate",this.savedRotationState),this.savedRotationState=null)}renderToolbarButton(e,t,n,i){const s=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!s)return;const a=s.children[0],r=document.createElement("li"),o=document.createElement("div");o.classList.add("gm-icon-button"),o.classList.add(e),o.classList.add(t),o.title=n,r.appendChild(o),i?a.appendChild(r):a.insertBefore(r,a.firstChild)}}},{}],123:[function(e,t,n){const i=e("webrtc-adapter"),s=e("./util/OverlayPlugin"),a=e("loglevel");a.setDefaultLevel("debug"),t.exports=class extends s{constructor(e,t){super(e),this.instance=e,this.i18n=t||{},this.instance.camera=this,this.streaming=!1,this.renderToolbarButton()}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.instance.options.microphone?(this.toolbarBtnImage.className="gm-icon-button gm-camera-mic-button",this.toolbarBtnImage.title=this.i18n.CAMERA_TITLE||"Camera and microphone injection"):(this.toolbarBtnImage.className="gm-icon-button gm-camera-button",this.toolbarBtnImage.title=this.i18n.CAMERA_TITLE||"Camera injection"),this.toolbarBtn.appendChild(this.toolbarBtnImage),t.appendChild(this.toolbarBtn),"safari"===i.default.browserDetails.browser?(this.toolbarBtn.className+=" gm-disabled-widget-pop-up",this.toolbarBtnImage.className+=" gm-disabled-widget-icon"):this.toolbarBtn.onclick=this.toggleStreaming.bind(this)}toggleStreaming(){this.streaming?this.stopStreaming():this.startStreaming()}startStreaming(){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia({audio:this.instance.options.microphone,video:{width:1280,height:720}}).catch(e=>{this.onVideoStreamError(e)}).then(e=>{a.debug("Client video stream ready"),this.streaming=!0,this.localStream=e,this.instance.addLocalStream(e)})}onVideoStreamError(e){a.warn("Can't start client video stream",e)}stopStreaming(){a.debug("removed local stream"),this.instance.removeLocalStream(this.localStream),this.localStream=null,this.streaming=!1}getClientVideoStream(){return this.localStream}}},{"./util/OverlayPlugin":142,loglevel:99,"webrtc-adapter":102}],124:[function(e,t,n){const i=e("./util/OverlayPlugin"),s=e("loglevel");s.setDefaultLevel("debug"),t.exports=class extends i{constructor(e,t){super(e),this.instance=e,this.i18n=t||{},this.instance.clipboard=this,this.clipboard="",this.renderToolbarButton(),this.renderWidget(),this.instance.registerEventCallback("framework",e=>{const t=e.split(" ");if(3===t.length&&"clipboard"===t[0])try{this.clipboard=decodeURIComponent(escape(window.atob(t[2])))}catch(e){s.warn("Malformed clipboard content")}}),this.instance.registerEventCallback("CLIPBOARD",e=>{this.clipboard=e})}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-clipboard-button",this.toolbarBtnImage.title=this.i18n.CLIPBOARD_TITLE||"Clipboard",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.container=document.createElement("div");const e=document.createElement("div");e.className="gm-title",e.innerHTML=this.i18n.CLIPBOARD_TITLE||"Device Clipboard",this.container.appendChild(e),this.clipboardInput=document.createElement("textarea"),this.clipboardInput.className="gm-clipboard-input",this.container.appendChild(this.clipboardInput),this.widget.className="gm-overlay gm-clipboard-plugin gm-hidden";const t=document.createElement("div");t.className="gm-close-btn",t.onclick=this.toggleWidget.bind(this),this.widget.appendChild(t),this.widget.appendChild(this.container),this.widget.onclose=()=>{this.clipboard=this.clipboardInput.value,this.sendDataToInstance()},this.overlays.push(this.widget),this.instance.root.appendChild(this.widget)}toggleWidget(){this.widget.classList.contains("gm-hidden")?(this.instance.emit("close-overlays"),this.instance.emit("keyboard-disable"),this.clipboardInput.value=this.clipboard):(this.instance.emit("keyboard-enable"),this.widget.onclose()),this.widget.classList.toggle("gm-hidden"),this.toolbarBtnImage.classList.toggle("gm-active")}copyInstanceClipboardToClient(e,t){try{navigator.clipboard.writeText(this.clipboardInput.value)}catch(t){e.focus(),e.select(),document.execCommand("copy")}t.classList.remove("gm-invisible"),t.classList.remove("gm-hidden"),setTimeout(()=>{t.classList.add("gm-invisible"),setTimeout(()=>{t.classList.add("gm-hidden")},500)},2e3)}sendDataToInstance(){const e={channel:"framework",messages:["set_device_clipboard "+window.btoa(unescape(encodeURIComponent(this.clipboard)))]};this.instance.sendEvent(e)}}},{"./util/OverlayPlugin":142,loglevel:99}],125:[function(e,t,n){t.exports=class{constructor(e){this.instance=e,this.instance.coordinateUtils=this,this.video=this.instance.video}setVideoElement(){this.video=this.instance.video}hasLeftAndRightBorders(){return this.video.offsetWidth/this.video.offsetHeight>this.video.videoWidth/this.video.videoHeight}hasSameOrientation(){return this.video.videoWidth/this.video.videoHeight>1&&this.video.offsetWidth/this.video.offsetHeight>1||this.video.videoWidth/this.video.videoHeight<1&&this.video.offsetWidth/this.video.offsetHeight<1}getCumulativeOffset(e){let t=0,n=0;do{t+=e.offsetTop||0,n+=e.offsetLeft||0,e=e.offsetParent}while(e);return{top:t,left:n}}getRawXCoordinateFromEvent(e){return void 0!==e.pageX?void 0!==e.offsetX?e.offsetX:e.pageX-this.getCumulativeOffset(this.video).left:e.clientX-this.getCumulativeOffset(this.video).left}getRawYCoordinateFromEvent(e){return void 0!==e.pageY?void 0!==e.offsetY?e.offsetY:e.pageY-this.getCumulativeOffset(this.video).top:e.clientY-this.getCumulativeOffset(this.video).top}getXCoordinate(e){this.instance.root.focus(),this.setVideoElement();const t=this.getRawXCoordinateFromEvent(e)-this.getLeftBorder();return Math.round(t*this.getXRatio())}getYCoordinate(e){this.setVideoElement();const t=this.getRawYCoordinateFromEvent(e)-this.getTopBorder();return Math.round(t*this.getYRatio())}getXRatio(){let e;if(this.hasSameOrientation())return this.hasLeftAndRightBorders()?(e=this.video.videoWidth/this.video.videoHeight*this.video.offsetHeight,this.video.videoWidth/e):this.video.videoWidth/this.video.offsetWidth;if(this.hasLeftAndRightBorders())return e=this.video.videoWidth/this.video.videoHeight*this.video.offsetHeight,this.video.videoWidth/e;const t=this.video.videoHeight/this.video.videoWidth*this.video.offsetWidth;return this.video.videoHeight/t}getYRatio(){let e,t;return this.hasSameOrientation()?this.hasLeftAndRightBorders()?this.video.videoHeight/this.video.offsetHeight:(t=this.video.videoHeight/this.video.videoWidth*this.video.offsetWidth,this.video.videoHeight/t):this.hasLeftAndRightBorders()?(e=this.video.videoWidth/this.video.videoHeight*this.video.offsetHeight,this.video.videoWidth/e):(t=this.video.videoHeight/this.video.videoWidth*this.video.offsetWidth,this.video.videoHeight/t)}getTopBorder(){if(this.setVideoElement(),this.hasLeftAndRightBorders())return 0;const e=this.video.videoHeight/this.video.videoWidth*this.video.offsetWidth;return(this.video.offsetHeight-e)/2}getLeftBorder(){if(this.setVideoElement(),!this.hasLeftAndRightBorders())return 0;const e=this.video.videoWidth/this.video.videoHeight*this.video.offsetHeight;return(this.video.offsetWidth-e)/2}}},{}],126:[function(e,t,n){const i=e("./util/OverlayPlugin"),s=2*Math.PI,a=Math.PI/2;t.exports=class extends i{constructor(t,n){if(super(t),this.instance=t,this.i18n=n||{},this.instance.fileUpload=this,this.root=this.instance.videoWrapper,this.stepper={},this.currentStep="homeScreen",this.isUploading=!1,this.hasError=!1,this.flashing=!1,this.canvasContext=null,this.opengappsInstalled=!1,this.capabilityAvailable=!1,window.Worker){let t=e("../worker/FileUploaderWorker");t=t.toString().match(/^\s*function\s*\(\s*\)\s*\{(([\s\S](?!\}$))*[\s\S])/)[1];const n=new Blob([t],{type:"application/javascript"});this.loaderWorker=new Worker(URL.createObjectURL(n)),this.loaderWorker.onmessage=e=>{const t=e.data;switch(t.code){case"SUCCESS":this.onUploadSuccess();break;case"FAIL":this.onUploadFailure();break;case"PROGRESS":this.setUploadProgress(t.value)}}}this.root.ondragenter=e=>{e.stopPropagation(),e.preventDefault()},this.root.ondragover=e=>{e.stopPropagation(),e.preventDefault()},this.root.ondragleave=e=>{e.stopPropagation(),e.preventDefault()},this.root.ondrop=e=>{e.stopPropagation(),e.preventDefault(),this.isUploading||this.upload(e.dataTransfer.files)},this.createStepper(),this.renderToolbarButton(),this.renderWidget(),this.instance.registerEventCallback("SYSTEM_PATCHER_STATUS",this.onSystemPatcherStatusEvent.bind(this)),this.instance.registerEventCallback("SYSTEM_PATCHER_LAST_RESULT",this.onSystemPatcherLastResultEvent.bind(this)),this.instance.registerEventCallback("systempatcher",e=>{const t=e.split(/ (.+)/);"status"===t[0]?this.onSystemPatcherStatusEvent(t[1]):"last_result"===t[0]&&this.onSystemPatcherLastResultEvent(t[1])})}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0],n=document.createElement("li");this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-uploader-button",this.toolbarBtnImage.title=this.i18n.UPLOADER_TITLE||"File upload",n.appendChild(this.toolbarBtnImage),n.onclick=this.toggleWidget.bind(this),t.appendChild(n)}renderWidget(){this.widget=document.createElement("div"),this.container=document.createElement("div"),this.title=document.createElement("div"),this.title.className="gm-upload-title",this.container.appendChild(this.title),this.inputs=document.createElement("div"),this.inputs.className="gm-uploader-content",this.container.appendChild(this.inputs),this.widget.className="gm-overlay gm-uploader-plugin gm-hidden";const e=document.createElement("div");e.className="gm-close-btn",e.onclick=this.toggleWidget.bind(this),this.widget.appendChild(e),this.widget.appendChild(this.container),this.overlays.push(this.widget),this.instance.root.appendChild(this.widget)}toggleWidget(){if(this.widget.classList.contains("gm-hidden")){if(this.instance.emit("close-overlays"),this.instance.emit("keyboard-disable"),this.displayStep(this.currentStep),"uploadScreen"===this.currentStep){const e={channel:"systempatcher",messages:["notify status"]};this.instance.sendEvent(e)}}else"successScreen"!==this.currentStep&&"errorScreen"!==this.currentStep||(this.currentStep="homeScreen"),this.instance.emit("keyboard-enable");this.widget.classList.toggle("gm-hidden"),this.toolbarBtnImage.classList.toggle("gm-active")}upload(e){if(e.length<=0)return;this.createUploadProgressCanvas(),this.setUploadProgress(0);const t={type:"upload",file:e[0]};this.loaderWorker.postMessage(t),this.isUploading=!0,this.hasError=!1}onUploadSuccess(){this.isUploading=!1,this.canvasContext.putImageData(this.canvasImageData,0,0),this.canvasContext.fillText("",30,80),this.canvasContext.stroke(),setTimeout(()=>{this.canvasContext.putImageData(this.canvasImageData,0,0)},750)}onUploadFailure(){this.isUploading=!1,this.hasError=!0}setUploadProgress(e,t){this.hasError||this.drawProgress(e,t)}onSystemPatcherStatusEvent(e){const t=document.getElementsByClassName("gm-upload-in-progress-txt-percent")[0],n=document.getElementsByClassName("gm-upload-in-progress-txt-progress")[0],i=document.getElementsByClassName("gm-upload-in-progress-percent")[0],s=e.split(" ");if("downloading"===s[0]&&s.length>=3&&t&&n&&i){const e=parseInt(s[1]),a=parseInt(s[2]);if(0===a||Number.isNaN(a))return;const r=Math.round(100*e/a);t.innerHTML=r+"%",i.style.width=r+"%";const o=1048576,c="Downloading "+Math.round(10*e/o)/10+" Mb/"+Math.round(10*a/o)/10+" Mb";n.innerHTML=c}else if("installing"===s[0]&&n)n.innerHTML=this.i18n.UPLOADER_INSTALLING||"Installing...";else if("ready"===s[0]&&s.length>=2){if(-1!==s[1].indexOf("opengapps")&&this.updateOpenGAppsStatus(!0),!this.flashing)return;const e={channel:"systempatcher",messages:["notify last_result"]};this.instance.sendEvent(e)}}onSystemPatcherLastResultEvent(e){switch(e){case"success":this.displayStep("successScreen"),this.flashing&&this.widget.classList.contains("gm-hidden")&&this.toggleWidget(),this.flashing=!1;break;case"unavailable":case"network_error":case"corrupted_archive":case"install_error":this.displayStep("errorScreen"),this.flashing&&this.widget.classList.contains("gm-hidden")&&this.toggleWidget(),this.flashing=!1}}createUploadProgressCanvas(){if(this.canvasContext)return;const e=document.createElement("canvas");e.classList.add("gm-upload-progress"),e.width=120,e.height=120,this.instance.wrapper.insertBefore(e,this.instance.wrapper.firstChild),this.canvasContext=e.getContext("2d"),this.canvasImageData=null,this.canvasContext.beginPath(),this.canvasContext.strokeStyle="#E6195E",this.canvasContext.fillStyle="#E6195E",this.canvasContext.lineCap="square",this.canvasContext.font="bold 60px Arial",this.canvasContext.lineWidth=10,this.canvasContext.closePath(),this.canvasContext.fill(),this.canvasImageData=this.canvasContext.getImageData(0,0,120,120)}drawProgress(e,t){t=void 0!==t?t:"#E6195E",this.canvasContext.strokeStyle=t,this.canvasContext.fillStyle=t,this.canvasContext.putImageData(this.canvasImageData,0,0),this.canvasContext.beginPath(),this.canvasContext.arc(60,60,55,-a,s*e-a,!1);const n=100!==(e=Math.round(100*e))?e:"99";this.canvasContext.fillText(n,25,80),this.canvasContext.stroke()}createStepper(){this.stepper.homeScreen=this.createHomeScreen.bind(this),this.stepper.disclaimerScreen=this.createDisclaimerScreen.bind(this),this.stepper.uploadScreen=this.createUploadScreen.bind(this),this.stepper.successScreen=this.createSuccessStep.bind(this),this.stepper.errorScreen=this.createErrorStep.bind(this)}displayStep(e){this.currentStep=e,this.inputs.innerHTML="";const t=this.stepper[e]();this.title.innerHTML=t.title,this.inputs.appendChild(t.body)}setAvailability(e){this.capabilityAvailable=e}createHomeScreen(){const e=document.createElement("div"),t=document.createElement("div");t.className="gm-upload-main",t.appendChild(this.createIconDiv("gm-upload-main-img")),t.appendChild(this.createTextDiv("gm-upload-main-txt","<p>You can install Open GApps, or upload a file: APK files will be installed, flashable archives will be flashed, and other files types will be pushed to the /sdcard/download folder on the device.</p>")),e.appendChild(t),this.uploader=document.createElement("input"),this.uploader.className="gm-uploader-file",this.uploader.type="file",this.uploader.setAttribute("gm-hidden",""),e.appendChild(this.uploader),this.uploader.onchange=()=>{this.isUploading||(this.toggleWidget(),this.upload(this.uploader.files))};const n=document.createElement("div");n.className="gm-upload-main-bottom-buttons";const i=this.createButtonsGroup("Install Open GApps",e=>{e.preventDefault(),!1===this.opengappsInstalled&&this.capabilityAvailable&&this.displayStep("disclaimerScreen")},"Browse",e=>{e.preventDefault(),this.uploader.click()});return this.installButton=i[0],this.updateOpenGAppsStatus(this.opengappsInstalled),n.appendChild(i[0]),n.appendChild(i[1]),e.appendChild(n),{body:e,title:this.i18n.UPLOADER_HOME_TITLE||"Upload file to the virtual device"}}updateOpenGAppsStatus(e){if(this.opengappsInstalled=e,this.installButton)return this.capabilityAvailable?void(e?(this.installButton.className="gm-upload-main-bottom-buttons-left gm-dont-close gm-uploader-install-opengapps gm-upload-main-bottom-buttons-disabled",this.installButton.innerHTML="Open GApps installed",this.installButton.title="Open GApps are already installed"):(this.installButton.className="gm-upload-main-bottom-buttons-left gm-dont-close gm-uploader-install-opengapps",this.installButton.innerHTML="Install Open GApps",this.installButton.title="Install Open GApps")):(this.installButton.className="gm-upload-main-bottom-buttons-left gm-dont-close gm-uploader-install-opengapps gm-upload-main-bottom-buttons-disabled",this.installButton.innerHTML="Install Open GApps",void(this.installButton.title="Open GApps are not available for this virtual device"))}createDisclaimerScreen(){const e=document.createElement("div"),t=document.createElement("div");t.className="gm-upload-disclaimer",t.appendChild(this.createTextDiv("gm-upload-disclaimer-txt","<p>PLEASE NOTE<br/>        GENYMOBILE INC., ASSUMES NO LIABILITY WHATSOEVER RESULTING FROM THE DOWNLOAD,        INSTALL AND USE OF GOOGLE PLAY SERVICES WITHIN YOUR VIRTUAL DEVICES. YOU ARE        SOLELY RESPONSIBLE FOR THE USE AND ASSUME ALL LIABILITY RELATED THERETO.        MOREOVER        <br/><br/>        GENYMOBILE INC. DISCLAIMS ANY WARRANTIES OF ANY KIND, EITHER EXPRESS OR IMPLIED,        INCLUDING, WITHOUT LIMITATION, IMPLIED WARRANTIES OF MERCHANTABILITY, OR FITNESS        FOR A PARTICULAR PURPOSE REGARDING THE COMPATIBILITY OF THE OPENGAPPS PACKAGES        WITH ANY VERSION OF GENYMOTION. IN NO EVENT SHALL GENYMOBILE INC. OR ITS AFFILIATES,        OR THEIR RESPECTIVE OFFICERS, DIRECTORS, EMPLOYEES, OR AGENTS BE LIABLE WITH RESPECT        TO YOUR DOWNLOAD OR USE OF THE GOOGLE PLAY SERVICES AND YOU RELEASE GENYMOBILE INC.        FROM ANY LIABILITY RELATED THERETO. YOU AGREE TO DEFEND, INDEMNIFY AND HOLD HARMLESS        GENYMOBILE INC. FOR ANY CLAIMS OR COSTS RELATED TO YOUR USE OR DOWNLOAD OF THE GOOGLE        PLAY SERVICES.            </p>")),e.appendChild(t);const n=document.createElement("div");n.className="gm-upload-main-bottom-buttons";const i=this.createButtonsGroup("Back",e=>{e.preventDefault(),this.flashing=!1,this.displayStep("homeScreen")},"Install",e=>{e.preventDefault(),this.flashing=!0;this.instance.sendEvent({channel:"systempatcher",messages:["install opengapps"]}),this.displayStep("uploadScreen")});return n.appendChild(i[0]),n.appendChild(i[1]),e.appendChild(n),{body:e,title:this.i18n.UPLOADER_DISCLAIMER||"You are about to install Open GApps on your virtual device"}}createUploadScreen(){const e=document.createElement("div"),t=document.createElement("div");t.className="gm-upload-in-progress";const n=this.createTextDiv("gm-upload-in-progress-txt-progress",""),i=this.createTextDiv("gm-upload-in-progress-txt-percent",""),s=this.createTextDiv("gm-upload-in-progress-bg-percent",""),a=this.createTextDiv("gm-upload-in-progress-percent","");a.style.width="0%",s.appendChild(a),t.appendChild(n),t.appendChild(i),t.appendChild(s),e.appendChild(t);const r=document.createElement("div");r.className="gm-upload-main-bottom-buttons";const o=this.createButtonsGroup(null,null,"Cancel",e=>{e.preventDefault();this.instance.sendEvent({channel:"systempatcher",messages:["cancel"]}),this.displayStep("disclaimerScreen")});return r.appendChild(o[1]),e.appendChild(r),{body:e,title:this.i18n.UPLOADER_INPROGRESS||"Downloading"}}createSuccessStep(){const e=document.createElement("div"),t=document.createElement("div");return t.className="gm-upload-success",t.appendChild(this.createIconDiv("gm-upload-success-img")),t.appendChild(this.createTextDiv("gm-upload-success-caption","Congratulation!")),t.appendChild(this.createTextDiv("gm-upload-success-txt","<p>Open GApps have been successfully             installed on the virtual device.<br/>Please restart the virtual device to complete the installation.<br/>            You will be redirected to the Open GApps website.</p>")),t.appendChild(this.createButton("gm-upload-success-button","Reboot device",e=>{e.preventDefault();this.instance.sendEvent({channel:"systempatcher",messages:["reboot"]}),this.toggleWidget()})),e.appendChild(t),{body:e,title:this.i18n.UPLOADER_SUCCESS||"Open GApps successfully installed"}}createErrorStep(){const e=document.createElement("div"),t=document.createElement("div");return t.className="gm-upload-error",t.appendChild(this.createIconDiv("gm-upload-error-img")),t.appendChild(this.createTextDiv("gm-upload-error-caption","Failed to install Open GApps")),e.appendChild(t),{body:e,title:this.i18n.UPLOADER_FAILURE||"We've got a problem"}}createButtonsGroup(e,t,n,i){const s=[null,null];return e&&(s[0]=this.createButton("gm-upload-main-bottom-buttons-left gm-dont-close",e,t)),n&&(s[1]=this.createButton("gm-upload-main-bottom-buttons-right gm-dont-close",n,i)),s}createButton(e,t,n){const i=document.createElement("div");return i.className=e,i.innerHTML=t,i.onclick=n,i}createIconDiv(e){const t=document.createElement("span");return t.className="gm-upload-icon "+e,t}createTextDiv(e,t){const n=document.createElement("div");return n.className=e,n.innerHTML=t,n}}},{"../worker/FileUploaderWorker":147,"./util/OverlayPlugin":142}],127:[function(e,t,n){t.exports=class{constructor(e){this.instance=e,document.addEventListener&&(document.addEventListener("webkitfullscreenchange",this.onFullscreenEvent.bind(this),!1),document.addEventListener("fullscreenchange",this.onFullscreenEvent.bind(this),!1)),this.renderToolbarButton()}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];if(this.isTemplateFullscreen()){const e=this.instance.getChildByClass(this.instance.root,"gm-fullscreen-message");e.onclick=()=>{e.classList.add("hide"),this.instance.wrapper.classList.remove("hide"),this.goFullscreen(this.instance.root)}}else this.button=document.createElement("li"),this.image=document.createElement("div"),this.image.className="gm-icon-button gm-fullscreen-button",this.image.title="Fullscreen",this.button.appendChild(this.image),t.appendChild(this.button),this.button.onclick=()=>{this.fullscreenEnabled()?this.exitFullscreen():this.goFullscreen(this.instance.root)}}goFullscreen(e){this.instance.wrapper.classList.add("gm-fullscreen"),this.image.classList.add("gm-active"),e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}fullscreenEnabled(){return document.fullscreenElement||document.webkitFullscreenElement}exitFullscreen(){this.instance.wrapper.classList.remove("gm-fullscreen"),this.image.classList.remove("gm-active"),this.fullscreenEnabled()&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}isTemplateFullscreen(){return Boolean(this.instance.getChildByClass(this.instance.root,"gm-fullscreen-message"))}onFullscreenEvent(){this.fullscreenEnabled()||this.exitFullscreen()}}},{}],128:[function(e,t,n){const i=e("./util/OverlayPlugin"),s=e("loglevel");s.setDefaultLevel("debug"),t.exports=class extends i{constructor(e,t,n){super(e),this.instance=e,this.i18n=t||{},this.instance.gps=this,this.fields=["altitude","longitude","latitude","accuracy","bearing"],n&&this.fields.push("speed"),this.map=null,"undefined"!=typeof google?this.elevationService=new google.maps.ElevationService:this.elevationService=!1,this.markers=[],this.mapLat=65.9667,this.mapLng=-18.5333,this.elevation=15.04444408,this.minimumZoomLevel=8,this.renderToolbarButton(),this.renderGPSForm(),this.renderMapView(),this.instance.registerEventCallback("gps",e=>{const t=e.split(" ");this.fields.includes(t[0])&&t.length>=2&&this.setFieldValue("gm-gps-"+t[0],t[1])})}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-gps-button",this.toolbarBtnImage.title=this.i18n.GPS_TITLE||"GPS",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleForm.bind(this),t.appendChild(this.toolbarBtn)}renderMapView(){this.mapWidget=document.createElement("div"),this.mapview=document.createElement("div");const e=document.createElement("button");e.innerHTML=this.i18n.GPS_CAPTURE||"Capture",e.className="gm-gps-mapview-capture",e.onclick=this.onMapClicked.bind(this);const t=document.createElement("button");t.innerHTML=this.i18n.GPS_CANCEL||"Cancel",t.className="gm-gps-mapview-cancel",t.onclick=this.onHideMapButtonClicked.bind(this),this.mapview.className="gm-mapview",this.mapWidget.className="gm-overlay gm-gps-mapview gm-hidden",this.mapWidget.appendChild(this.mapview),this.mapWidget.appendChild(e),this.mapWidget.appendChild(t),this.overlays.push(this.mapWidget),this.instance.root.appendChild(this.mapWidget)}loadMap(){const e=this.getLocationInfo();"undefined"!=typeof google&&(this.map=new google.maps.Map(this.mapview,{center:{lat:e.latitude,lng:e.longitude},zoom:this.minimumZoomLevel}),this.addMapMarker(e.latitude,e.longitude),this.map.addListener("click",e=>{this.clearMarkers(),this.addMapMarker(e.latLng.lat(),e.latLng.lng())}))}toggleMapview(){this.mapWidget.classList.toggle("gm-hidden")}generateInput(e,t,n,i,s){const a=document.createElement("div"),r=document.createElement("label");r.innerHTML=t,a.appendChild(r);const o=document.createElement("input");return o.type="number",o.defaultValue=n,o.min=i,o.max=s,o.className="gm-gps-"+e,o.step="any",o.addEventListener("keyup",this.checkErrors.bind(this)),a.appendChild(o),a}checkErrors(){let e=!1;this.fields.forEach(t=>{const n=this.instance.getChildByClass(this.instance.root,"gm-gps-"+t);!1===n.checkValidity()?(n.classList.add("gm-error"),e=!0):n.classList.remove("gm-error")}),this.instance.getChildByClass(this.instance.root,"gm-gps-submit").disabled=e}renderGPSForm(){this.formWidget=document.createElement("div"),this.form=document.createElement("form");const e=document.createElement("div"),t=document.createElement("div");t.className="gm-title",t.innerHTML=this.i18n.GPS_TITLE||"GPS",this.form.appendChild(t);const n=document.createElement("div");n.className="gm-col";const i=this.i18n.GPS_LATITUDE||"Latitude ()";n.appendChild(this.generateInput("latitude",i,this.mapLat,-90,90));const s=this.i18n.GPS_LONGITUDE||"Longitude ()";n.appendChild(this.generateInput("longitude",s,this.mapLng,-180,180));const a=this.i18n.GPS_ALTITUDE||"Altitude (m)";n.appendChild(this.generateInput("altitude",a,this.elevation,-1e4,1e4));const r=this.i18n.GPS_ACCURACY||"Accuracy (m)";n.appendChild(this.generateInput("accuracy",r,0,0,200));const o=this.i18n.GPS_BEARING||"Bearing ()";if(n.appendChild(this.generateInput("bearing",o,0,0,360)),this.fields.includes("speed")){const e=this.i18n.GPS_SPEED||"Speed (m/s)";n.appendChild(this.generateInput("speed",e,0,0,399.99))}const c=document.createElement("div"),l=document.createElement("div"),d=document.createElement("button");this.rightGeolocWrap=document.createElement("div"),this.geolocBtn=document.createElement("button"),c.className="gm-col",l.className="map-wrap",d.className="map",d.innerHTML=this.i18n.GPS_MAP||"MAP",d.onclick=this.onOpenMapButtonClicked.bind(this),this.elevationService||(d.disabled=!0),this.rightGeolocWrap.className="gm-geoloc-wrap",this.geolocBtn.className="gm-gps-geoloc",this.geolocBtn.innerHTML=this.i18n.GPS_GEOLOC||"My position",this.geolocBtn.onclick=this.onGeolocButtonClicked.bind(this),l.appendChild(d),this.rightGeolocWrap.appendChild(this.geolocBtn),c.appendChild(l),c.appendChild(this.rightGeolocWrap),e.className="gm-wrap",e.appendChild(n),e.appendChild(c),this.form.appendChild(e);const h=document.createElement("button");h.innerHTML=this.i18n.GPS_SUBMIT||"Submit",h.className="gm-gps-submit",h.onclick=this.sendDataToInstance.bind(this),this.form.appendChild(h),this.formWidget.className="gm-overlay gm-gps-controls gm-hidden";const p=document.createElement("div");p.className="gm-close-btn",p.onclick=this.toggleForm.bind(this),this.formWidget.appendChild(p),this.formWidget.appendChild(this.form),this.overlays.push(this.formWidget),this.instance.root.appendChild(this.formWidget)}toggleForm(){this.formWidget.classList.contains("gm-hidden")?(this.instance.emit("close-overlays"),this.instance.emit("keyboard-disable")):this.instance.emit("keyboard-enable"),this.checkForGeolocation(),this.formWidget.classList.toggle("gm-hidden"),this.mapWidget.classList.add("gm-hidden"),this.toolbarBtnImage.classList.toggle("gm-active")}setGeolocButtonAvailability(e){this.geolocBtn.disabled=!e,this.rightGeolocWrap.title=e?this.i18n.GPS_GEOLOC_TOOLTIP||"Get my position from browser location":this.i18n.GPS_NOGEOLOC_TOOLTIP||"Geolocation not supported"}onOpenMapButtonClicked(e){e.preventDefault(),this.toggleMapview(),this.loadMap()}onGeolocButtonClicked(e){e.preventDefault(),this.getLocation()}onMapClicked(e){e.preventDefault(),this.setFieldValue("gm-gps-latitude",this.mapLat),this.setFieldValue("gm-gps-longitude",this.mapLng),this.setFieldValue("gm-gps-altitude",this.elevation),this.toggleMapview()}onHideMapButtonClicked(e){e.preventDefault(),this.mapWidget.classList.add("gm-hidden")}sendDataToInstance(e){e.preventDefault();const t=this.buildEventJson();t.messages.length&&this.instance.sendEvent(t),this.toggleForm()}getLocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{if(e&&e.coords&&(this.fields.forEach(t=>{e.coords[t]&&this.setFieldValue("gm-gps-"+t,e.coords[t])}),!e.coords.altitude&&this.elevationService&&e.coords.latitude&&e.coords.longitude)){const t=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);this.elevationService.getElevationForLocations({locations:[t]},(e,t)=>{"OK"===t&&e[0]&&this.setFieldValue("gm-gps-altitude",e[0].elevation)})}})}checkForGeolocation(){"geolocation"in navigator?navigator.geolocation.getCurrentPosition(()=>{this.setGeolocButtonAvailability(!0)},()=>{this.setGeolocButtonAvailability(!1)}):this.setGeolocButtonAvailability(!1)}setFieldValue(e,t){if(t=Number(t),Number.isNaN(t))return;const n=this.instance.getChildByClass(this.instance.root,e);n&&(n.max&&(t=Math.min(t,n.max)),n.min&&(t=Math.max(t,n.min)),n.value=t)}getLocationInfo(){const e={};return this.fields.forEach(t=>{const n=this.instance.getChildByClass(this.instance.root,"gm-gps-"+t);if(!n)return void s.debug(t+" field not found.");let i=Number(n.value);Number.isNaN(i)||(n.max&&(i=Math.min(i,n.max)),n.min&&(i=Math.max(i,n.min)),e[t]=i)}),e}buildEventJson(){const e={channel:"gps",messages:[]},t=this.getLocationInfo();return this.fields.forEach(n=>{e.messages.push("set "+n+" "+t[n])}),e.messages.length&&e.messages.push("enable"),e}addMapMarker(e,t){this.mapLat=e,this.mapLng=t;const n=new google.maps.Marker({position:{lat:this.mapLat,lng:this.mapLng},map:this.map});if(this.markers.push(n),this.map&&this.map.getZoom()<this.minimumZoomLevel&&(this.map.setCenter(n.getPosition()),this.map.setZoom(this.minimumZoomLevel)),this.elevationService){const n=new google.maps.LatLng(e,t);this.elevationService.getElevationForLocations({locations:[n]},(e,t)=>{"OK"===t&&e[0]&&(this.elevation=e[0].elevation)})}}clearMarkers(){this.markers.forEach(e=>{e.setMap(null)}),this.markers=[]}}},{"./util/OverlayPlugin":142,loglevel:99}],129:[function(e,t,n){const i=e("loglevel");i.setDefaultLevel("debug");const s=e("./util/OverlayPlugin");t.exports=class extends s{constructor(e,t,n){super(e),this.instance=e,this.i18n=n||{},this.manager=t,this.instance.gamepad=this,window.addEventListener("gm-gamepadButtonPressed",this.onGamepadButtonPressed.bind(this)),window.addEventListener("gm-gamepadButtonReleased",this.onGamepadButtonReleased.bind(this)),this.renderToolbarButton(),this.renderWidget()}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-battery-button",this.toolbarBtnImage.title=this.i18n.GAMEPAD_TITLE||"Gamepad",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.container=document.createElement("div");const e=document.createElement("div");e.className="gm-title",e.innerHTML=this.i18n.GAMEPAD_TITLE||"Gamepad",this.container.appendChild(e),this.content=document.createElement("div"),this.container.appendChild(this.content),this.generateContent(),window.addEventListener("gm-gamepadConnected",this.generateContent.bind(this)),window.addEventListener("gm-gamepadDisconnected",this.generateContent.bind(this)),this.widget.className="gm-overlay gm-gamepad-plugin gm-hidden";const t=document.createElement("div");t.onclick=this.toggleWidget.bind(this),t.className="gm-close-btn",this.widget.appendChild(t),this.widget.appendChild(this.container),this.overlays.push(this.widget),this.instance.root.appendChild(this.widget)}generateContent(){this.content.replaceChildren();const e=this.instance.gamepadManager.getGamepads();if(0===e.length)this.content.innerHTML="No gamepad detected, please plug one or press a button";else{const t=document.createElement("ul");for(const n of e)if("plugged"===n.state){const e=document.createElement("li");e.innerHTML=n.name,t.appendChild(e)}this.content.appendChild(t)}}toggleWidget(){this.widget.classList.contains("gm-hidden")?(this.instance.emit("close-overlays"),this.instance.emit("keyboard-disable")):this.instance.emit("keyboard-enable"),this.widget.classList.toggle("gm-hidden"),this.toolbarBtnImage.classList.toggle("gm-active")}gamepadButtonToKeyboardButton(e){switch(e){case 0:return 304;case 1:return 305;case 2:return 307;case 3:return 308;case 4:return 310;case 5:return 311;case 6:return 312;case 7:return 313;case 8:return 314;case 9:return 315;case 10:return 317;case 11:return 318;case 12:return 103;case 13:return 108;case 14:return 105;case 15:return 106;default:return null}}onGamepadButtonPressed(e){i.debug("button pressed"),i.debug(e.detail);const t={type:"KEYBOARD_PRESS",keychar:"",keycode:this.gamepadButtonToKeyboardButton(e.detail.buttonIndex)};this.instance.sendEvent(t)}onGamepadButtonReleased(e){i.debug("button released"),i.debug(e.detail);const t={type:"KEYBOARD_RELEASE",keychar:"",keycode:this.gamepadButtonToKeyboardButton(e.detail.buttonIndex)};this.instance.sendEvent(t)}}},{"./util/OverlayPlugin":142,loglevel:99}],130:[function(e,t,n){const i=e("loglevel");i.setDefaultLevel("debug");const s=Object.freeze({Xbox360:Symbol("Xbox360"),XboxOne:Symbol("XboxOne"),Dualshock4:Symbol("DualShock4")});t.exports=class{constructor(e){this.instance=e,this.instance.gamepadManager=this,this.instance.gamepadEventsEnabled=!0,this.isRunning=!1,this.gamepadInfos=[["GPD Win 2 X-Box Controller",s.Xbox360,121,6356],["Thrustmaster Gamepad GP XID",s.Xbox360,1103,45862],["Xbox 360 Controller",s.Xbox360,1118,654],["Xbox 360 Controller v2",s.Xbox360,1118,655],["Xbox 360 Wireless Dongle",s.Xbox360,1118,657],["Xbox 360 Big Button IR",s.Xbox360,1118,672],["Xbox 360 Controller",s.Xbox360,1118,673],["Xbox One Controller (1537)",s.XboxOne,1118,733],["Xbox One Controller (Firmware 2015)",s.XboxOne,1103,45862],["Xbox One S Controller (Bluetooth)",s.XboxOne,1118,736],["Xbox One Elite Controller",s.XboxOne,1118,739],["Xbox One S Controller (1708)",s.XboxOne,1118,746],["Xbox One S Controller (1708) (Bluetooth)",s.XboxOne,1118,765],["Xbox One Controller",s.XboxOne,1118,767],["Xbox One Elite Series 2",s.XboxOne,1118,2816],["Xbox 360 Wireless Receiver",s.Xbox360,1118,1817],["Xbox Series X/S Controller",s.XboxOne,1118,2834],["Xbox Series X/S Controller",s.XboxOne,1118,2835],["Logitech Gamepad F310",s.Xbox360,1133,49693],["Logitech Gamepad F510",s.Xbox360,1133,49694],["Logitech Gamepad F710",s.Xbox360,1133,49695],["Logitech Chillstream Controller",s.Xbox360,1133,49730],["HORI Pad Switch",s.Xbox360,3853,193],["HORI Pokken Tournament DX Pro Pad",s.Xbox360,3853,146],["HORI Wireless Switch Pad",s.Xbox360,3853,246],["HORI Battle Pad",s.Xbox360,3853,220],["PowerA Wired Controller Plus/PowerA Wired Gamecube Controller",s.Xbox360,8406,42769],["PDP Wired Fight Pad Pro for Nintendo Switch",s.Xbox360,3695,389],["PDP Faceoff Wired Pro Controller for Nintendo Switch",s.Xbox360,3695,384],["PDP Faceoff Deluxe Wired Pro Controller for Nintendo Switch",s.Xbox360,3695,385],["Nintendo Switch Pro Controller",s.Xbox360,1406,8201],["PlayStation 3 Controller",s.Dualshock4,1356,616],["PlayStation 3 Controller",s.Dualshock4,2341,5],["PlayStation 3 Controller",s.Dualshock4,34952,776],["Afterglow PS3",s.Dualshock4,6708,2102],["HORI horipad4 PS3",s.Dualshock4,3853,110],["HORI horipad4 PS4",s.Dualshock4,3853,102],["HORI Fighting commander PS3",s.Dualshock4,3853,95],["HORI Fighting commander PS4",s.Dualshock4,3853,94],["Madcats Fightpad Pro PS4",s.Dualshock4,1848,33360],["Venom Arcade Stick",s.Dualshock4,121,6170],["PC Twin Shock Controller",s.Dualshock4,121,6],["Digiflip GP006",s.Dualshock4,9571,1315],["SRXJ-PH2400",s.Dualshock4,4607,13105],["ShanWan PS3",s.Dualshock4,8380,21760],["Firestorm Dual Analog 3",s.Dualshock4,1103,45845],["Horipad 3",s.Dualshock4,3853,77],["HORI BDA GP1",s.Dualshock4,3853,9],["Green Asia",s.Dualshock4,3727,8],["Real Arcade Pro 4",s.Dualshock4,3853,106],["Rock Candy PS4",s.Dualshock4,3695,286],["Afterglow PS3",s.Dualshock4,3695,532],["JC-U4113SBK",s.Dualshock4,1390,8211],["Madcatz Fightstick Pro",s.Dualshock4,1848,34872],["Afterglow PS3",s.Dualshock4,6708,2102],["Quanba Q1 fight stick",s.Dualshock4,3888,4352],["HORI fighting mini stick",s.Dualshock4,3853,135],["BTP 2163",s.Dualshock4,33664,3],["PS2 ACME GA-D5",s.Dualshock4,4933,4096],["SpeedLink Strike FX",s.Dualshock4,3727,12405],["Rock Candy PS3",s.Dualshock4,3695,296],["Quanba Drone",s.Dualshock4,11298,8192],["Cyborg V3",s.Dualshock4,1699,63010],["Thrustmaster wireless 3-1",s.Dualshock4,1103,53255],["Gioteck vx2",s.Dualshock4,9712,33731],["JC-U3412SBK",s.Dualshock4,1464,4102],["Power A PS3",s.Dualshock4,8406,22381],["PDP Afterglow Wireless PS3 Controller",s.Dualshock4,3695,4884],["Mad Catz Alpha PS3 mode",s.Dualshock4,1848,12672],["Mad Catz Alpha PS4 mode",s.Dualshock4,1848,33152],["Victrix Pro FS",s.Dualshock4,3695,515],["PlayStation 4 Controller",s.Dualshock4,1356,1476],["PlayStation 4 Controller V2",s.Dualshock4,1356,2508],["PlayStation 4 Wireless Dongle",s.Dualshock4,1356,2976],["PS5 DualSense Controller",s.Dualshock4,1356,3302],["HORI Real Arcade Pro 4",s.Dualshock4,3853,138],["HORIPAD 4 FPS",s.Dualshock4,3853,85],["HORIPAD 4 FPS Plus",s.Dualshock4,3853,102],["HORIPAD 4 FPS Plus",s.Dualshock4,1848,33668],["Mad Catz FightPad Pro PS4",s.Dualshock4,1848,33360],["Mad Catz Fightstick TE S+",s.Dualshock4,1848,33668],["Armor Armor 3 Pad PS4",s.Dualshock4,3090,3600],["EMIO PS4 Elite Controller",s.Dualshock4,3090,7414],["Razer Raiju PS4 Controller",s.Dualshock4,5426,4096],["Razer Panthera PS4 Controller",s.Dualshock4,5426,1025],["STRIKEPAD PS4 Grip Add-on",s.Dualshock4,1356,1477],["Nacon Revolution Pro Controller",s.Dualshock4,5227,3329],["Nacon Revolution Pro Controller V2",s.Dualshock4,5227,3330],["HORI TAC4",s.Dualshock4,3853,160],["HORI TAC PRO",s.Dualshock4,3853,156],["Hitbox Arcade Stick",s.Dualshock4,3090,3830],["Venom Arcade Stick",s.Dualshock4,121,6171],["Mad Catz FightPad PRO",s.Dualshock4,1848,12880],["HORI mini wired gamepad",s.Dualshock4,3853,238],["Mad Catz FightStick TE 2+ PS4",s.Dualshock4,1848,33921],["Mad Catz FightStick TE 2",s.Dualshock4,1848,33920],["Armor 3, Level Up Cobra",s.Dualshock4,30021,260],["Razer Raiju 2 Tournament Edition (USB)",s.Dualshock4,5426,4103],["Razer Raiju 2 Tournament Edition (BT)",s.Dualshock4,5426,4106],["Razer Raiju 2 Ultimate Edition (USB)",s.Dualshock4,5426,4100],["Razer Raiju 2 Ultimate Edition (BT)",s.Dualshock4,5426,4105],["Razer Panthera Evo Fightstick",s.Dualshock4,5426,4104],["Astro C40",s.Dualshock4,39046,37],["Game:Pad 4",s.Dualshock4,3090,3605],["PS4 Fun Controller",s.Dualshock4,16385,260],["Elecom JC-U3613M",s.Xbox360,1390,8196],["Saitek P3600",s.Xbox360,1699,62746],["Mad Catz Wired Xbox 360 Controller",s.Xbox360,1848,18198],["Mad Catz Street Fighter IV FightStick SE",s.Xbox360,1848,18200],["Mad Catz Xbox 360 Controller",s.Xbox360,1848,18214],["Mad Catz Street Fighter IV FightPad",s.Xbox360,1848,18216],["Mad Catz MicroCon Gamepad",s.Xbox360,1848,18230],["Mad Catz Wired Xbox 360 Controller (SFIV)",s.Xbox360,1848,18232],["Mad Catz Beat Pad",s.Xbox360,1848,18240],["Mad Catz FightStick TE 2",s.XboxOne,1848,18945],["Mad Catz Xbox controller - MW2",s.Xbox360,1848,46886],["Mad Catz JOYTECH NEO SE Advanced GamePad",s.Xbox360,1848,48879],["Saitek Cyborg Rumble Pad - PC/Xbox 360",s.Xbox360,1848,51970],["Saitek P3200 Rumble Pad - PC/Xbox 360",s.Xbox360,1848,51971],["Super SFIV FightStick TE S",s.Xbox360,1848,63288],["HSM3 Xbox360 dancepad",s.Xbox360,3695,261],["Afterglow AX.1 Gamepad for Xbox 360",s.Xbox360,3695,275],["Rock Candy Gamepad Wired Controller",s.Xbox360,3695,287],["Xbox 360 Wired Controller",s.Xbox360,3695,307],["Afterglow Prismatic Wired Controller",s.XboxOne,3695,313],["PDP Xbox One Controller",s.XboxOne,3695,314],["Rock Candy Wired Controller for Xbox One",s.XboxOne,3695,326],["PDP Marvel Xbox One Controller",s.XboxOne,3695,327],["PDP Xbox One Arcade Stick",s.XboxOne,3695,348],["PDP Xbox One Controller",s.XboxOne,3695,353],["PDP Xbox One Controller",s.XboxOne,3695,354],["PDP Xbox One Controller",s.XboxOne,3695,355],["PDP Battlefield One",s.XboxOne,3695,356],["PDP Titanfall 2",s.XboxOne,3695,357],["Pelican PL-3601 'TSZ' Wired Xbox 360 Controller",s.Xbox360,3695,513],["Afterglow Gamepad for Xbox 360",s.Xbox360,3695,531],["Rock Candy Gamepad for Xbox 360",s.Xbox360,3695,543],["Rock Candy Gamepad for Xbox One 2015",s.XboxOne,3695,582],["Logic3 Controller",s.Xbox360,3695,769],["Rock Candy Gamepad for Xbox One 2016",s.XboxOne,3695,838],["Logic3 Controller",s.Xbox360,3695,1025],["Afterglow AX.1 Gamepad for Xbox 360",s.Xbox360,3695,1043],["PDP Xbox 360 Controller",s.Xbox360,3695,1281],["PDP Afterglow AX.1",s.Xbox360,3695,63744],["Hori Co. DOA4 FightStick",s.Xbox360,3853,10],["Hori PadEX Turbo",s.Xbox360,3853,12],["Hori Fighting Stick EX2",s.Xbox360,3853,13],["Hori Real Arcade Pro.EX",s.Xbox360,3853,22],["Hori Real Arcade Pro VX",s.Xbox360,3853,27],["Hori Real Arcade Pro Hayabusa (USA) Xbox One",s.XboxOne,3853,99],["HORIPAD ONE",s.XboxOne,3853,103],["Hori Real Arcade Pro V Kai Xbox One",s.XboxOne,3853,120],["Nacon GC-100XF",s.Xbox360,4553,22e3],["Honey Bee Xbox360 dancepad",s.Xbox360,4779,4],["PDP AFTERGLOW AX.1",s.Xbox360,4779,769],["Mortal Kombat Klassic FightStick",s.Xbox360,4779,771],["RedOctane Guitar Hero X-plorer",s.Xbox360,5168,18248],["RedOctane Controller",s.Xbox360,5168,63489],["BigBen Interactive XBOX 360 Controller",s.Xbox360,5227,1537],["Razer Sabertooth",s.Xbox360,5426,55],["Razer Atrox Arcade Stick",s.XboxOne,5426,2560],["Razer Wildcat",s.XboxOne,5426,2563],["Power A Mini Pro Elite",s.Xbox360,5604,16128],["Xbox Airflo wired controller",s.Xbox360,5604,16138],["Batarang Xbox 360 controller",s.Xbox360,5604,16144],["Joytech Neo-Se Take2",s.Xbox360,5678,48879],["Razer Onza Tournament Edition",s.Xbox360,5769,64768],["Razer Onza Classic Edition",s.Xbox360,5769,64769],["Razer Sabertooth",s.Xbox360,5769,65024],["Harmonix Rock Band Guitar",s.Xbox360,7085,2],["Harmonix Rock Band Drumkit",s.Xbox360,7085,3],["Mad Catz Xbox 360 Controller",s.Xbox360,7085,61462],["Mad Catz Street Fighter IV SE Fighting Stick",s.Xbox360,7085,61464],["Mad Catz Brawlstick for Xbox 360",s.Xbox360,7085,61465],["Mad Cats Ghost Recon FS GamePad",s.Xbox360,7085,61473],["MLG Pro Circuit Controller (Xbox)",s.Xbox360,7085,61475],["Mad Catz Call Of Duty",s.Xbox360,7085,61477],["Mad Catz FPS Pro",s.Xbox360,7085,61479],["Street Fighter IV FightPad",s.Xbox360,7085,61480],["Mad Catz Fightpad",s.Xbox360,7085,61486],["Mad Catz MicroCon GamePad Pro",s.Xbox360,7085,61494],["Street Fighter IV FightStick TE",s.Xbox360,7085,61496],["Mad Catz MvC2 TE",s.Xbox360,7085,61497],["Mad Catz SFxT Fightstick Pro",s.Xbox360,7085,61498],["Street Fighter IV Arcade Stick TE - Chun Li",s.Xbox360,7085,61501],["Mad Catz MLG FightStick TE",s.Xbox360,7085,61502],["Mad Catz FightStick SoulCaliber",s.Xbox360,7085,61503],["Mad Catz FightStick TES+",s.Xbox360,7085,61506],["Mad Catz FightStick TE2",s.Xbox360,7085,61568],["HoriPad EX2 Turbo",s.Xbox360,7085,62721],["Hori Real Arcade Pro.VX SA",s.Xbox360,7085,62722],["Hori Fighting Stick VX",s.Xbox360,7085,62723],["Hori Real Arcade Pro. EX",s.Xbox360,7085,62724],["Hori Fighting Stick EX2B",s.Xbox360,7085,62725],["Hori Real Arcade Pro.EX Premium VLX",s.Xbox360,7085,62726],["Harmonix Xbox 360 Controller",s.Xbox360,7085,63744],["Gamestop Xbox 360 Controller",s.Xbox360,7085,63745],["Tron Xbox 360 controller",s.Xbox360,7085,63747],["PDP Versus Fighting Pad",s.Xbox360,7085,63748],["MortalKombat FightStick",s.Xbox360,7085,63750],["MadCatz GamePad",s.Xbox360,7085,64001],["Razer Onza TE",s.Xbox360,7085,64768],["Razer Onza",s.Xbox360,7085,64769],["Razer Atrox Arcade Stick",s.Xbox360,9414,20480],["PowerA MINI PROEX Controller",s.Xbox360,9414,21248],["Xbox Airflo wired controller",s.Xbox360,9414,21251],["Xbox 360 Pro EX Controller",s.Xbox360,9414,21258],["PowerA Pro Ex",s.Xbox360,9414,21274],["FUS1ON Tournament Controller",s.Xbox360,9414,21399],["PowerA Xbox One Mini Wired Controller",s.XboxOne,9414,21530],["Xbox ONE spectra",s.XboxOne,9414,21546],["PowerA Xbox One wired controller",s.XboxOne,9414,21562],["Hori XBOX 360 EX 2 with Turbo",s.Xbox360,9414,21760],["Hori Real Arcade Pro VX-SA",s.Xbox360,9414,21761],["Hori Fighting Stick VX Alt",s.Xbox360,9414,21762],["Hori Fighting Edge",s.Xbox360,9414,21763],["Hori SOULCALIBUR V Stick",s.Xbox360,9414,21766],[" GEM Xbox controller",s.Xbox360,9414,21773],["Hori Real Arcade Pro V Kai 360",s.Xbox360,9414,21774],["PowerA FUSION Pro Controller",s.XboxOne,9414,21786],["PowerA FUSION Controller",s.XboxOne,9414,22042],["Thrustmaster",s.Xbox360,9414,23298],["Thrustmaster Ferrari 458 Racing Wheel",s.Xbox360,9414,23299],["Razer Sabertooth",s.Xbox360,9414,23812],["Rock Candy Gamepad for Xbox 360",s.Xbox360,9414,64254],["Stadia Controller",s.Xbox360,6353,37888]],this.currentGamepads=[]}addGamepadCallbacks(){window.addEventListener("gamepadconnected",this.onGamepadConnected.bind(this)),window.addEventListener("gamepaddisconnected",this.onGamepadDisonnected.bind(this))}onGamepadConnected(e){const t=this.parseGamepad(e.gamepad),n=new CustomEvent("gm-gamepadConnected",{detail:t});""!==e.gamepad.mapping?window.dispatchEvent(n):i.error("Unsupported gamepad mapping for gamepad "+t.name)}onGamepadDisonnected(e){const t=new CustomEvent("gm-gamepadDisconnected",{detail:this.parseGamepad(e.gamepad)});window.dispatchEvent(t),this.stopListeningInputs(e.gamepad.index)}getRawGamepads(){return navigator.getGamepads()}getGamepads(){const e=[],t=this.getRawGamepads();for(let n=0;n<t.length;n++)t[n]&&e.push(this.parseGamepad(t[n]));return e}getByRemoteIndex(e){for(let t=0;t<this.currentGamepads.length;t++)if(this.currentGamepads[t].remoteIndex===e)return this.getGamepads()[t]}getRawGamepadByRemoteIndex(e){for(let t=0;t<this.currentGamepads.length;t++)if(this.currentGamepads[t].remoteIndex===e)return this.getRawGamepads()[t]}getInfosFromID(e,t){return this.gamepadInfos.find(n=>n[2]===e&&n[3]===t)}listenForInputs(e,t){this.currentGamepads[e]={remoteIndex:t,buttons:[]},this.isRunning||this.loop()}stopListeningInputs(e){this.currentGamepads.splice(e,1)}computeValueInNewRange(e,t,n,i,s){const a=Math.abs(t-e);if(0===a)return n;return(s-e)*Math.abs(i-n)/a+n}loop(){if(0===this.currentGamepads.length)return void(this.isRunning=!1);this.isRunning=!0;const e=this.getRawGamepads();for(const t of e)if(t&&this.currentGamepads[t.index]){for(let e=0;e<t.buttons.length;e++){const n=this.currentGamepads[t.index].buttons.indexOf(e);if(!t.buttons[e].pressed||-1!==n&&6!==e&&7!==e){if(!t.buttons[e].pressed&&-1!==n){this.currentGamepads[t.index].buttons.splice(n,1);const i=new CustomEvent("gm-gamepadButtonReleased",{detail:{gamepadIndex:this.currentGamepads[t.index].remoteIndex,buttonIndex:e,value:t.buttons[e].value}});window.dispatchEvent(i)}}else{-1===n&&this.currentGamepads[t.index].buttons.push(e);const i=new CustomEvent("gm-gamepadButtonPressed",{detail:{gamepadIndex:this.currentGamepads[t.index].remoteIndex,buttonIndex:e,value:t.buttons[e].value}});window.dispatchEvent(i)}}for(let e=0;e<t.axes.length;e++){const n=new CustomEvent("gm-gamepadAxis",{detail:{gamepadIndex:this.currentGamepads[t.index].remoteIndex,axisIndex:e,value:t.axes[e]}});window.dispatchEvent(n)}}window.requestAnimationFrame(this.loop.bind(this))}parseGamepad(e){var t;const n=-1!==navigator.userAgent.indexOf("Firefox"),i={localIndex:e.index,name:e.id,power:"unknown",controllerType:s.Xbox360,vendor:"Default",vendorID:0,productID:0,state:e.connected?"plugged":"undefined",remoteIndex:null===(t=this.currentGamepads[e.index])||void 0===t?void 0:t.remoteIndex};if(n){const t=/^([0-9a-f]{1,4})-([0-9a-f]{1,4})-\s*(.*)\s*$/i,n=e.id.match(t);n&&(i.vendorID=Number("0x"+n[1]),i.productID=Number("0x"+n[2]),i.name=n[3])}else{const t=/(.+) \(((.+) )?Vendor: (.+) Product: (.+)\)/i,n=e.id.match(t);n&&(i.name=n[1],i.vendor=n[2],i.vendorID=Number("0x"+n[n.length-2]),i.productID=Number("0x"+n[n.length-1]))}const a=this.instance.gamepadManager.getInfosFromID(i.vendorID,i.productID);return a&&(i.name=a[0]+" ("+i.name+")",i.controllerType=a[1]),i}vibration(e,t,n){const s=this.getRawGamepadByRemoteIndex(e);if(s)if(s.vibrationActuator){const a=s.vibrationActuator;if(a.playEffect){const e=this.computeValueInNewRange(0,255,0,1,t.toFixed(1)),i=this.computeValueInNewRange(0,255,0,1,n.toFixed(1));a.playEffect("dual-rumble",{startDelay:0,duration:200,weakMagnitude:e,strongMagnitude:i})}else i.error("could not use vibration actuator for controller "+e),i.debug(s)}else if(s.hapticActuators&&s.hapticActuators[0]){const t=s.hapticActuators[0];t.pulse?t.pulse(n,200):(i.error("could not use haptic actuator for controller "+e),i.debug(s))}else i.error("no vibration actuator for controller "+e)}}},{loglevel:99}],131:[function(e,t,n){const i=e("./util/OverlayPlugin"),s=e("./util/iothrottling-profiles");t.exports=class extends i{constructor(e,t){super(e),this.instance=e,this.i18n=t||{},this.instance.diskIO=this,this.fields={},this.renderToolbarButton(),this.renderWidget(),this.instance.registerEventCallback("BLK",this.setActive.bind(this)),this.instance.registerEventCallback("diskio",e=>{const t=e.split(" ");"readbyterate"===t[0]&&2===t.length&&this.updateDiskIOValues(t[1]/1048576)})}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-iothrottling-button",this.toolbarBtnImage.title=this.i18n.IOTHROTTLING_TITLE||"Disk I/O",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.form=document.createElement("form");const e=document.createElement("div");e.className="gm-title",e.innerHTML=this.i18n.IOTHROTTLING_TITLE||"Disk I/O",this.form.appendChild(e);const t=document.createElement("div");t.className="gm-inputs";const n=this.i18n.IOTHROTTLING_PROFILE||"Profile";t.innerHTML="<label>"+n+"</label>",this.select=document.createElement("select"),this.select.className="gm-iothrottling-select";const i=new Option(this.i18n.IOTHROTTLING_PROFILE_NONE||"None");this.select.add(i),this.select.onchange=this.changeProfile.bind(this),t.appendChild(this.select),s.forEach(e=>{const t=new Option(e.label,e.name);this.select.add(t)}),this.readByteRateDiv=document.createElement("div"),this.readByteRateDiv.classList.add("gm-fields");const a=document.createElement("label");a.innerHTML=this.i18n.IOTHROTTLING_READ_BYTERATE||"Read speed limit:",this.readByteRate=document.createElement("input"),this.readByteRate.className="gm-iothrottling-readbyterate",this.readByteRate.placeholder=this.i18n.IOTHROTTLING_READ_BYTERATE_EXAMPLE||"eg: 100",this.readByteRate.title=this.i18n.READ_BYTE_RATE||"Read speed limit",this.readByteRate.required=!0,this.readByteRate.pattern="[0-9]*",this.readByteRateDiv.appendChild(a);const r=document.createElement("label");r.innerHTML=this.i18n.IOTHROTTLING_BYTERATE_UNIT||"MiB per sec",r.classList.add("gm-units"),this.readByteRateDiv.appendChild(r),this.readByteRateDiv.appendChild(this.readByteRate),this.submitBtn=document.createElement("button"),this.submitBtn.className="gm-iothrottling-update",this.submitBtn.innerHTML=this.i18n.IOTHROTTLING_UPDATE||"Update",this.submitBtn.onclick=this.sendDataToInstance.bind(this),this.clearCacheBtn=document.createElement("button"),this.clearCacheBtn.className="gm-iothrottling-clearcache",this.clearCacheBtn.innerHTML=this.i18n.IOTHROTTLING_CLEAR_CACHE||"Clear cache",this.clearCacheBtn.onclick=this.clearCache.bind(this);const o=document.createElement("div");o.appendChild(this.clearCacheBtn),this.form.appendChild(t),this.form.appendChild(this.readByteRateDiv),this.form.appendChild(o),this.form.appendChild(this.submitBtn),this.setFieldsReadOnly(!0),this.resetFields("0"),this.displayFields(!1),this.widget.className="gm-overlay gm-iothrottling-plugin gm-hidden";const c=document.createElement("div");c.className="gm-close-btn",c.onclick=this.toggleWidget.bind(this),this.widget.appendChild(c),this.widget.appendChild(this.form),this.overlays.push(this.widget),this.instance.root.appendChild(this.widget)}setFieldsReadOnly(e){this.readByteRate.readOnly=e}resetFields(e){e=void 0!==e?e:"",this.readByteRate.value=e}displayFields(e){e?this.readByteRateDiv.classList.remove("gm-hidden"):this.readByteRateDiv.classList.add("gm-hidden")}toggleWidget(){this.widget.classList.contains("gm-hidden")?(this.instance.emit("close-overlays"),this.instance.emit("keyboard-disable")):this.instance.emit("keyboard-enable"),this.widget.classList.toggle("gm-hidden"),this.toolbarBtnImage.classList.toggle("gm-active")}sendDataToInstance(e){if(e.preventDefault(),this.form.checkValidity()){const e={channel:"diskio",messages:["set readbyterate "+1048576*this.readByteRate.value,"clearcache"]};this.instance.sendEvent(e),this.toggleWidget()}}clearCache(e){e.preventDefault();this.instance.sendEvent({channel:"diskio",messages:["clearcache"]})}changeProfile(){const e=s.find(e=>e.name===this.select.value);e&&"Custom"!==e.name?(this.loadDetails(e),this.displayFields(!0)):e&&"Custom"===e.name?(this.setFieldsReadOnly(!1),this.displayFields(!0)):(this.resetFields("0"),this.displayFields(!1))}updateDiskIOValues(e){if(e=Number(e),Number.isNaN(e)||e<=0)return this.select.value=this.i18n.IOTHROTTLING_PROFILE_NONE||"None",this.resetFields("0"),void this.displayFields(!1);this.readByteRate.value=e;const t=s.find(t=>t.readByteRate===e);t&&"Custom"!==t.name?(this.select.value=t.name,this.loadDetails(t),this.displayFields(!0)):(this.select.value="Custom",this.setFieldsReadOnly(!1),this.displayFields(!0))}loadDetails(e){"Custom"!==e.name&&(this.setFieldsReadOnly(!0),this.readByteRate.value=e.readByteRate)}setActive(e){this.updateDiskIOValues(Number(e)/1024)}}},{"./util/OverlayPlugin":142,"./util/iothrottling-profiles":143}],132:[function(e,t,n){const i=e("./util/OverlayPlugin"),s="0123456789abcdef";t.exports=class extends i{constructor(e,t){super(e),this.instance=e,this.i18n=t||{},this.instance.identifiers=this,this.invalidAndroidId=!1,this.invalidDeviceId=!1,this.renderToolbarButton(),this.renderWidget(),this.instance.registerEventCallback("ANDROID_ID",e=>{this.androidInput.value=e}),this.instance.registerEventCallback("IMEI",e=>{this.deviceInput.value=e}),this.instance.registerEventCallback("settings",e=>{const t=e.split(" ");if("parameter"!==t[0]||t.length<2)return;const n=t[1].match(/(device_id:)(\w+)/);n&&(this.deviceInput.value=n[2]);const i=t[1].match(/(android_id:)(\w+)/);i&&(this.androidInput.value=i[2])})}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-identifiers-button",this.toolbarBtnImage.title=this.i18n.IDENTIFIERS_TITLE||"Identifiers",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.container=document.createElement("div");const e=document.createElement("div");e.className="gm-title",e.innerHTML=this.i18n.IDENTIFIERS_TITLE||"Identifiers",this.container.appendChild(e);const t=document.createElement("div");t.className="gm-inputs";const n=this.generateInput("android","Android ID","",this.generateRandomAndroidId.bind(this),this.validateAndroidId.bind(this)),i=this.generateInput("device","Device ID","(IMEI/MEID)",this.generateRandomDeviceId.bind(this),this.validateDeviceId.bind(this));t.appendChild(n),t.appendChild(i),this.submitBtn=document.createElement("button"),this.submitBtn.innerHTML=this.i18n.IDENTIFIERS_UPDATE||"Update",this.submitBtn.className="gm-action gm-identifiers-update",t.appendChild(this.submitBtn),this.submitBtn.onclick=this.sendDataToInstance.bind(this),this.container.appendChild(t),this.widget.className="gm-overlay gm-identifiers-plugin gm-hidden";const s=document.createElement("div");s.className="gm-close-btn",s.onclick=this.toggleWidget.bind(this),this.widget.appendChild(s),this.widget.appendChild(this.container),this.overlays.push(this.widget),this.instance.root.appendChild(this.widget)}toggleWidget(){this.widget.classList.contains("gm-hidden")?(this.instance.emit("close-overlays"),this.instance.emit("keyboard-disable")):this.instance.emit("keyboard-enable"),this.widget.classList.toggle("gm-hidden"),this.toolbarBtnImage.classList.toggle("gm-active")}sendDataToInstance(e){e.preventDefault();const t=this.androidInput.value,n=this.deviceInput.value;if(t&&this.androidInput.checkValidity()){const e={channel:"framework",messages:["set parameter android_id:"+t]};this.instance.sendEvent(e)}if(n&&this.deviceInput.checkValidity()){const e={channel:"settings",messages:["set parameter device_id:"+n]};this.instance.sendEvent(e)}this.toggleWidget()}generateRandomAndroidId(e){e&&e.preventDefault(),this.androidInput.value=this.generateHash(16,s),this.invalidAndroidId=!1,this.checkErrors()}validateAndroidId(){this.invalidAndroidId=!this.androidInput.checkValidity(),this.checkErrors()}generateRandomDeviceId(e){e&&e.preventDefault(),this.deviceInput.value=this.generateHash(15,"0123456789"),this.invalidDeviceId=!1,this.checkErrors()}validateDeviceId(){this.invalidDeviceId=!this.deviceInput.checkValidity(),this.checkErrors()}checkErrors(){this.androidInput.classList[this.invalidAndroidId?"add":"remove"]("gm-error"),this.deviceInput.classList[this.invalidDeviceId?"add":"remove"]("gm-error"),this.submitBtn.disabled=this.invalidAndroidId||this.invalidDeviceId}generateInput(e,t,n,i,a){const r=document.createElement("div"),o=document.createElement("div"),c=document.createElement("input"),l=document.createElement("button");return o.className="gm-input-group",c.className="gm-identifier-"+e+"-input",c.type="text",c.required=!0,c.addEventListener("keyup",a),o.appendChild(c),"device"===e?(c.maxLength=15,c.pattern="["+s+"]{14,15}"):"android"===e&&(c.maxLength=16,c.pattern="["+s+"]{16}"),l.className="gm-identifier-"+e+"-generate",l.innerHTML=this.i18n.IDENTIFIERS_GENERATE||"Generate",l.onclick=i,o.appendChild(l),r.className="gm-identifier-"+e,r.innerHTML="<label>"+t+'<i class="gm-description">'+n+"</i></label>",r.appendChild(o),this[e+"Input"]=c,this[e+"Gen"]=l,r}generateHash(e,t){let n="";for(let i=0;i<e;i++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}}},{"./util/OverlayPlugin":142}],133:[function(e,t,n){const i={8:"0x01000003",9:"0x01000001",13:"0x01000005",16:"0x01000020",17:"0x01000021",18:"0x01000023",20:"0x01000024",27:"0x01000000",32:"0x20",33:"0x01000016",34:"0x01000017",35:"0x01000011",36:"0x01000010",37:"0x01000012",38:"0x01000013",39:"0x01000014",40:"0x01000015",45:"0x01000006",46:"0x01000007"},s={67:"0x010000cf",86:"0x010000e2",88:"0x010000d0"};t.exports=class{constructor(e){this.instance=e,this.instance.keyboardEvents=this,this.instance.keyboardEventsEnabled=!0,this.transmitKeys=!0,this.isListenerAdded=!1,this.currentlyPressedKeys=new Map,this.instance.registerEventCallback("keyboard-disable",()=>{this.transmitKeys=!1}),this.instance.registerEventCallback("keyboard-enable",()=>{this.transmitKeys=!0}),window.addEventListener("blur",this.cancelAllPressedKeys.bind(this))}cancelAllPressedKeys(){this.currentlyPressedKeys.forEach(e=>{const t={type:"KEYBOARD_RELEASE",keychar:"",keycode:e};this.instance.sendEvent(t)}),this.currentlyPressedKeys.clear()}onKeyPress(e){if(!this.transmitKeys)return;const t=e.charCode;let n=e.key||String.fromCharCode(t);"Spacebar"===n&&(n=" ");let i={type:"KEYBOARD_PRESS",keychar:n,keycode:t};this.instance.sendEvent(i),i={type:"KEYBOARD_RELEASE",keychar:n,keycode:t},this.instance.sendEvent(i)}onKeyDown(e){if(!this.transmitKeys)return!0;let t;if(s[e.keyCode]&&e.ctrlKey)t=parseInt(s[e.keyCode],16);else{if(s[e.keyCode]&&e.metaKey){t=parseInt(s[e.keyCode],16);let n={type:"KEYBOARD_PRESS",keychar:"",keycode:t};return this.instance.sendEvent(n),n={type:"KEYBOARD_RELEASE",keychar:"",keycode:t},this.instance.sendEvent(n),e.preventDefault(),e.stopPropagation(),e.returnValue=!1,!1}if(!i[e.keyCode])return!0;t=parseInt(i[e.keyCode],16)}const n={type:"KEYBOARD_PRESS",keychar:"",keycode:t};return this.instance.sendEvent(n),this.currentlyPressedKeys.set(t,t),e.preventDefault(),e.stopPropagation(),e.returnValue=!1,!1}onKeyUp(e){if(!this.transmitKeys)return!0;let t;if(s[e.keyCode]&&e.ctrlKey)t=parseInt(s[e.keyCode],16);else{if(!i[e.keyCode])return!0;t=parseInt(i[e.keyCode],16)}const n={type:"KEYBOARD_RELEASE",keychar:"",keycode:t};return this.instance.sendEvent(n),this.currentlyPressedKeys.delete(t),e.preventDefault(),e.stopPropagation(),e.returnValue=!1,!1}addKeyboardCallbacks(){this.instance.root.tabIndex=0,this.isListenerAdded||(this.keyboardCallbacks||(this.keyboardCallbacks=new Map([["keypress",this.onKeyPress.bind(this)],["keydown",this.onKeyDown.bind(this)],["keyup",this.onKeyUp.bind(this)]])),this.instance.root.focus(),this.keyboardCallbacks.forEach((e,t)=>{window.addEventListener(t,e)}),this.isListenerAdded=!0)}removeKeyboardCallbacks(){this.keyboardCallbacks&&this.isListenerAdded&&(this.keyboardCallbacks.forEach((e,t)=>{window.removeEventListener(t,e)}),this.isListenerAdded=!1)}}},{}],134:[function(e,t,n){t.exports=class{constructor(e){this.instance=e,this.instance.mouseEvents=this,this.instance.mouseEventsEnabled=!0,this.leftButtonPressed=!1,this.boundEventListener=this.releaseAtPreviousPositionEvent.bind(this)}onMousePressEvent(e){if(this.instance.video.muted=!1,0!==e.button)return;e.preventDefault(),e.stopPropagation(),this.leftButtonPressed=!0,this.instance.x=this.instance.coordinateUtils.getXCoordinate(e),this.instance.y=this.instance.coordinateUtils.getYCoordinate(e);let t="";t=e.ctrlKey||e.metaKey?{type:"FAKE_MULTI_TOUCH_PRESS",mode:e.shiftKey?2:1,x:this.instance.x,y:this.instance.y}:{type:"MOUSE_PRESS",x:this.instance.x,y:this.instance.y},this.instance.sendEvent(t),document.addEventListener("mouseup",this.boundEventListener,!1)}onMouseReleaseEvent(e){if(0!==e.button)return;e.preventDefault(),e.stopPropagation(),this.leftButtonPressed=!1,this.instance.x=this.instance.coordinateUtils.getXCoordinate(e),this.instance.y=this.instance.coordinateUtils.getYCoordinate(e);let t="";t=e.ctrlKey||e.metaKey?{type:"FAKE_MULTI_TOUCH_RELEASE",mode:e.shiftKey?2:1,x:this.instance.x,y:this.instance.y}:{type:"MOUSE_RELEASE",x:this.instance.x,y:this.instance.y},this.instance.sendEvent(t),document.removeEventListener("mouseup",this.boundEventListener,!1)}releaseAtPreviousPositionEvent(e){if(0!==e.button)return;e.preventDefault(),e.stopPropagation(),this.leftButtonPressed=!1;const t={type:e.ctrlKey||e.metaKey?"FAKE_MULTI_TOUCH_RELEASE":"MOUSE_RELEASE",x:this.instance.x,y:this.instance.y};this.instance.sendEvent(t),document.removeEventListener("mouseup",this.boundEventListener,!1)}onMouseMoveEvent(e){if(!this.leftButtonPressed)return;e.preventDefault(),e.stopPropagation(),this.instance.x=this.instance.coordinateUtils.getXCoordinate(e),this.instance.y=this.instance.coordinateUtils.getYCoordinate(e);const t={type:"MOUSE_MOVE",x:this.instance.x,y:this.instance.y};this.instance.sendEvent(t)}onMouseWheelEvent(e){e.preventDefault(),e.stopPropagation(),this.instance.x=this.instance.coordinateUtils.getXCoordinate(e),this.instance.y=this.instance.coordinateUtils.getYCoordinate(e);const t=this.getWheelDeltaPixels(e.deltaY,e.deltaMode),n={type:"WHEEL",x:this.instance.x,y:this.instance.y,delta:t};this.instance.sendEvent(n)}cancelContextMenu(e){e.preventDefault(),e.stopPropagation(),e.returnValue=!1}addMouseCallbacks(){this.instance.videoWrapper.addEventListener("mousedown",this.onMousePressEvent.bind(this),!1),this.instance.videoWrapper.addEventListener("mouseup",this.onMouseReleaseEvent.bind(this),!1),this.instance.videoWrapper.addEventListener("mousemove",this.onMouseMoveEvent.bind(this),!1),this.instance.videoWrapper.addEventListener("wheel",this.onMouseWheelEvent.bind(this),{passive:!1}),this.instance.videoWrapper.addEventListener("contextmenu",this.cancelContextMenu.bind(this),!1)}getWheelDeltaPixels(e,t){let n=1*e;return n&&t&&(n*=1===t?40:800),n}}},{}],135:[function(e,t,n){t.exports=class{constructor(e){this.instance=e,this.instance.touchEvents=this,this.instance.touchEventsEnabled=!0}onScreenTouchStart(e){e.preventDefault(),e.stopPropagation();const t={type:"MULTI_TOUCH",nb:e.targetTouches.length,mode:0,points:[]};for(let n=0;n<e.targetTouches.length;n++){const i=e.targetTouches[n];this.instance.x=this.instance.coordinateUtils.getXCoordinate(i),this.instance.y=this.instance.coordinateUtils.getYCoordinate(i),t.points.push({x:this.instance.x,y:this.instance.y})}this.instance.sendEvent(t)}onScreenTouchMove(e){e.preventDefault(),e.stopPropagation();const t={type:"MULTI_TOUCH",nb:e.targetTouches.length,mode:2,points:[]};for(let n=0;n<e.targetTouches.length;n++){const i=e.targetTouches[n];this.instance.x=this.instance.coordinateUtils.getXCoordinate(i),this.instance.y=this.instance.coordinateUtils.getYCoordinate(i),t.points.push({x:this.instance.x,y:this.instance.y})}this.instance.sendEvent(t)}onScreenTouchEnd(e){e.preventDefault(),e.stopPropagation();const t={type:"MULTI_TOUCH",nb:e.targetTouches.length,mode:1,points:[]};for(let n=0;n<e.targetTouches.length;n++){const i=e.targetTouches[n];this.instance.x=this.instance.coordinateUtils.getXCoordinate(i),this.instance.y=this.instance.coordinateUtils.getYCoordinate(i),t.points.push({x:this.instance.x,y:this.instance.y})}this.instance.sendEvent(t)}addTouchCallbacks(){this.instance.videoWrapper.addEventListener("touchstart",this.onScreenTouchStart.bind(this),!1),this.instance.videoWrapper.addEventListener("touchend",this.onScreenTouchEnd.bind(this),!1),this.instance.videoWrapper.addEventListener("touchmove",this.onScreenTouchMove.bind(this),!1)}}},{}],136:[function(e,t,n){const i=e("loglevel");i.setDefaultLevel("debug");const s=e("./util/OverlayPlugin"),a=e("./util/network-profiles"),r=e("./util/network-mobile-profiles"),o=e("./util/mobile-signal-strength");t.exports=class extends s{constructor(e,t){super(e),this.instance=e,this.instance.network=this,this.i18n=t||{},this.mobilethrottling=!1,this.fields={},this.renderToolbarButton(),this.renderWidget(),this.mobileThrottlingConfigured=!1,this.network5GConfigured=!1,this.wifiInputChecked=!0,this.mobileInputChecked=!0,this.instance.registerEventCallback("settings",this.handleSettings.bind(this)),this.instance.registerEventCallback("NETWORK",this.setActiveProfile.bind(this)),this.instance.registerEventCallback("network_profile",this.handleNetworkProfile.bind(this))}enableMobileThrottling(){if(this.mobileThrottlingConfigured)return;this.mobilethrottling=!0;const e=document.createElement("div");this.wifiInput=document.createElement("input"),this.wifiStatus=document.createElement("div"),e.className="gm-checkbox-group",this.wifiInput.type="checkbox",this.wifiInput.className="gm-checkbox",this.wifiInput.name="wifi-checkbox",this.wifiInput.onchange=this.toggleWifiState.bind(this),this.wifiInput.checked=this.wifiInputChecked,this.wifiStatus.className="gm-checkbox-label",this.wifiStatus.innerHTML="Wifi",e.appendChild(this.wifiInput),e.appendChild(this.wifiStatus),this.wifiGroupSection.className="gm-section",this.wifiGroupSection.appendChild(e);const t=document.createElement("div");this.mobileInput=document.createElement("input"),this.mobileStatus=document.createElement("div"),t.className="gm-checkbox-group",this.mobileInput.type="checkbox",this.mobileInput.className="gm-checkbox",this.mobileInput.name="mobile-checkbox",this.mobileInput.onchange=this.toggleMobileState.bind(this),this.mobileInput.checked=this.mobileInputChecked,this.mobileStatus.className="gm-checkbox-label",this.mobileStatus.innerHTML="Mobile data",t.appendChild(this.mobileInput),t.appendChild(this.mobileStatus),this.mobileGroupSection.appendChild(t);const n=document.createElement("div");n.className="input_label",n.innerHTML="Network type:",this.profileInputs.appendChild(n),this.selectMobileProfile=document.createElement("select"),this.selectMobileProfile.name="select-mobile-profile",this.selectMobileProfile.onchange=this.changeMobileProfile.bind(this),r.slice().reverse().forEach(e=>{if("5g"===e.name)return;const t=new Option(e.label,e.name);this.selectMobileProfile.add(t)}),this.profileInputs.appendChild(this.selectMobileProfile);const i=document.createElement("div");i.className="input_label",i.innerHTML="Signal strength:",this.inputMobileSignalStrength.appendChild(i),this.selectMobileSignalStrength=document.createElement("select"),this.selectMobileSignalStrength.name="select-mobile-signal-strength",this.selectMobileSignalStrength.onchange=this.changeMobileSignalStrength.bind(this),this.inputMobileSignalStrength.appendChild(this.selectMobileSignalStrength),o.slice().reverse().forEach(e=>{const t=new Option(e.label,e.name);this.selectMobileSignalStrength.add(t)}),this.updateMobileSectionStatus(),this.mobileThrottlingConfigured=!0}disableMobileThrottling(){if(this.mobileThrottlingConfigured)return;this.mobilethrottling=!1,this.selectProfile=document.createElement("select"),this.selectProfile.name="select-profile";const e=new Option(this.i18n.NETWORK_DELECT_PROFILE||"Select a profile");this.selectProfile.add(e),this.selectProfile.onchange=this.changeProfile.bind(this),a.slice().reverse().forEach(e=>{const t=new Option(e.label,e.name);this.selectProfile.add(t)}),this.profileInputs.appendChild(this.selectProfile),this.mobileThrottlingConfigured=!0}enable5G(){if(this.network5GConfigured)return;const e=r.at(0),t=new Option(e.label,e.name);this.selectMobileProfile.add(t),this.network5GConfigured=!0}disable5G(){this.network5GConfigured||(this.network5GConfigured=!0)}handleSettings(e){const t=e.split(" ");if("if"===t[0]){if(this.wifiInput&&(this.wifiInput.disabled=!1),this.mobileInput&&(this.mobileInput.disabled=!1),3!==t.length)return;const e=t[1].match(/(wifi:)(\w+)/);e&&(this.wifiInputChecked="on"===e[2]);const n=t[2].match(/(mobile:)(\w+)/);n&&(this.mobileInputChecked="on"===n[2]),this.wifiInput&&(this.wifiInput.checked=this.wifiInputChecked),this.mobileInput&&(this.mobileInput.checked=this.mobileInputChecked),this.updateMobileSectionStatus()}}handleNetworkProfile(e){const t=e.split(" ");if(!this.mobilethrottling&&(t.length<9||"phone"===t[1]))return;if(this.mobilethrottling&&(t.length<11||"wifi"===t[1]))return;const n=t[2].split(":"),i=t[3].split(":"),s=t[4].split(":"),r=t[5].split(":"),o=t[6].split(":"),c=t[7].split(":"),l=t[8].split(":");if(this.mobilethrottling){const e=t[9].split(":"),a=t[10].split(":");this.setActiveMobileProfile(e[1]),this.setActiveSignalStrength(a[1]),this.updateDetail("downSpeed",i[2]+" b/s","disabled"===i[1]||!this.mobileInput.checked),this.updateDetail("upSpeed",n[2]+"b/s","disabled"===n[1]||!this.mobileInput.checked),this.updateDetail("downDelay",r[2]+" s","disabled"===r[1]||!this.mobileInput.checked),this.updateDetail("upDelay",s[2]+" s","disabled"===s[1]||!this.mobileInput.checked),this.updateDetail("downPacketLoss",c[2]+" %","disabled"===c[1]||!this.mobileInput.checked),this.updateDetail("upPacketLoss",o[2]+" %","disabled"===o[1]||!this.mobileInput.checked),this.updateDetail("dnsDelay",l[2]+" s","disabled"===l[1]||!this.mobileInput.checked)}else{const e="enabled"===n[1]&&"enabled"===i[1]&&"enabled"===s[1]&&"enabled"===r[1]&&"enabled"===o[1]&&"enabled"===c[1]&&"enabled"===l[1],t=a.find(e=>e.downSpeed.value===parseFloat(i[2])&&e.downDelay.value===parseFloat(r[2])&&e.downPacketLoss.value===parseFloat(c[2])&&e.upSpeed.value===parseFloat(n[2])&&e.upDelay.value===parseFloat(s[2])&&e.upPacketLoss.value===parseFloat(o[2])&&e.dnsDelay.value===parseFloat(l[2]));this.selectProfile.value=t&&e?t.name:this.i18n.NETWORK_DELECT_PROFILE||"Select a profile"}}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-network-button",this.toolbarBtnImage.title=this.i18n.NETWORK_TITLE||"Network",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.form=document.createElement("form");const e=document.createElement("div");e.className="gm-title",e.innerHTML=this.i18n.NETWORK_TITLE||"Network",this.form.appendChild(e),this.wifiGroupSection=document.createElement("div"),this.form.appendChild(this.wifiGroupSection),this.mobileGroupSection=document.createElement("div"),this.form.appendChild(this.mobileGroupSection),this.profileInputs=document.createElement("div"),this.profileInputs.className="gm-inputs",this.form.appendChild(this.profileInputs),this.inputMobileSignalStrength=document.createElement("div"),this.inputMobileSignalStrength.className="gm-inputs",this.form.appendChild(this.inputMobileSignalStrength),this.profileDetails=document.createElement("div"),this.profileDetails.className="gm-profile-details gm-hidden",this.profileDetails.appendChild(this.createDetailsSection("Download speed","downSpeed")),this.profileDetails.appendChild(this.createDetailsSection("Upload speed","upSpeed")),this.profileDetails.appendChild(this.createDetailsSection("Download delay","downDelay")),this.profileDetails.appendChild(this.createDetailsSection("Upload delay","upDelay")),this.profileDetails.appendChild(this.createDetailsSection("Download packet loss","downPacketLoss")),this.profileDetails.appendChild(this.createDetailsSection("Upload packet loss","upPacketLoss")),this.profileDetails.appendChild(this.createDetailsSection("DNS Delay","dnsDelay")),this.form.appendChild(this.profileDetails),this.widget.className="gm-overlay gm-network-plugin gm-hidden";const t=document.createElement("div");t.className="gm-close-btn",t.onclick=this.toggleWidget.bind(this),this.widget.appendChild(t),this.widget.appendChild(this.form),this.overlays.push(this.widget),this.instance.root.appendChild(this.widget)}toggleWidget(){this.widget.classList.contains("gm-hidden")?(this.instance.emit("close-overlays"),this.instance.emit("keyboard-disable")):this.instance.emit("keyboard-enable"),this.widget.classList.toggle("gm-hidden"),this.toolbarBtnImage.classList.toggle("gm-active")}changeProfile(){const e=a.find(e=>e.name===this.selectProfile.value);e?(this.loadDetails(e),this.profileDetails.classList.remove("gm-hidden"),this.sendDataToInstance()):this.profileDetails.classList.add("gm-hidden")}sendDataToInstance(){const e=a.find(e=>e.name===this.selectProfile.value);if(e){const t=[];0===e.id?t.push("disable wifi all"):(t.push("enable wifi all"),t.push("set wifi up_rate "+e.upSpeed.value),t.push("set wifi down_rate "+e.downSpeed.value),t.push("set wifi up_delay "+e.upDelay.value),t.push("set wifi down_delay "+e.downDelay.value),t.push("set wifi up_pkt_loss "+e.upPacketLoss.value),t.push("set wifi down_pkt_loss "+e.downPacketLoss.value),t.push("set wifi dns_delay "+e.dnsDelay.value));const n={channel:"network_profile",messages:t};this.instance.sendEvent(n)}}changeMobileProfile(){const e=r.find(e=>e.name===this.selectMobileProfile.value);if(e){const t=[];t.push("setprofile mobile "+e.name);const n={channel:"network_profile",messages:t};this.instance.sendEvent(n)}else i.error("Selected profile not found")}changeMobileSignalStrength(){const e=o.find(e=>e.name===this.selectMobileSignalStrength.value);if(e){const t=[];t.push("setsignalstrength mobile "+e.name);const n={channel:"network_profile",messages:t};this.instance.sendEvent(n)}else i.error("Selected signalStrength not found")}toggleWifiState(){this.wifiInput.disabled=!0;const e=[];this.wifiInput.checked?e.push("enableif wifi"):e.push("disableif wifi");const t={channel:"settings",messages:e};this.instance.sendEvent(t)}toggleMobileState(){this.mobileInput.disabled=!0,this.updateMobileSectionStatus();const e=[];this.mobileInput.checked?e.push("enableif mobile"):e.push("disableif mobile");const t={channel:"settings",messages:e};this.instance.sendEvent(t);this.instance.sendEvent({channel:"network_profile",messages:["notify phone"]})}updateMobileSectionStatus(){this.selectMobileProfile&&(this.selectMobileProfile.disabled=!this.mobileInput.checked),this.selectMobileSignalStrength&&(this.selectMobileSignalStrength.disabled=!this.mobileInput.checked)}createDetailsSection(e,t){const n=document.createElement("section");return this.fields[t]=document.createElement("span"),n.innerHTML=e+": ",n.appendChild(this.fields[t]),n}loadDetails(e){Object.entries(e).forEach(e=>{let[t,n]=e;"label"!==t&&"name"!==t&&"id"!==t&&(this.fields[t].innerHTML=n.label)})}setActiveProfile(e){const t=a.find(t=>t.id===Number(e));if(!t||!String(e).length)return;const n=this.selectProfile.getElementsByTagName("option");for(let e=0;e<n.length;e++){const i=n[e];i.value===t.name&&(i.selected="selected")}this.loadDetails(t)}setActiveMobileProfile(e){if(!e)return void i.error("setActiveMobileProfile: Error : provided profile is empty");const t=r.find(t=>t.name===e);if(!t)return void i.error("setActiveMobileProfile: Error : unknown provided profile");const n=this.selectMobileProfile.getElementsByTagName("option");for(let e=0;e<n.length;e++){const i=n[e];if(i.value===t.name){i.selected="selected";break}}}setActiveSignalStrength(e){if(!e)return void i.error("setActiveSignalStrength: Error : provided strength is empty");const t=o.find(t=>t.name===e);if(!t)return void i.error("setActiveSignalStrength: Error : unknown provided strength");const n=this.selectMobileSignalStrength.getElementsByTagName("option");for(let e=0;e<n.length;e++){const i=n[e];if(i.value===t.name){i.selected="selected";break}}}updateDetail(e,t,n){this.fields[e].innerHTML=n?"":t}}},{"./util/OverlayPlugin":142,"./util/mobile-signal-strength":144,"./util/network-mobile-profiles":145,"./util/network-profiles":146,loglevel:99}],137:[function(e,t,n){t.exports=class{constructor(e,t,n){this.instance=e,this.instance.peerConnectionStats=this,this.connection=t,setTimeout(()=>{this.connection.getStats(null).then(e=>{e.forEach(t=>{if("video"===t.kind){if("inbound-rtp"===t.type){const n=e.get(t.codecId);n&&this.logAndBroadcast("codec",n.mimeType)}"track"===t.type&&(this.logAndBroadcast("width",t.frameWidth),this.logAndBroadcast("height",t.frameHeight),this.logAndBroadcast("jitter",Math.round(t.jitterBufferDelay/t.jitterBufferEmittedCount*1e3)))}if("candidate-pair"===t.type&&"succeeded"===t.state){this.logAndBroadcast("rtt",1e3*t.currentRoundTripTime);const n=e.get(t.localCandidateId);this.hideDefaultTurnWarning(),n&&"relay"===n.candidateType?(this.logAndBroadcast("turn",!0),this.instance.options.turn.default?(this.logAndBroadcast("default",!0),this.displayDefaultTurnWarning()):this.logAndBroadcast("default",!1)):this.logAndBroadcast("turn",!1)}})})},n)}logAndBroadcast(e,t){this.instance.dispatchEvent(e,{msg:t})}displayDefaultTurnWarning(){let e="<h1><span>&#9888;</span> Using a default TURN</h1>Performance is not optimal.";const t=document.createElement("a");t.classList.add("gm-default-turn-button"),t.classList.add("gm-icon-button");const n=document.createElement("div");n.className="gm-default-turn-used gm-hidden",this.instance.options.connectionFailedURL&&(e+="<br>Click on the icon to learn more.",t.href=this.instance.options.connectionFailedURL,t.target="_blank"),n.innerHTML=e,t.appendChild(n),t.onmouseenter=()=>{n.classList.remove("gm-hidden")},t.onmouseleave=()=>{n.classList.add("gm-hidden")};this.instance.getChildByClass(this.instance.root,"gm-toolbar").appendChild(t)}hideDefaultTurnWarning(){const e=this.instance.getChildByClass(this.instance.root,"gm-default-turn-button");e&&e.remove()}}},{}],138:[function(e,t,n){const i=e("./util/OverlayPlugin");t.exports=class extends i{constructor(e,t){super(e),this.instance=e,this.i18n=t||{},this.instance.phone=this,this.renderToolbarButton(),this.renderWidget()}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-phone-button",this.toolbarBtnImage.title=this.i18n.PHONE_TITLE||"Phone",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.container=document.createElement("div");const e=document.createElement("div");e.className="gm-title",e.innerHTML=this.i18n.PHONE_TITLE||"Phone",this.container.appendChild(e);const t=document.createElement("div");t.className="gm-inputs";const n=document.createElement("div");this.phoneInput=document.createElement("input"),this.phoneBtn=document.createElement("button"),this.phoneInput.type="text",this.phoneInput.className="gm-phone-number",this.phoneInput.placeholder=this.i18n.PHONE_CALL_PLACEHOLDER||"Please enter the phone number",this.phoneInput.addEventListener("keyup",this.validate.bind(this)),this.phoneBtn.className="gm-phone-call",this.phoneBtn.innerHTML=this.i18n.PHONE_CALL||"Call",this.phoneBtn.onclick=this.sendPhoneCallToInstance.bind(this),this.phoneBtn.disabled=!0;const i=this.i18n.PHONE_INCOMING||"Incoming phone number";n.innerHTML="<label>"+i+"</label>",n.className="gm-phone-group",n.appendChild(this.phoneInput),n.appendChild(this.phoneBtn),t.appendChild(n);const s=document.createElement("div");this.textInput=document.createElement("textarea"),this.textBtn=document.createElement("button"),this.textInput.className="gm-phone-message",this.textInput.placeholder=this.i18n.PHONE_MESSAGE_PLACEHOLDER||"Please enter the incoming message",this.textInput.rows=5,this.textInput.addEventListener("keyup",this.validate.bind(this)),this.textBtn.className="gm-phone-send",this.textBtn.innerHTML=this.i18n.PHONE_MESSAGE||"Send message",this.textBtn.onclick=this.sendSMSToInstance.bind(this),this.textBtn.disabled=!0;const a=this.i18n.PHONE_MESSAGE_VALUE||"Message";s.innerHTML="<label>"+a+"</label>",s.className="gm-phone-group",s.appendChild(this.textInput),s.appendChild(this.textBtn),t.appendChild(s),this.container.appendChild(t),this.widget.className="gm-overlay gm-phone-plugin gm-hidden";const r=document.createElement("div");r.className="gm-close-btn",r.onclick=this.toggleWidget.bind(this),this.widget.appendChild(r),this.widget.appendChild(this.container),this.overlays.push(this.widget),this.instance.root.appendChild(this.widget)}toggleWidget(){this.widget.classList.contains("gm-hidden")?(this.instance.emit("close-overlays"),this.instance.emit("keyboard-disable")):this.instance.emit("keyboard-enable"),this.widget.classList.toggle("gm-hidden"),this.toolbarBtnImage.classList.toggle("gm-active")}validatePhoneNumber(){return this.phoneInput.value.match(/^(\+[0-9]{1,14}|[0-9]{1,16})$/g)}sendPhoneCallToInstance(e){if(e&&e.preventDefault(),!this.validatePhoneNumber())return;const t={channel:"baseband",messages:["gsm call "+this.phoneInput.value]};this.instance.sendEvent(t),this.toggleWidget()}validateSMSText(){return this.textInput.value.length>0}sendSMSToInstance(e){if(e&&e.preventDefault(),!this.validatePhoneNumber()||!this.validateSMSText())return;const t={channel:"baseband",messages:["sms send "+this.phoneInput.value+" "+this.textInput.value]};this.instance.sendEvent(t),this.toggleWidget()}validate(){const e=this.validatePhoneNumber(),t=this.validateSMSText()&&e;return this.phoneBtn.disabled=!e,this.textBtn.disabled=!t,t}}},{"./util/OverlayPlugin":142}],139:[function(e,t,n){const i=e("./util/OverlayPlugin"),s=e("loglevel");s.setDefaultLevel("debug");t.exports=class extends i{constructor(e,t){super(e),this.instance=e,this.i18n=t||{},this.instance.screencast=this,this.renderToolbarButton(),this.renderWidget(),this.recordedBlobs=[],this.mediaRecorder=null,this.isRecording=!1,this.startTime=0,this.displayInterval=null}handleDataAvailable(e){e.data&&e.data.size>0&&this.recordedBlobs.push(e.data)}getExtensionFromMimeType(e){let t={"video/x-msvideo":".avi","video/mpeg":".mpeg","video/ogg":".ogv","video/webm":".webm","video/3gpp":".3gp","video/3gpp2":".3g2","video/mp4":".mp4","video/x-matroska":".mkv","video/x-flv":".f4v"}[e.toLowerCase()];return t||(s.warn("Unknown MIME type: ",e),t=".webm"),t}downloadScreencast(){const e=new Blob(this.recordedBlobs,{type:this.mediaRecorder.mimeType}),t=window.URL.createObjectURL(e),n=document.createElement("a");n.style.display="none",n.href=t,n.download="device"+this.getExtensionFromMimeType(this.mediaRecorder.mimeType),document.body.appendChild(n),n.click(),setTimeout(()=>{document.body.removeChild(n),window.URL.revokeObjectURL(t)},100),this.isRecording=!1}checkForMediarecorder(){"undefined"==typeof MediaRecorder&&(this.screencast.classList.add("disabled"),this.screencastBtn.title=this.i18n.SCREENCAST_NOMEDIARECORDER_TOOLTIP||"Screencast not supported")}displayTimer(){this.timer.classList.contains("gm-timer-hidden")&&(this.timer.classList.remove("gm-timer-hidden"),this.displayInterval=setInterval(this.displayTimer.bind(this),1e3));let e=new Date-this.startTime;e/=1e3;const t=Math.round(e%60);e=Math.floor(e/60);const n=Math.round(e%60);this.timer.innerHTML=("0"+n).slice(-2)+":"+("0"+t).slice(-2),3===n&&this.stopRecording()}hideTimer(){clearInterval(this.displayInterval),this.timer.classList.add("gm-timer-hidden"),this.timer.innerHTML=""}findBestMimeType(){const e=[];return["video/webm","video/x-matroska","video/mpeg","video/ogg","video/3gpp","video/3gpp2","video/mp4","video/x-flv"].forEach(t=>{MediaRecorder.isTypeSupported(t)&&e.push(t)}),e[0]}startRecording(){try{this.mediaRecorder=new MediaRecorder(this.instance.stream,{mimeType:this.findBestMimeType()})}catch(e){return s.error("Error while creating MediaRecorder: "+e),this.hideTimer(),void this.toolbarBtnImage.classList.remove("gm-screencast-button-recording")}this.recordedBlobs=[],this.isRecording=!0,this.startTime=new Date,this.displayTimer(),this.mediaRecorder.ondataavailable=this.handleDataAvailable.bind(this),this.mediaRecorder.start(50),s.debug("MediaRecorder started",this.mediaRecorder)}stopRecording(){this.mediaRecorder.stop(),this.hideTimer(),this.toolbarBtnImage.classList.remove("gm-screencast-button-recording"),this.downloadScreencast(),s.debug("MediaRecorder stopped",this.mediaRecorder)}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-screencast-button",this.toolbarBtnImage.title=this.i18n.SCREENCAST_TITLE||"Screencast",this.timer=document.createElement("div"),this.timer.className="gm-screencast-timer gm-timer-hidden",this.toolbarBtnImage.appendChild(this.timer),this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.form=document.createElement("form");const e=document.createElement("div");e.className="gm-title",e.innerHTML=this.i18n.SCREENCAST_TITLE||"Screencast",this.form.appendChild(e);const t=document.createElement("div");t.className="gm-inputs";const n=document.createElement("div");this.screenshotBtn=document.createElement("div"),this.screenshotBtn.className="gm-action gm-screencast-screenshot",n.onclick=this.onScreenshotClick.bind(this),n.className="gm-horizontal gm-screenshot";const i=this.i18n.SCREENCAST_SCREENSHOT||"Screenshot";n.innerHTML="<label>"+i+"</label>",n.appendChild(this.screenshotBtn),t.appendChild(n),this.screencast=document.createElement("div"),this.screencastBtn=document.createElement("div"),this.screencastBtn.className="gm-action gm-screencast-screencast",this.screencast.onclick=this.onScreencastClick.bind(this),this.screencast.className="gm-horizontal gm-screencast";const s=this.i18n.SCREENCAST_SCREENCAST||"Screencast";this.screencast.innerHTML="<label>"+s+"</label>",this.screencast.appendChild(this.screencastBtn),t.appendChild(this.screencast),this.form.appendChild(t),this.widget.className="gm-overlay gm-screencast-plugin gm-hidden";const a=document.createElement("div");a.className="gm-close-btn",a.onclick=this.toggleWidget.bind(this),this.widget.appendChild(a),this.widget.appendChild(this.form),this.overlays.push(this.widget),this.instance.root.appendChild(this.widget)}toggleWidget(e){this.checkForMediarecorder(),this.isRecording?this.stopRecording():(this.widget.classList.contains("gm-hidden")?(this.instance.emit("close-overlays"),this.instance.emit("keyboard-disable")):this.instance.emit("keyboard-enable"),this.widget.classList.toggle("gm-hidden"),this.toolbarBtnImage.classList.toggle("gm-active"),!0===e&&this.toolbarBtnImage.classList.add("gm-screencast-button-recording"))}onScreenshotClick(e){e.preventDefault(),this.toggleWidget();const t=document.createElement("canvas"),n=t.getContext("2d"),{video:i}=this.instance;if(t.width=i.videoWidth,t.height=i.videoHeight,!(n&&i instanceof HTMLVideoElement))return;n.drawImage(i,0,0,i.videoWidth,i.videoHeight,0,0,i.videoWidth,i.videoHeight);const s=document.createElement("a");s.download="device-screenshot.png",document.body.appendChild(s);let a=t.toDataURL("image/png");a&&(a=a.replace(/^data:image\/[^;]*/,"data:application/octet-stream")),s.href=a,s.click(),setTimeout(()=>{document.body.removeChild(s)},100)}onScreencastClick(){this.isRecording?this.stopRecording():(this.toggleWidget(!0),this.startRecording())}}},{"./util/OverlayPlugin":142,loglevel:99}],140:[function(e,t,n){t.exports=class{constructor(e,t){this.instance=e,this.instance.StreamBitrate=this,this.i18n=t||{},this.highQuality=!1,this.renderToolbarButton()}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0],n=document.createElement("li");this.chooser=document.createElement("div"),this.chooser.className=".gm-streamrate-chooser gm-icon-button gm-streamrate-button",this.chooser.title=this.i18n.STREAMRATE_TITLE||"High quality",n.appendChild(this.chooser),t.appendChild(n),this.chooser.onclick=()=>{if(this.highQuality=!this.highQuality,this.chooser.classList.toggle("gm-active"),this.highQuality){const e={type:"BITRATE",videoBitrate:5e3,audioBitrate:192e3};this.instance.sendEvent(e),this.instance.renegotiateWebRTCConnection()}else{const e={type:"BITRATE",videoBitrate:0,audioBitrate:0};this.instance.sendEvent(e),this.instance.renegotiateWebRTCConnection()}}}}},{}],141:[function(e,t,n){const i=[{text:"-",value:"0"},{text:"240p",value:"240"},{text:"360p",value:"360"},{text:"480p",value:"480"},{text:"720p",value:"720"},{text:"1080p",value:"1080"}];t.exports=class{constructor(e,t){this.instance=e,this.instance.StreamResolution=this,this.i18n=t||{},this.renderToolbarButton()}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.select=document.createElement("select"),this.select.className="gm-icon-button gm-streamres-button",this.select.title=this.i18n.STREAMRES_TITLE||"Quality",i.forEach(e=>{this.select.add(new Option(e.text,e.value))}),this.select.onchange=this.onStreamResolutionChange.bind(this),t.appendChild(this.select)}onStreamResolutionChange(){const e={type:"SIZE",width:Number(this.select.value)};this.instance.sendEvent(e),this.select.blur()}}},{}],142:[function(e,t,n){t.exports=class{constructor(e){this.overlays=[],this.savedState=null,this.toolbarBtnImage=null,this.instance=e,this.instance.registerEventCallback("close-overlays",this.closeOverlays.bind(this))}closeOverlays(){this.overlays.forEach(e=>{e&&!e.classList.contains("gm-hidden")&&(e.classList.add("gm-hidden"),e.onclose&&e.onclose())}),this.instance.emit("keyboard-enable"),this.toolbarBtnImage&&this.toolbarBtnImage.classList.remove("gm-active")}saveState(){this.savedState||(this.savedState={toolbarBtn:{className:this.toolbarBtn.className,onclick:this.toolbarBtn.onclick},toolbarBtnImage:{className:this.toolbarBtnImage.className}})}restoreState(){this.savedState&&(this.toolbarBtn.className=this.savedState.toolbarBtn.className,this.toolbarBtnImage.className=this.savedState.toolbarBtnImage.className,this.toolbarBtn.onclick=this.savedState.toolbarBtn.onclick,this.savedState=null)}disable(){this.toolbarBtn&&this.toolbarBtnImage&&(this.saveState(),this.toolbarBtn.className+=" gm-disabled-widget-pop-up",this.toolbarBtnImage.className+=" gm-disabled-widget-icon",this.toolbarBtn.onclick=null)}enable(){this.toolbarBtn&&this.toolbarBtnImage&&this.restoreState()}}},{}],143:[function(e,t,n){t.exports=[{name:"High-end device",label:"High-end device",readByteRate:200},{name:"Mid-range device",label:"Mid-range device",readByteRate:100},{name:"Low-end device",label:"Low-end device",readByteRate:50},{name:"Custom",label:"Custom device"}]},{}],144:[function(e,t,n){t.exports=[{id:4,name:"great",label:"Great"},{id:3,name:"good",label:"Good"},{id:2,name:"moderate",label:"Moderate"},{id:1,name:"poor",label:"Poor"},{id:0,name:"none",label:"None"}]},{}],145:[function(e,t,n){t.exports=[{id:7,name:"5g",label:"5G"},{id:6,name:"lte",label:"4G LTE"},{id:5,name:"hsdpa",label:"3G HSDPA"},{id:4,name:"umts",label:"3G UMTS"},{id:3,name:"edge",label:"2G EDGE"},{id:2,name:"gprs",label:"2G GPRS"},{id:1,name:"gsm",label:"2G GSM"},{id:0,name:"none",label:"Unlimited"}]},{}],146:[function(e,t,n){t.exports=[{id:8,name:"wifi",label:"Wifi",downSpeed:{label:"40.0Mb/s",value:4e4},downDelay:{label:"0ms",value:0},downPacketLoss:{label:"0%",value:0},upSpeed:{label:"33.0Mb/s",value:33e3},upDelay:{label:"0ms",value:0},upPacketLoss:{label:"0%",value:0},dnsDelay:{label:"0ms",value:0}},{id:7,name:"4g_with_loss",label:"4G (High packet losses)",downSpeed:{label:"17.9Mb/s",value:17900},downDelay:{label:"50ms",value:50},downPacketLoss:{label:"10%",value:10},upSpeed:{label:"5.5Mb/s",value:5500},upDelay:{label:"50ms",value:50},upPacketLoss:{label:"10%",value:10},dnsDelay:{label:"100ms",value:100}},{id:6,name:"4g_with_delay",label:"4G (High DNS delay)",downSpeed:{label:"17.9Mb/s",value:17900},downDelay:{label:"50ms",value:50},downPacketLoss:{label:"0.01%",value:.01},upSpeed:{label:"5.5Mb/s",value:5500},upDelay:{label:"50ms",value:50},upPacketLoss:{label:"0.01%",value:.01},dnsDelay:{label:"3000ms",value:3e3}},{id:5,name:"4g",label:"4G",downSpeed:{label:"17.9Mb/s",value:17900},downDelay:{label:"50ms",value:50},downPacketLoss:{label:"0.01%",value:.01},upSpeed:{label:"5.5Mb/s",value:5500},upDelay:{label:"50ms",value:50},upPacketLoss:{label:"0.01%",value:.01},dnsDelay:{label:"100ms",value:100}},{id:4,name:"3g",label:"3G",downSpeed:{label:"7.2Mb/s",value:7200},downDelay:{label:"100ms",value:100},downPacketLoss:{label:"0.01%",value:.01},upSpeed:{label:"1.5Mb/s",value:1500},upDelay:{label:"100ms",value:100},upPacketLoss:{label:"0.01%",value:.01},dnsDelay:{label:"200ms",value:200}},{id:3,name:"edge",label:"EDGE",downSpeed:{label:"240Kb/s",value:240},downDelay:{label:"400ms",value:400},downPacketLoss:{label:"0.01%",value:.01},upSpeed:{label:"200Kb/s",value:200},upDelay:{label:"400ms",value:400},upPacketLoss:{label:"0.01%",value:.01},dnsDelay:{label:"800ms",value:800}},{id:2,name:"gprs",label:"GPRS",downSpeed:{label:"40Kb/s",value:40},downDelay:{label:"500ms",value:500},downPacketLoss:{label:"0.01%",value:.01},upSpeed:{label:"40Kb/s",value:40},upDelay:{label:"500ms",value:500},upPacketLoss:{label:"0.01%",value:.01},dnsDelay:{label:"1000ms",value:1e3}},{id:1,name:"no_data",label:"No data",downSpeed:{label:"0Kb/s",value:0},downDelay:{label:"0ms",value:0},downPacketLoss:{label:"0%",value:0},upSpeed:{label:"0Kb/s",value:0},upDelay:{label:"0ms",value:0},upPacketLoss:{label:"0%",value:0},dnsDelay:{label:"0ms",value:0}},{id:0,name:"native",label:"Native",downSpeed:{label:"N/A",value:1/0},downDelay:{label:"N/A",value:0},downPacketLoss:{label:"N/A",value:0},upSpeed:{label:"N/A",value:1/0},upDelay:{label:"N/A",value:0},upPacketLoss:{label:"N/A",value:0},dnsDelay:{label:"N/A",value:0}}]},{}],147:[function(e,t,n){t.exports=function(){const e=this;this.socket=null,this.token=null,this.hasError=!1,this.isUploading=!1,this.uploadedSize=0,this.file=null,this.address=null,this.MEGABYTE=1e6,e.getChunkSize=function(t){const n=5*e.MEGABYTE,i=75*e.MEGABYTE;return Math.max(n,Math.min(.1*t,i))},e.onOpen=function(){const t={type:"token",token:e.token};e.socket.send(JSON.stringify(t))},e.onClose=function(){setTimeout((function(){e.connect(e.address)}),1e3)},e.connect=function(t){e.socket=new WebSocket(t),e.socket.binaryType="arraybuffer",e.socket.onopen=e.onOpen,e.socket.onerror=e.onFailure,e.socket.onmessage=e.onSocketMsg,e.socket.onclose=e.onClose},e.onFailure=function(){e.isUploading=!1,postMessage({type:"FILE_UPLOAD",code:"FAIL"})},e.uploadData=function(t){!1===e.hasError&&e.socket.send(t.target.result,{binary:!0})},e.onSocketMsg=function(t){const n=JSON.parse(t.data);if("FILE_UPLOAD"===n.type)switch(n.code){case"NEXT":if(e.uploadedSize<e.file.size){const t=e.getChunkSize(e.file.size);let n;const i=new FileReader;i.onload=e.uploadData,i.onabort=e.onFailure,i.onerror=e.onFailure,e.file.size-e.uploadedSize>t?(n=e.file.slice(e.uploadedSize,e.uploadedSize+t),e.uploadedSize+=t):(n=e.file.slice(e.uploadedSize),e.uploadedSize=e.file.size),i.readAsArrayBuffer(n)}else{const t={type:"FILE_UPLOAD",done:!0};e.socket.send(JSON.stringify(t)),e.isUploading=!1}break;case"PROGRESS":case"SUCCESS":postMessage(n);break;case"FAIL":e.hasError=!0,postMessage(n)}},e.onmessage=function(t){const n=t.data;switch(n.type){case"address":e.token=n.token,e.address=n.fileUploadAddress,e.connect(e.address);break;case"close":e.isUploading=!1,e.socket&&(e.socket.onclose=null,e.socket.close());break;case"upload":if(!e.isUploading){e.file=n.file,e.isUploading=!0,e.hasError=!1,e.uploadedSize=0;const t={type:"FILE_UPLOAD",name:e.file.name,size:e.file.size};e.socket.send(JSON.stringify(t))}}}}},{}]},{},[119])(119)}));